(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    312913,       6613]
NotebookOptionsPosition[    272111,       5692]
NotebookOutlinePosition[    308025,       6476]
CellTagsIndexPosition[    307982,       6473]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[StyleBox["Example # 7 : ESRF Quadrupole in 2D and 3D using \
Automatic Triangulation",
 FontSize->24]], "Title",
 CellChangeTimes->{{3.409475882576428*^9, 3.4094758940294065`*^9}, {
   3.4094780968885503`*^9, 3.4094781006384544`*^9}, {3.4094782118856063`*^9, 
   3.409478215338643*^9}, {3.409487260145482*^9, 3.4094872725828233`*^9}, {
   3.409536096796875*^9, 3.409536101546875*^9}, {3.4095361616875*^9, 
   3.409536162625*^9}, {3.4154296869754333`*^9, 3.4154297114756308`*^9}, {
   3.4154325515676203`*^9, 3.4154325538289423`*^9}, {3.416397353703125*^9, 
   3.41639736403125*^9}, 3.41639875790625*^9, 3.416768207765625*^9}],

Cell["\<\
Version : 0.6 of 13th April 2008  by J. Chavanne, O. Chubar, P. Elleaume
This notebook example requires Mathematica 6.0 and Radia 4.25 or higher to \
execute. It makes use of the automatic mesh generation of extruded Triangle \
borrowed from Jonathan Richard Shewchuk \
(http://www.cs.cmu.edu/~quake/triangle.html). 
It computes in 2D and 3D the field from the storage ring quadrupole of the \
ESRF. The simulation of any other quadrupole can be derived from this \
notebook by changing the routines / parameters in the \"Iron, Coil, Yoke and \
Build Functions\" section. Dipole and sextupole could also be bilt in a \
similar fashion. 
To run, one must first execute all cells of the next section (Iron, Coil, \
Yoke and Build Functions) which  execute rapidly. Graphics production and \
field solving as well as post-processing takes more time and are triggered by \
the execution of the cells in the other sections (\"2 - Dimensional \
Simulation\" and \"3 - Dimensional Simulation\"). Some of the cells may take \
a lot of time to execute. Take your time to explore this notebook. Start with \
2D computation and then move to 3D when you fill at ease. Read all comments \
written in each cell. This example is longer and quite more involved than any \
one of the examples 1 to 6. \
\>", "Text",
 CellChangeTimes->{{3.409538660671875*^9, 3.40953873709375*^9}, {
   3.409549247036561*^9, 3.4095492846610794`*^9}, {3.40961736821875*^9, 
   3.409617376265625*^9}, {3.409740705296875*^9, 3.409740727609375*^9}, {
   3.415429590692005*^9, 3.415429673507781*^9}, {3.415429819743474*^9, 
   3.415429830461894*^9}, {3.41639665321875*^9, 3.416396665609375*^9}, {
   3.416463987109375*^9, 3.416464018703125*^9}, {3.416734248369231*^9, 
   3.416734260744152*^9}, 3.416768106515625*^9, {3.416806249403698*^9, 
   3.4168062539691067`*^9}, {3.416811288708763*^9, 3.4168113089692*^9}, {
   3.417008980547125*^9, 3.4170089816565*^9}, 3.4170880046895*^9, {
   3.417088204236375*^9, 3.417088367830125*^9}, {3.417089891486375*^9, 
   3.41708995090825*^9}, {3.417090248861375*^9, 3.417090268580125*^9}, {
   3.4170906786895*^9, 3.4170907653145*^9}, {3.417090798236375*^9, 
   3.4170908554395*^9}, {3.4181257884730897`*^9, 3.4181258174338455`*^9}, {
   3.4185557566381598`*^9, 3.4185557789654274`*^9}, 3.425629030921875*^9, {
   3.4256290643125*^9, 3.425629134765625*^9}, 3.425629171953125*^9, {
   3.425629229375*^9, 3.4256292568125*^9}, {3.42563339928125*^9, 
   3.425633414875*^9}, {3.425752229984375*^9, 3.4257522540625*^9}}],

Cell["Iron, Coil, Yoke and Build Functions", "Subtitle",
 CellChangeTimes->{{3.416396410359375*^9, 3.4163964224375*^9}, {
  3.416396603625*^9, 3.416396609015625*^9}, {3.416403850296875*^9, 
  3.4164038634375*^9}, {3.4167683834375*^9, 3.41676839725*^9}, {
  3.417066794767625*^9, 3.417066814236375*^9}, {3.41708804359575*^9, 
  3.41708805534575*^9}, {3.425628972796875*^9, 3.425628982078125*^9}, {
  3.425629057671875*^9, 3.425629059734375*^9}}],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.416396697109375*^9, 3.41639670003125*^9}}],

Cell["\<\
The quadrupole is defined through the:
- \"B vs H\" (\"M vs H\") dependence of the iron type material;
- Coil geometrical parameters;
- Yoke geometrical parameters.
The figure below defines a number of variables used in the following \
functions to built the quadrupole. \
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.416396825296875*^9}, {
   3.41639710325*^9, 3.41639710528125*^9}, {3.4167341705259795`*^9, 
   3.416734170869727*^9}, {3.416768918953125*^9, 3.416768998765625*^9}, {
   3.41676905978125*^9, 3.416769084296875*^9}, {3.41676911771875*^9, 
   3.41676911959375*^9}, 3.416769229484375*^9}],

Cell[GraphicsData["CompressedBitmap", "\<\
eJzsvQm8XVd1H3z05vc0Pc2jrafRlm1NluR5kGVbtjzbWB7wJAuBIYCxZZsZ
4jExGBt5SAIhLXYLMaQh7kcoLW1JIXVbQunn0pYvdeFrmzi0NEFAICiESd/5
773/+/7Puuvce98ovt+P89PTe/fcs/dZa+2111p7rbXXvvz2e1//2jfffu8b
XnP7yEUHbr/r9W94zT0ju95yoLzVPa0ouk8sip7LRgr8faQo+N+R8p/8txH/
4btf3v3l3V/e/eXdo3D3IvzXVRw+fDh8/Av7VdFd7N+/v3j66afDp/DFK/LQ
rvQQHsCDZUdFU08XhL97ioceeqiYM2cOHwzffVOeOz89h84uv/zyYuvWrcUr
r7wSvvtf8tzO8Hdf8bnPfa7Yvn07nilefPFF/t3U73kJSHmm6DL38LsJ8B1O
wx65hys3VLKc6zTsS/fwd+WNfy4Nz0kPvfTSS6H3l19+uRioa/hn0vBs56Eh
uQe65xH8n9LwzER0PLRy5cqip6cHjWektjt37gyABA7Avf8hbc9wXjo73QMn
ZNbBvf/uNNy1a1fmreEECBsql3xD2p4uL4hq9UgxV9red999lbZfl7anOcAt
qGPh/yYNT3UaLjINDx06FB9+2TbswvdL5HHyRHjkv8rjpzjALE33PvWpT1Ub
/qk03CZzB1dqvDzdxshgZDHCJW+FJl+T5lvlvVdeeWV470gdp/8XaXiyw+mr
0j0wb4Vh/7M03OI0XFPH6f9JGm52Gq4zDUGq8PBXpeEmp+HxpmHm1v8oDTcK
PrgwOU9I9zDo5MLw8EvS8CR/bvE2xggXOJbc+h+k+YkOOTa1mCVfkbYnmLaQ
lRyrJk7/99JwvcPp2+oaftlpqPpiex3P/4k0PF7eSFJyvj333HPVhl+Shsc5
oFI66CCHh/+d05CiAp/OqGv4b6XhWn+WnSWzDFca59DkRWm+xqEjdUwTz/9r
abjamZ47nREOD/+xNFzlYHVBHc9/URqudBrukoYV0f4FaTjiNLzYGajw8L+S
hiuchpdIQxA1M94fScNjzfREB5dlsZtaH4m2T2zxL6Q1JaSZo5eH272hrRnt
5j6WOWN4jRnrzE//XBpStEOKUG5dWzdnPicNlzgUva6Og/+ZNFzsNLyhruE/
dRrq9L7RNMy8+1lpuEjeyOl9kzSsqJZ/4jR85JFH8iy9uW62fEYaLvBn6a3O
SJePhCaflubznVm6T96LCZg5+P+ShvOM0Ao0rmP9fywN5zoD8LoErTakoP8D
aTvHaft689JAPdtw2Gn4K3Xz7VPScLbT8E0OzcLDvy8NZ5oBSCN/pxmutWvX
ZjP+96Q5TVId+wPpXpNt9ElpON1pSGs8GG1JNryxbh58QjobkoZ4CIPNzmjw
oOGbTWcwGkIHz0tngw53DDhQaGeV+fK70tmA09lQi86azLOPS2f9TmczWnTW
NCE/5nSGjjCb8WmmdAZmwCfbGWgbOviH0hmJDYjIo2RJmrgNyCK3bdu2jauY
0Mdz0l+vw7repLqzbiY/K531OJ3Nq+2sMbvVBPz70l+34W9w3QLTHzjL9qdm
4d+T/uyyF7AskntkrrcYPI5Qdf6OdDbN6WxJi85wZV2M/z8inZl+ljn93ClA
VeZn6ufnpg2+P6ZFP03G5W/Hfn5q5FQyCdgV6A0uxtUV/o/dV8VIdc1VzrXw
5YfiG37izJrlMi0B2RVXXJG67w3P4FtVtHc6mIV3/FZ8x4+ddywzlA7Gavi/
r3jqqacyCtLmTsG6MsF/M77m72RacM4eI/dglsKZE4e/v0Ip86qMUpMw+Y34
rh85UzDam71hRPbs2VPwwkzpcfqz78hm8zPxHX9b+47uQKJ9+/YV3/zmN8uh
KVt7Ph37giwnos1UHK59QV+Y5hh3zhJ8vvfee/vbvKYijuIoFj80rwF9PNu8
S54L8rb8pO8DB+NTrfh7svo+NZRXyD30o/4zNcr5Ppls6X29+X24X7Esnojv
/RtHUq1w4B92aPgWkZoisUP3j8fuf+AI9BWCAkYLozTX6f6uOiH6gdj3941w
R1vtG6wGlpvfou/u7ng/9/1Y7PuvnaHm8LNffFpQSxZHzqa+v9eib04RwL+o
Rd9NNtb7Y9/f7bDvJaPp+32x70Mi13t7e+lgXeHI61J6LPO1wJ3maV3r/3p8
z7cd2IgDF6k61h4OTSLw12Lff9Wib723cjR9R4us+MsWfdPcxb3VHfSdxcPD
se//I3zNBdSI3CNPrnX60b4ri6+HYt/faiGyte/jWvTdJNYejH3/b+d70hYi
tZTO4ZPnSFTxYpdw98fu/1eL7pXdaXpDC1NKW6+D90qVaL8aX/lNI5WAwYgw
NZZf8PqXzWaa3pIJrS+eNm2avDiKaxpHFXH9nvj2v3DkqaeW5jiE8RC+2/SX
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
piFPsidn5Ybr2jQ8hqxxUuNwjGuv2x/aHtem7fIWUur4Nm3pkGuSUie0abjE
YYlSUoW2J7Zpa3f0J2EV2p7Upi1rFzEaruy0oU3bhYadtO3GNm0XmLYq5za1
acttv/RLQ3fCd525Y3ObDua2EFgnt2nLve5wLFihs7VN2+EWAmtbm7b0bpGj
M2ed0qahZqJX9N+pbRrOlIZkjdDwtDYNZ7QQb+3a8uhsboNA9IXWaejg9DYd
DApjWTl1Zpu2A8IXVoGe1aZtv8NTbHt2m7Z9TlvyxTlt2va24Klz27TtaSHp
drRpO00UKI5Db1KgO9t0UCOwLqhv9vMWsurC+mY/U3PMiKld7Zp1By5M0iki
dlF9m5+mNvEUd1F0F9e3+YnRcZBkoc3u+jY/bsEwLZr9KI2ZasW9++T490vq
2/5tnWa7vL7ND2WcZbkYml1R3+xvWphWV9Y3+0ELsXNVfbPvtzCorq5v9tct
bKlr6pt9r4V4elV9s+8YlYf9ZBWVd21920MtmOW6+mbfNiaUCpbr2zXrVnkS
Ibyhvs1fGd7CE6HNjfVt/k8Lg+nV9c2+1UL03FTf7H+3ED03V5utxGp+7fZi
87X3lc3wf3f4XNFiMbc6/t34b+Mv7/6i3f1hGlX6WY+QNcN/2+NDf5MeCvs9
e3rMQ8lA+4E8RCdZ46FkjEWHYMO9jN7IZ2o/fc90FsDLD50RH/queShbfmoM
faflQ8nqOdTyoWTefDs9hBl/5ZVXmoeSHfNX8hB9zo2HksHyly0fSpbJf0qk
YjEFbOT99re/PTfd1trGZftoNvbmp3lhf3pX+k73rnOPe9CIUZr15KIXaTM8
D3jRAivcJ89cUf3u/PB/f66vwYs1QwBbfNVA2HytlQINbBcmCml9yti0P2/N
R3fY/S/EiagSNt7Ew8nz+1UhBS70wZJ1c5xRiaM6FL7nTmqAzQIF+CxlI6J9
MSeXUSB2rJSEpnw10aj7blcCR18VK+gNtgRn8+bN4V4k4dxwn1U0+Dw2hisJ
CAerIfA7uf89JWBfpcgWny5/z3ZoeG5qoiXepEATI2BaFW63vIV0lOZplAGZ
UzkufNGKejWAhG8JBdujLXkoQlotMGbwr6NLlf/6KmCFL4pQ+GKWQ74dCXZW
JAV0pAujfhg3UKOOdlLLksKAXNtc5rJRtBGfLqwlpA9SlwPSrgRSqsuRsU59
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\
\>"], "Graphics",
 ImageSize->{811, 1100},
 ImageMargins->0]
}, Closed]],

Cell[CellGroupData[{

Cell["Load and Initialize Radia", "Section",
 CellChangeTimes->{{3.4026635672587357`*^9, 3.402663569498869*^9}, {
   3.4094869291809688`*^9, 3.4094869330090446`*^9}, 3.415429876154153*^9, {
   3.416662122859375*^9, 3.41666214228125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", "Radia`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{
    RowBox[{"InputNotebook", "[", "]"}], ",", 
    RowBox[{"ShowCellLabel", "\[Rule]", "False"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "VectorFieldPlots`"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.3973564360172462`*^9, 3.409477499256791*^9, {3.409486943055791*^9, 
   3.4094869500713263`*^9}, {3.409618015015625*^9, 3.409618017734375*^9}, 
   3.415430947537188*^9, {3.415431627394249*^9, 3.415431627821323*^9}, {
   3.416464674453125*^9, 3.416464698203125*^9}, {3.4326727269995003`*^9, 
   3.4326727340463753`*^9}, {3.4326784390932503`*^9, 3.4326784396088753`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Iron Functions", "Section",
 CellChangeTimes->{{3.409486975586625*^9, 3.4094869806490602`*^9}, {
   3.41639658653125*^9, 3.4163965908125*^9}, {3.417008845734625*^9, 
   3.41700885212525*^9}, 3.418233378171875*^9}],

Cell[TextData[StyleBox["Defining non-linear \"M vs H\" dependence for \
iron-type material",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, 3.415433653031415*^9, {
   3.416396172234375*^9, 3.4163961829375*^9}, {3.416464051*^9, 
   3.416464064796875*^9}, 3.4167699405625*^9, {3.416770024421875*^9, 
   3.41677007815625*^9}, 3.4167701245625*^9, {3.41677125690625*^9, 
   3.416771260359375*^9}, {3.41677146890625*^9, 3.41677147903125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tbmat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000228708", ",", "0.0512771"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000309133", ",", "0.0986691"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000417204", ",", "0.235858"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000496372", ",", "0.34455"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000561717", ",", "0.423644"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0000759009", ",", "0.609824"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000102667", ",", "0.776997"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00013823", ",", "0.923262"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000186611", ",", "1.05361"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000251327", ",", "1.16455"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000338538", ",", "1.25756"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000456662", ",", "1.33414"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000615627", ",", "1.39478"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.000829506", ",", "1.44367"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00111828", ",", "1.48488"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00149816", ",", "1.5187"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00150759", ",", "1.51949"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00203223", ",", "1.55207"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00273934", ",", "1.58236"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00369275", ",", "1.61491"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00497804", ",", "1.65032"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00671019", ",", "1.68929"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.00904553", ",", "1.73525"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0121934", ",", "1.78811"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0164367", ",", "1.84876"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0221566", ",", "1.91754"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0300011", ",", "1.9925"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.05", ",", "2.07755"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.08", ",", "2.11885"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "2.12656"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.15", ",", "2.1308"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.17", ",", "2.13105"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.2", ",", "2.13116"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.4154322470018387`*^9, {3.415432303237998*^9, 3.415432326202216*^9}, {
   3.415612231765625*^9, 3.4156122521875*^9}, {3.4162769036034117`*^9, 
   3.41627692444032*^9}, {3.41635502296875*^9, 3.4163550329375*^9}, {
   3.4164052840625*^9, 3.416405310453125*^9}, 3.416769273453125*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Transpose", "[", "tbmat", "]"}]}], ";", 
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"t", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"4", "*", "Pi", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "7"}]}]}], ")"}]}]}], ";", 
  RowBox[{"t", "=", 
   RowBox[{"Transpose", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"t", ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1000"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.7"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Field H[A/m]\>\"", ",", "\"\<\[Micro]0M [T]\>\""}], "}"}]}],
    ",", 
   RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.409537789625*^9, 3.40953789940625*^9}, {
   3.40953875853125*^9, 3.40953877790625*^9}, {3.40953887125*^9, 
   3.409538882*^9}, {3.409538914484375*^9, 3.4095389635*^9}, {
   3.409539204921875*^9, 3.409539209296875*^9}, {3.40953924653125*^9, 
   3.409539357625*^9}, {3.409539397375*^9, 3.409539398859375*^9}, 
   3.409566348970202*^9, 3.415432345860942*^9, {3.415432455812389*^9, 
   3.415432480285673*^9}, {3.41610489236733*^9, 3.416104930638503*^9}, {
   3.4161055304748707`*^9, 3.416105555256813*^9}, {3.416276941669166*^9, 
   3.416276993638687*^9}, {3.416355007640625*^9, 3.416355009421875*^9}, {
   3.670079290806663*^9, 3.6700793087915087`*^9}, {3.6700793927311726`*^9, 
   3.6700794655611925`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Coil Functions", "Section",
 CellChangeTimes->{{3.40220541602456*^9, 3.402205419357362*^9}, {
  3.4022054771790237`*^9, 3.40220547942314*^9}, {3.409486283720481*^9, 
  3.4094862863923216`*^9}, {3.415430427964785*^9, 3.415430445818323*^9}, {
  3.415430846252554*^9, 3.415430864413475*^9}, {3.415432995871512*^9, 
  3.4154330000304117`*^9}, {3.41639650178125*^9, 3.4163965026875*^9}, {
  3.41700884987525*^9, 3.41700885600025*^9}, {3.41823335521875*^9, 
  3.418233362375*^9}}],

Cell[TextData[StyleBox["Auxiliary function to be used for the definition of \
coils",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, 3.415433653031415*^9, {
   3.416396172234375*^9, 3.4163961829375*^9}, {3.416464051*^9, 
   3.416464064796875*^9}, 3.4167699405625*^9, {3.416770024421875*^9, 
   3.41677007815625*^9}, {3.4167701376875*^9, 3.4167702056875*^9}, {
   3.4167704470625*^9, 3.416770458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"coilsinput", "[", 
    RowBox[{"nt_", ",", "Id_", ",", 
     RowBox[{"dim_:", "2"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"tbcs", ",", "tbca"}], "}"}], ",", "\[IndentingNewLine]", " ", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thc", "=", "10"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "nt", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{"nt", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"n2", "=", "n1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n1", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"nt", "+", "1"}], ")"}], "/", "2"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"n2", "=", 
          RowBox[{"n1", "-", "1"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"h1", "=", 
       RowBox[{"thc", "*", "n1"}]}], ";", 
      RowBox[{"e1", "=", "14.2"}], ";", " ", "\[IndentingNewLine]", 
      RowBox[{"h2", "=", 
       RowBox[{"thc", "*", "n2"}]}], ";", 
      RowBox[{"e2", "=", "14.2"}], ";", 
      RowBox[{"dy2", "=", 
       RowBox[{"thc", " ", 
        RowBox[{"(", 
         RowBox[{"n1", "-", "n2"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dlc", "=", "2"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "extra", " ", "length", " ", "of", " ", "the", " ", "coil", " ", "for",
         " ", "3", "D", " ", "case"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"de", "=", "32"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r1", "=", "178"}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "distance", " ", "from", " ", "pole", " ", "base", " ", "and", " ", 
        "beam", " ", "axis"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cgap", "=", "4"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "gap", " ", "between", " ", "coil", " ", "and", " ", "pole", " ", 
        "base"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"y0", "=", 
       RowBox[{"r1", "-", "cgap", "-", "h1"}]}], ";", "  ", 
      "\[IndentingNewLine]", 
      RowBox[{"rc1", "=", "de"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "inner", " ", "radius", " ", "of", " ", "the", " ", "first", " ", 
        "coil", " ", "layer", " ", "for", " ", "3", "D", " ", "case"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rc2", "=", 
       RowBox[{"rc1", "+", "e1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rc3", "=", 
       RowBox[{"rc2", "+", "e2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nas", "=", "12"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "segments", " ", "in", " ", "the", " ", 
        "arcs"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lc", "=", "lmag"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "2"}], ",", 
        RowBox[{"lc", "=", "lmag2d"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pc1", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"de", "+", 
          RowBox[{"e1", "/", "2"}]}], ",", 
         RowBox[{"y0", "+", 
          RowBox[{"h1", "/", "2"}]}], ",", "0"}], "}"}]}], ";", 
      RowBox[{"pc11", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "de"}], "-", 
          RowBox[{"e1", "/", "2"}]}], ",", 
         RowBox[{"y0", "+", 
          RowBox[{"h1", "/", "2"}]}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pc2", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"de", "+", "e1", "+", 
          RowBox[{"e2", "/", "2"}]}], ",", 
         RowBox[{"y0", "+", 
          RowBox[{"h2", "/", "2"}], "+", "dy2"}], ",", "0"}], "}"}]}], ";", 
      RowBox[{"pc12", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "de"}], "-", "e1", "-", 
          RowBox[{"e2", "/", "2"}]}], ",", 
         RowBox[{"y0", "+", 
          RowBox[{"h2", "/", "2"}], "+", "dy2"}], ",", "0"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wc1", "=", 
       RowBox[{"{", 
        RowBox[{"e1", ",", "h1", ",", "lc"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wc2", "=", 
       RowBox[{"{", 
        RowBox[{"e2", ",", "h2", ",", "lc"}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"jd", "=", 
       RowBox[{
        RowBox[{"Id", "/", "e1"}], "/", "thc"}]}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "current", " ", "density", " ", "in", " ", "the", " ", "conductor"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"jc", "=", 
       RowBox[{"-", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "jd"}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "3"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lc", "+=", "dlc"}], ";", "\[IndentingNewLine]", 
         RowBox[{"qlc", "=", 
          RowBox[{"lc", "/", "4"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"hlc", "=", 
          RowBox[{"lc", "/", "2"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pc1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "qlc"}], ";", 
         RowBox[{
          RowBox[{"pc11", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "qlc"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"pc2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "qlc"}], ";", 
         RowBox[{
          RowBox[{"pc12", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "qlc"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wc1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "hlc"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"wc2", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "=", "hlc"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"tbca", "=", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"y0", "+", 
                 RowBox[{"h1", "/", "2"}]}], ",", "hlc"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"rc1", ",", "rc2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                RowBox[{"Pi", "/", "2"}]}], "}"}], ",", "h1", ",", "nas", ",",
               "jd", ",", "\"\<man\>\"", ",", "\"\<y\>\""}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"y0", "+", 
                 RowBox[{"h2", "/", "2"}], "+", "dy2"}], ",", "hlc"}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"rc2", ",", "rc3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Pi"}], "/", "2"}], ",", 
                RowBox[{"Pi", "/", "2"}]}], "}"}], ",", "h2", ",", "nas", ",",
               "jd", ",", "\"\<man\>\"", ",", "\"\<y\>\""}], "}"}]}], "}"}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tbcs", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pc1", ",", "wc1", ",", "jc"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pc2", ",", "wc2", ",", "jc"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pc11", ",", "wc1", ",", 
           RowBox[{"-", "jc"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pc12", ",", "wc2", ",", 
           RowBox[{"-", "jc"}]}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", "3"}], ",", 
        RowBox[{"{", 
         RowBox[{"tbcs", ",", "tbca"}], "}"}], ",", "tbcs"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.402205486822085*^9, 3.402205597101747*^9}, {
   3.4022056404001827`*^9, 3.402205697327683*^9}, {3.402205778301828*^9, 
   3.4022058197205553`*^9}, {3.4022065442272882`*^9, 3.402206669160213*^9}, {
   3.402206705565659*^9, 3.4022070546339407`*^9}, {3.402207144971511*^9, 
   3.402207152752192*^9}, {3.402215885223235*^9, 3.402215911322481*^9}, {
   3.402216379154698*^9, 3.40221659562092*^9}, {3.404552308474143*^9, 
   3.404552366689451*^9}, {3.404552396793688*^9, 3.404552398964889*^9}, {
   3.4045524535763617`*^9, 3.4045524878126507`*^9}, {3.404552596627531*^9, 
   3.404552597545437*^9}, {3.404552649346671*^9, 3.404552650758461*^9}, {
   3.404552816103016*^9, 3.404552816251472*^9}, {3.4045548126615973`*^9, 
   3.404554816914006*^9}, {3.4046156137394657`*^9, 3.40461561491824*^9}, {
   3.40461683414476*^9, 3.404616834650815*^9}, {3.405146978821699*^9, 
   3.40514697932059*^9}, {3.409479222569274*^9, 3.4094792233505087`*^9}, {
   3.409479590359087*^9, 3.4094796937477274`*^9}, {3.409482039412142*^9, 
   3.409482040255886*^9}, 3.4094822620512886`*^9, {3.409484742066927*^9, 
   3.4094847782541957`*^9}, {3.409484828738248*^9, 3.4094849167533092`*^9}, 
   3.4094862809080167`*^9, {3.40956657673999*^9, 3.409566580724161*^9}, {
   3.4095666872342873`*^9, 3.4095666878592515`*^9}, {3.409568097416195*^9, 
   3.409568171681217*^9}, {3.409568256993717*^9, 3.409568263493717*^9}, {
   3.409569157029628*^9, 3.4095691666546893`*^9}, {3.415449403298815*^9, 
   3.415449446626376*^9}, {3.4154508912289057`*^9, 3.415450895929405*^9}, {
   3.415451106403432*^9, 3.415451110410474*^9}, {3.41545123719715*^9, 
   3.41545128519182*^9}, {3.4154528759954147`*^9, 3.415452947752285*^9}, {
   3.415452979555822*^9, 3.415452981235491*^9}, {3.415453079102318*^9, 
   3.415453085076268*^9}, {3.4155579271875*^9, 3.415557931546875*^9}, {
   3.41556858303125*^9, 3.4155686234375*^9}, {3.415568685296875*^9, 
   3.415568737484375*^9}, {3.41556876871875*^9, 3.41556878421875*^9}, {
   3.41556998571875*^9, 3.41557002475*^9}, {3.415602442234375*^9, 
   3.415602444609375*^9}, {3.415602508671875*^9, 3.415602602515625*^9}, {
   3.41560325334375*^9, 3.415603262375*^9}, {3.4156033654375*^9, 
   3.415603517671875*^9}, {3.4156035476875*^9, 3.415603557921875*^9}, {
   3.415603653984375*^9, 3.4156037340625*^9}, {3.415603764625*^9, 
   3.4156037856875*^9}, {3.415603900421875*^9, 3.415603952578125*^9}, {
   3.415604041*^9, 3.415604043390625*^9}, {3.415604145421875*^9, 
   3.41560415465625*^9}, {3.415604185171875*^9, 3.415604229953125*^9}, {
   3.4156044269375*^9, 3.41560445715625*^9}, {3.415604523203125*^9, 
   3.4156045425*^9}, {3.415604681484375*^9, 3.41560468325*^9}, {
   3.4156047776875*^9, 3.415604780390625*^9}, {3.415605049*^9, 
   3.415605143609375*^9}, {3.41560530115625*^9, 3.415605502140625*^9}, {
   3.415605642359375*^9, 3.415605686328125*^9}, {3.415605749046875*^9, 
   3.41560583884375*^9}, {3.415605884046875*^9, 3.415605897390625*^9}, 
   3.415612193625*^9, {3.415614765015625*^9, 3.415614782984375*^9}, {
   3.41561494390625*^9, 3.41561496309375*^9}, {3.4162039476400347`*^9, 
   3.416204131964451*^9}, {3.416205823039236*^9, 3.416205824797784*^9}, {
   3.416355077375*^9, 3.41635509946875*^9}, {3.4163662485*^9, 
   3.416366249296875*^9}, {3.416366280375*^9, 3.416366327046875*^9}, {
   3.41636644346875*^9, 3.416366443796875*^9}, {3.4163664740625*^9, 
   3.41636649909375*^9}, {3.416475617625*^9, 3.41647561825*^9}, {
   3.416712172877728*^9, 3.416712257595005*^9}, {3.416720731351871*^9, 
   3.416720761550765*^9}, {3.41676937925*^9, 3.416769403984375*^9}, {
   3.416769699953125*^9, 3.416769773125*^9}, {3.417013866672125*^9, 
   3.41701389118775*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Yoke Functions", "Section",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.4154307738848457`*^9, 
  3.415430774596486*^9}, {3.415430836211887*^9, 3.4154308422043858`*^9}, {
  3.415430880315493*^9, 3.415430881622506*^9}, {3.416396532328125*^9, 
  3.416396533640625*^9}, {3.417008858703375*^9, 3.417008859109625*^9}, {
  3.418125955119484*^9, 3.4181259656549625`*^9}}],

Cell[TextData[StyleBox["Auxiliary functions defining the yoke boundary",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, 3.415433653031415*^9, {
   3.416396172234375*^9, 3.4163961829375*^9}, {3.416464051*^9, 
   3.416464064796875*^9}, 3.4167699405625*^9, {3.416770024421875*^9, 
   3.41677007815625*^9}, {3.4167701376875*^9, 3.4167702056875*^9}, {
   3.41677024609375*^9, 3.416770294234375*^9}, {3.416770407421875*^9, 
   3.416770416125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SubdivideSegm", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "d_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ptl", ",", "t0", ",", "a", ",", "n", ",", "r"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"d", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"Abs", "[", 
         RowBox[{"d", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"n", "\[LessEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"n", "=", "1"}], ";", 
          RowBox[{"a", "=", "1"}], ";", 
          RowBox[{"r", "=", "1"}]}], ",", 
         RowBox[{"a", "=", 
          RowBox[{"r", "^", 
           RowBox[{"(", 
            RowBox[{"1", "/", 
             RowBox[{"(", 
              RowBox[{"n", "-", "1"}], ")"}]}], ")"}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"r", "\[Equal]", "1"}], ",", 
         RowBox[{"dp", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "-", "p1"}], ")"}], "/", "n"}]}], ",", 
         RowBox[{"dp", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"p2", "-", "p1"}], ")"}], " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "a"}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"a", "^", 
               RowBox[{"(", "n", ")"}]}]}], ")"}]}]}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ptl", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"p1", "+", 
           RowBox[{"dp", "  ", "#"}]}], " ", "&"}], "/@", 
         RowBox[{"FoldList", "[", 
          RowBox[{"Plus", ",", "0", ",", 
           RowBox[{"FoldList", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"a", " ", "#"}], "&"}], ",", "1", ",", 
             RowBox[{"Range", "[", 
              RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Most", "[", "ptl", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yokeinput", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"poly1", ",", "subd", ",", "pch", ",", "vch"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nprof", "=", "12"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "number", " ", "of", " ", "points", " ", "on", " ", "hyperbola", " ", 
        "profile"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"rint", "=", "36"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"bore", " ", "radius"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"cfh", "=", "648"}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"constant", " ", "of", " ", "hyperbolic", " ", 
         RowBox[{"profile", ":", " ", 
          RowBox[{"x", "*", "y"}]}]}], "=", 
        RowBox[{"648", " ", 
         RowBox[{"mm", "^", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"hy0", "=", "250."}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "maximum", " ", "height", " ", "of", " ", "quadrupole", " ", "yoke", 
        " ", "above", " ", "beam", " ", "axis"}], " ", "*)"}], " ", 
      "\[IndentingNewLine]", 
      RowBox[{"hy1", "=", "169."}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "inner", " ", "height", " ", "of", " ", "quadrupole", " ", "yoke", " ",
         "above", " ", "beam", " ", "axis"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"hy2", "=", "90."}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "half", " ", "vertical", " ", "air", " ", "gap", " ", "on", " ", 
        "quadrupole", " ", "side"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"l3", "=", "271.25"}], ";", "\[IndentingNewLine]", 
      RowBox[{"r1", "=", "178"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lxt1", "=", "230."}], ";", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"max", ".", " ", "horizontal"}], " ", "half", " ", "size", 
        " ", "of", " ", "quadrupole"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"lxt2", "=", "185.5"}], ";", "\[IndentingNewLine]", 
      RowBox[{"lye", "=", "27."}], ";", "\[IndentingNewLine]", 
      RowBox[{"thp", "=", "56.57"}], ";", "\[IndentingNewLine]", 
      RowBox[{"p1", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "hy0"}], "}"}]}], ";", 
      RowBox[{"d1", "=", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p2", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "hy1"}], "}"}]}], ";", 
      RowBox[{"d2", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p3", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"r1", " ", 
           RowBox[{"Sqrt", "[", "2", "]"}]}], "-", "hy1"}], ",", "hy1"}], 
        "}"}]}], ";", 
      RowBox[{"d3", "=", 
       RowBox[{"{", 
        RowBox[{"2", ",", "0.7"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p4", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], "  ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "-", 
           RowBox[{"thp", "/", "2"}]}], ",", 
          RowBox[{"r1", "+", 
           RowBox[{"thp", "/", "2"}]}]}], "}"}]}]}], ";", 
      RowBox[{"d4", "=", 
       RowBox[{"{", 
        RowBox[{"2", ",", "15"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p5", "=", 
       RowBox[{"{", 
        RowBox[{"12.", ",", "52."}], "}"}]}], ";", 
      RowBox[{"d5", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p6", "=", 
       RowBox[{"{", 
        RowBox[{"12.", ",", "50.62"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p7", "=", 
       RowBox[{"{", 
        RowBox[{"50.62", ",", "12."}], "}"}]}], ";", 
      RowBox[{"d7", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p8", "=", 
       RowBox[{"{", 
        RowBox[{"52.", ",", "12."}], "}"}]}], ";", 
      RowBox[{"d8", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0.03"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p9", "=", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Sqrt", "[", "2", "]"}]}], " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"r1", "+", 
           RowBox[{"thp", "/", "2"}]}], ",", 
          RowBox[{"r1", "-", 
           RowBox[{"thp", "/", "2"}]}]}], "}"}]}]}], ";", 
      RowBox[{"d9", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p10", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"r1", " ", 
           RowBox[{"Sqrt", "[", "2", "]"}]}], "-", "hy2"}], ",", "hy2"}], 
        "}"}]}], ";", 
      RowBox[{"d10", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "10"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p11", "=", 
       RowBox[{"{", 
        RowBox[{"lxt1", ",", "hy2"}], "}"}]}], ";", 
      RowBox[{"d11", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p12", "=", 
       RowBox[{"{", 
        RowBox[{"lxt1", ",", 
         RowBox[{"hy2", "+", "lye"}]}], "}"}]}], ";", 
      RowBox[{"d12", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p13", "=", 
       RowBox[{"{", 
        RowBox[{"lxt2", ",", 
         RowBox[{"hy2", "+", "lye"}]}], "}"}]}], ";", 
      RowBox[{"d13", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p14", "=", 
       RowBox[{"{", 
        RowBox[{"lxt2", ",", 
         RowBox[{
          RowBox[{"l3", " ", 
           RowBox[{"Sqrt", "[", "2", "]"}]}], "-", "lxt2"}]}], "}"}]}], ";", 
      RowBox[{"d14", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"p15", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"l3", " ", 
           RowBox[{"Sqrt", "[", "2", "]"}]}], "-", "hy0"}], ",", "hy0"}], 
        "}"}]}], ";", 
      RowBox[{"d15", "=", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pp1", "=", 
       RowBox[{"{", 
        RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4", ",", "p5", ",", "p6"}],
         "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"div1", "=", 
       RowBox[{"{", 
        RowBox[{"d1", ",", "d2", ",", "d3", ",", "d4", ",", "d5"}], "}"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"pl1", "=", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SubdivideSegm", "[", 
             RowBox[{
              RowBox[{"pp1", "[", 
               RowBox[{"[", "#", "]"}], "]"}], ",", 
              RowBox[{"pp1", "[", 
               RowBox[{"[", 
                RowBox[{"#", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"div1", "[", 
               RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "div1", "]"}], "]"}]}], ",", "1"}], "]"}], 
        "~", "Join", "~", 
        RowBox[{"{", "p6", "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pp2", "=", 
       RowBox[{"{", 
        RowBox[{
        "p7", ",", "p8", ",", "p9", ",", "p10", ",", "p11", ",", "p12", ",", 
         "p13", ",", "p14", ",", "p15", ",", "p1"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"div2", "=", 
       RowBox[{"{", 
        RowBox[{
        "d7", ",", "d8", ",", "d9", ",", "d10", ",", "d11", ",", "d12", ",", 
         "d13", ",", "d14", ",", "d15"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pl2", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SubdivideSegm", "[", 
            RowBox[{
             RowBox[{"pp2", "[", 
              RowBox[{"[", "#", "]"}], "]"}], ",", 
             RowBox[{"pp2", "[", 
              RowBox[{"[", 
               RowBox[{"#", "+", "1"}], "]"}], "]"}], ",", 
             RowBox[{"div2", "[", 
              RowBox[{"[", "#", "]"}], "]"}]}], "]"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "div2", "]"}], "]"}]}], ",", "1"}], "]"}]}],
       ";", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"x1", "=", "16."}], ";", 
      RowBox[{"y1", "=", 
       RowBox[{"cfh", "/", "x1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x2", "=", "40.5"}], ";", 
      RowBox[{"y2", "=", 
       RowBox[{"cfh", "/", "x2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dx", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x2", "-", "x1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nprof", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dy", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"y2", "-", "y1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"nprof", "-", "1"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"pab", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"y1", "-", "x1", "+", 
          RowBox[{
           RowBox[{"(", " ", 
            RowBox[{"#", "-", "1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"dy", "-", "dx"}], ")"}]}]}], "&"}], "/@", 
        RowBox[{"Range", "[", "nprof", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"xh", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "#"}], "+", 
            RowBox[{"Sqrt", "[", 
             RowBox[{
              RowBox[{"#", "^", "2"}], "+", 
              RowBox[{"4", " ", "cfh"}]}], "]"}]}], ")"}], "/", "2"}], "&"}], 
        "/@", "pab"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"tp1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"cfh", "/", "#"}]}], "}"}], "&"}], "/@", "xh"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poly1", "=", 
       RowBox[{"pl1", "~", "Join", "~", "tp1", "~", "Join", "~", "pl2"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "input", " ", "for", " ", "the", " ", "automatic", " ", 
        "triangulation"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"subd", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "poly1", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"subd", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"subd", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"subd", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"3", ",", "1"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"poly1", ",", " ", "subd"}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.402029436333364*^9, 3.402029442077866*^9}, {
   3.4020297633489647`*^9, 3.402029766842971*^9}, {3.4020298028164*^9, 
   3.402029817650655*^9}, {3.402030160650902*^9, 3.4020301875934467`*^9}, 
   3.402030432919977*^9, {3.402031033627565*^9, 3.402031045966358*^9}, {
   3.402031467632299*^9, 3.402031512929122*^9}, {3.4020320826926937`*^9, 
   3.402032083279076*^9}, 3.4020321163974247`*^9, {3.402032506480136*^9, 
   3.4020325556027117`*^9}, 3.402035255505002*^9, {3.402035289163004*^9, 
   3.402035323873908*^9}, 3.4021182875966883`*^9, {3.402118349562491*^9, 
   3.402118352853031*^9}, 3.402118628160891*^9, {3.4021188165328913`*^9, 
   3.4021188219968147`*^9}, {3.402119025201688*^9, 3.402119085784831*^9}, 
   3.402119122097207*^9, {3.4021191780110283`*^9, 3.402119205949403*^9}, {
   3.402119244223834*^9, 3.4021193012169724`*^9}, {3.40211945588595*^9, 
   3.402119531992032*^9}, {3.4021200615657873`*^9, 3.402120067193718*^9}, 
   3.402144883604891*^9, 3.402147695209408*^9, {3.402191183265484*^9, 
   3.402191232118925*^9}, {3.402191267498465*^9, 3.402191294251357*^9}, {
   3.402191342105399*^9, 3.402191441187211*^9}, {3.402191472509802*^9, 
   3.40219151197889*^9}, {3.40219158391684*^9, 3.40219162449769*^9}, {
   3.402191659460424*^9, 3.4021918072317953`*^9}, {3.402191838940714*^9, 
   3.402191872030334*^9}, {3.4021919171677227`*^9, 3.402191988363592*^9}, {
   3.402192055080126*^9, 3.402192108044271*^9}, {3.402192151285054*^9, 
   3.402192285920024*^9}, 3.402192411048361*^9, {3.40219261842651*^9, 
   3.402192631481123*^9}, {3.402192670099633*^9, 3.402192710037216*^9}, 
   3.4021932354022913`*^9, {3.40219360381588*^9, 3.402193604205452*^9}, {
   3.4021936687754307`*^9, 3.402193681758523*^9}, {3.402194095364706*^9, 
   3.4021940956645527`*^9}, {3.402195139221714*^9, 3.402195147740548*^9}, {
   3.402195452847269*^9, 3.402195468098729*^9}, {3.4021955044461737`*^9, 
   3.40219550895525*^9}, {3.4021955778075533`*^9, 3.402195582672718*^9}, {
   3.402196013261948*^9, 3.402196016515922*^9}, {3.402196048101255*^9, 
   3.402196055437735*^9}, 3.402196219179888*^9, {3.4022171377364073`*^9, 
   3.402217139360239*^9}, 3.402218479938167*^9, 3.4022188555657883`*^9, {
   3.4022192539262466`*^9, 3.402219254052524*^9}, 3.4022293776141872`*^9, {
   3.402229600695183*^9, 3.402229601312623*^9}, {3.402232966531456*^9, 
   3.402232974222219*^9}, {3.402234764977404*^9, 3.4022348342618437`*^9}, {
   3.402234963872957*^9, 3.402234966304739*^9}, {3.402235085364586*^9, 
   3.402235088287044*^9}, {3.4022351409165907`*^9, 3.402235143704115*^9}, {
   3.402235241453409*^9, 3.402235243732829*^9}, {3.4022353320806923`*^9, 
   3.402235344742319*^9}, {3.402235440414694*^9, 3.402235443520708*^9}, {
   3.402236666613654*^9, 3.4022366687940702`*^9}, {3.4022390200314302`*^9, 
   3.4022390235803947`*^9}, {3.4022394032791653`*^9, 3.402239403882038*^9}, {
   3.402239554246833*^9, 3.402239554855946*^9}, {3.4022397229520903`*^9, 
   3.402239723382653*^9}, 3.402241722950801*^9, {3.402241884756586*^9, 
   3.402241884942926*^9}, 3.402242008649024*^9, 3.402242068443131*^9, {
   3.402242114096863*^9, 3.402242114269704*^9}, {3.4022421744493713`*^9, 
   3.402242175258127*^9}, {3.402242214599915*^9, 3.402242215483782*^9}, {
   3.4022422858943644`*^9, 3.402242286482286*^9}, {3.40224238126059*^9, 
   3.402242381885565*^9}, {3.402242470029647*^9, 3.40224247060229*^9}, {
   3.402630403381729*^9, 3.402630403910942*^9}, {3.4026340929585876`*^9, 
   3.4026341307795897`*^9}, {3.402634194239949*^9, 3.4026343238855953`*^9}, {
   3.402634361044635*^9, 3.402634364147036*^9}, {3.402634430637059*^9, 
   3.402634500889431*^9}, 3.402634571423273*^9, {3.402637621526243*^9, 
   3.402637622536427*^9}, {3.402638508671447*^9, 3.402638509316086*^9}, 
   3.402638592399893*^9, {3.402638669240799*^9, 3.402638670316655*^9}, 
   3.4026630695248404`*^9, 3.402663145044894*^9, {3.402663201718772*^9, 
   3.402663203698331*^9}, {3.4026639667159986`*^9, 3.402664012108329*^9}, 
   3.402665823935131*^9, 3.402665877283052*^9, {3.402666421541666*^9, 
   3.402666423221773*^9}, {3.402667638278941*^9, 3.402667644512431*^9}, 
   3.402668704161677*^9, {3.403236020151635*^9, 3.403236020895926*^9}, {
   3.403236055404563*^9, 3.403236056347431*^9}, {3.403236087899208*^9, 
   3.403236116720076*^9}, {3.404543795613236*^9, 3.40454383199366*^9}, 
   3.404544010072057*^9, {3.404544076361734*^9, 3.404544089242157*^9}, {
   3.404544717722061*^9, 3.40454472003069*^9}, 3.404545434910347*^9, {
   3.404545471974988*^9, 3.404545527292308*^9}, {3.40454557960404*^9, 
   3.404545592486508*^9}, {3.404545698494306*^9, 3.404545746650056*^9}, {
   3.404546489501751*^9, 3.4045466099245577`*^9}, {3.4045467111866503`*^9, 
   3.404546714218423*^9}, {3.404546746338166*^9, 3.4045467557955227`*^9}, {
   3.404548240961472*^9, 3.404548311863185*^9}, 3.404548345595439*^9, {
   3.404548637676075*^9, 3.404548643626233*^9}, {3.4045487688134203`*^9, 
   3.404548773608782*^9}, {3.404548992537837*^9, 3.4045490007005033`*^9}, {
   3.404549116043079*^9, 3.4045491435076437`*^9}, 3.404549263118743*^9, 
   3.404549300424088*^9, 3.404549347925158*^9, {3.40454939761126*^9, 
   3.404549402192007*^9}, 3.404549441803149*^9, 3.404549471816593*^9, 
   3.4045503033034477`*^9, {3.4045504322359753`*^9, 3.404550452273287*^9}, {
   3.4045505163193817`*^9, 3.4045505711708508`*^9}, 3.4045513565410233`*^9, {
   3.4045538030814962`*^9, 3.404553803796014*^9}, 3.404554822432405*^9, {
   3.404555006288949*^9, 3.404555006822935*^9}, 3.4045559793530207`*^9, 
   3.40455614738395*^9, {3.404556228599998*^9, 3.404556228994337*^9}, {
   3.404557124538896*^9, 3.404557191951767*^9}, {3.404557237523885*^9, 
   3.404557238078044*^9}, {3.404557625085268*^9, 3.4045580085001993`*^9}, {
   3.404562036502557*^9, 3.404562548831813*^9}, {3.404562603434723*^9, 
   3.404562646845684*^9}, {3.404562736905197*^9, 3.4045627511154833`*^9}, {
   3.404562879679372*^9, 3.404562985941102*^9}, 3.404563019702465*^9, {
   3.404563055657276*^9, 3.4045632579325438`*^9}, {3.4045633029569798`*^9, 
   3.4045633041626177`*^9}, {3.404563373704966*^9, 3.4045633976174517`*^9}, {
   3.4045634365741034`*^9, 3.404563443311336*^9}, {3.4045634979828653`*^9, 
   3.4045635935880013`*^9}, {3.404563644214447*^9, 3.40456366826231*^9}, {
   3.404563700406425*^9, 3.4045637045753183`*^9}, 3.4045637393438396`*^9, {
   3.4045638296295767`*^9, 3.404563858376432*^9}, 3.4045639931603527`*^9, {
   3.4045661893028173`*^9, 3.404566189484067*^9}, {3.404567488962655*^9, 
   3.404567489882964*^9}, 3.404568955175363*^9, 3.404614552125978*^9, {
   3.404614614301951*^9, 3.404614614842729*^9}, {3.404614646338257*^9, 
   3.404614646923469*^9}, {3.404614693274036*^9, 3.404614693695232*^9}, 
   3.404615716446904*^9, {3.4046159849236937`*^9, 3.404615985386698*^9}, 
   3.404616039859964*^9, 3.4046160805688353`*^9, 3.404616697588484*^9, {
   3.404616873234973*^9, 3.404616873871325*^9}, {3.404616985148643*^9, 
   3.4046169857088327`*^9}, {3.404617511351439*^9, 3.404617555510419*^9}, 
   3.404617639730494*^9, {3.4046177062579317`*^9, 3.4046177065289593`*^9}, {
   3.404629273630623*^9, 3.4046292741762953`*^9}, {3.404629406368052*^9, 
   3.404629406758277*^9}, {3.4046295333124247`*^9, 3.404629533840461*^9}, {
   3.405146702577804*^9, 3.405146703096333*^9}, {3.4051467494637413`*^9, 
   3.405146749683611*^9}, 3.4051468157360773`*^9, {3.405146907734604*^9, 
   3.405146908396886*^9}, {3.405146970951791*^9, 3.405146971493373*^9}, {
   3.405147021922164*^9, 3.405147022206592*^9}, {3.40514719553754*^9, 
   3.405147196192182*^9}, {3.405147329910246*^9, 3.4051473306099787`*^9}, 
   3.405156209350491*^9, {3.408988461155875*^9, 3.408988470109*^9}, 
   3.4094822936758842`*^9, {3.409568388665592*^9, 3.409568412915592*^9}, {
   3.4095687589802055`*^9, 3.409568808949275*^9}, {3.4095688615589867`*^9, 
   3.409568862340242*^9}, {3.4095689196531086`*^9, 3.409568939840738*^9}, {
   3.409569172560977*^9, 3.4095691740609865`*^9}, {3.415430388607892*^9, 
   3.4154303895410633`*^9}, {3.415430897341353*^9, 3.415430898059696*^9}, {
   3.4156141370625*^9, 3.4156141380625*^9}, {3.415614178453125*^9, 
   3.41561422578125*^9}, {3.41561445378125*^9, 3.415614454921875*^9}, {
   3.415614486984375*^9, 3.415614488078125*^9}, 3.415614520875*^9, {
   3.415614557640625*^9, 3.41561457178125*^9}, {3.4156146741875*^9, 
   3.415614679421875*^9}, {3.415614718390625*^9, 3.41561472178125*^9}, {
   3.41561479903125*^9, 3.415614903484375*^9}, {3.4156150520625*^9, 
   3.415615054140625*^9}, {3.415615165125*^9, 3.415615176109375*^9}, {
   3.415615213859375*^9, 3.41561523684375*^9}, {3.415615554171875*^9, 
   3.415615649328125*^9}, 3.415615768375*^9, {3.4159814783125*^9, 
   3.415981496*^9}, {3.41598181525*^9, 3.41598183075*^9}, {
   3.415992781921875*^9, 3.415992783875*^9}, 3.415993036171875*^9, {
   3.415993494078125*^9, 3.4159934946875*^9}, {3.41599366915625*^9, 
   3.415993669421875*^9}, {3.41599380978125*^9, 3.41599380984375*^9}, 
   3.4159939530625*^9, {3.415993983453125*^9, 3.415993984453125*^9}, 
   3.4159942090625*^9, 3.415995099859375*^9, {3.416277800934441*^9, 
   3.416277833857915*^9}, {3.4162796977192907`*^9, 3.416280241393919*^9}, {
   3.4162973266121197`*^9, 3.416297532919129*^9}, {3.4162985507113*^9, 
   3.4162987946441193`*^9}, {3.4163555815*^9, 3.41635558184375*^9}, {
   3.4163557155*^9, 3.416355716046875*^9}, {3.4163563495*^9, 
   3.41635638203125*^9}, 3.41635668059375*^9, {3.416356788359375*^9, 
   3.416356894328125*^9}, {3.416396206140625*^9, 3.4163962153125*^9}, {
   3.416445649828125*^9, 3.4164456748125*^9}, {3.4164652859375*^9, 
   3.416465286578125*^9}, 3.416712218992856*^9, {3.416720503803204*^9, 
   3.4167205737721233`*^9}, {3.4167696298125*^9, 3.41676963015625*^9}, {
   3.416769856125*^9, 3.416769862390625*^9}, {3.41677031725*^9, 
   3.4167703619375*^9}, 3.416770546765625*^9, {3.6700796742550926`*^9, 
   3.6700797030370893`*^9}}],

Cell[TextData[StyleBox["Draw the contor of the lamination ",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, 3.415433653031415*^9, {
   3.416396172234375*^9, 3.4163961829375*^9}, {3.416464051*^9, 
   3.416464064796875*^9}, 3.4167699405625*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"poly1", ",", "subd"}], "}"}], "=", 
   RowBox[{"yokeinput", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"polgra", "=", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"poly1", "~", "Join", "~", 
     RowBox[{"{", 
      RowBox[{"poly1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
    RowBox[{"Joined", "\[Rule]", "True"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "Full"}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<+\>\"", ",", "25"}], "}"}]}], ",", 
    RowBox[{"MeshStyle", "\[Rule]", "Red"}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.409464839475726*^9, 3.4094648404913387`*^9}, {
  3.409464949989937*^9, 3.4094649928956375`*^9}, {3.4094650818163743`*^9, 
  3.409465120815875*^9}, {3.4094657331517873`*^9, 3.409465741807926*^9}, {
  3.409466505985645*^9, 3.4094665371414957`*^9}, {3.4094666577183*^9, 
  3.4094666615933247`*^9}, {3.4094669596731844`*^9, 3.4094669670637617`*^9}, {
  3.409467699243676*^9, 3.409467717587191*^9}, {3.409568964294019*^9, 
  3.409568964715897*^9}, {3.4095691797797737`*^9, 3.4095691811704073`*^9}, {
  3.409616899734375*^9, 3.409616904109375*^9}, {3.415614989703125*^9, 
  3.415614990734375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Build 2D Functions", "Section",
 CellChangeTimes->{{3.4022054321547194`*^9, 3.4022054536763906`*^9}, {
   3.4094863107513847`*^9, 3.409486322860605*^9}, {3.41543188649361*^9, 
   3.415431900644185*^9}, {3.415431995271237*^9, 3.4154319957152967`*^9}, {
   3.415538268515625*^9, 3.415538285125*^9}, {3.416396630734375*^9, 
   3.416396635609375*^9}, {3.4163970619375*^9, 3.416397065671875*^9}, {
   3.41644456925*^9, 3.4164445710625*^9}, {3.416475843953125*^9, 
   3.416475845953125*^9}, {3.41677067321875*^9, 3.416770674609375*^9}, 
   3.4168062784322186`*^9, {3.4170082115315*^9, 3.417008213578375*^9}, {
   3.41700886493775*^9, 3.4170088836565*^9}}],

Cell[TextData[StyleBox["Defining the \"Build\" function for 2D Geometry",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
   3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
   3.415433591543603*^9, 3.415433599901622*^9}, 3.416770974265625*^9, {
   3.425629416578125*^9, 3.425629426328125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"build2d", "[", 
   RowBox[{"nt_", ",", "Cur_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gt", ",", "g1", ",", "gct"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"radUtiDelAll", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radFldLenTol", "[", 
      RowBox[{
       RowBox[{"10.0", "^", 
        RowBox[{"-", "16"}]}], ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "14"}]}], ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radFldCmpPrc", "[", 
      RowBox[{"PrcB", "\[Rule]", "0.00000001"}], "]"}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"lmag2d", "=", "2000"}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "large", " ", "longitudinal", " ", "extent", " ", "is", " ", 
        "required", " ", "to", " ", "approach", " ", "the", " ", "2", "D", 
        " ", "case", " ", "\[IndentingNewLine]", "lmag", "  ", "should", " ", 
        "be"}], " ", ">", " ", 
       RowBox[{
       "5", " ", "times", " ", "the", " ", "largest", " ", "transverse", " ", 
        "size", " ", "for", " ", "error"}], " ", "<", " ", 
       RowBox[{"0.1", " ", "%"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "building", " ", "the", " ", "yoke", " ", "and", " ", "applying", " ", 
       "triangulation"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"poly1", ",", "subd"}], "}"}], "=", 
      RowBox[{"yokeinput", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"radObjMltExtTri", "[", 
       RowBox[{
       "0", ",", "lmag2d", ",", "poly1", ",", "subd", ",", "\"\<z\>\"", ",", 
        RowBox[{"TriAngMin", "\[Rule]", "33"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mat", "=", 
      RowBox[{"radMatSatIso", "[", "tbmat", "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"radMatApl", "[", 
      RowBox[{"g", ",", "mat"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radObjDrwAtr", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"building", " ", "the", " ", "coil"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"tbcs", "=", 
      RowBox[{"coilsinput", "[", 
       RowBox[{"nt", ",", "Cur"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
     RowBox[{"clist", "=", 
      RowBox[{"radObjRecCur", " ", "@@@", " ", "tbcs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gc", "=", 
      RowBox[{"radObjCnt", "[", "clist", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rt", "=", 
      RowBox[{"radTrfRot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "45"}], "/", "180"}], " ", "Pi"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"radTrfOrnt", "[", 
      RowBox[{"gc", ",", "rt"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radObjDrwAtr", "[", 
      RowBox[{"gc", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0.5", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g1", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", 
        RowBox[{"g", ",", "gc"}], "}"}], "]"}]}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"gt", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", "g1", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gct", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", "gc", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gct", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gct", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ";", "  ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "gt", " ", "contains", " ", "all", " ", "4", " ", "poles", " ", "and", 
       " ", "coils"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "g1", " ", "contains", " ", "1", " ", "single", " ", "pole", " ", "and",
        " ", "its", " ", "coil"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "gct", " ", "contains", " ", "all", " ", "coils", " ", "but", " ", "no",
        " ", "yoke"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"gt", ",", "g1", ",", "gct"}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.402144786144946*^9, 3.402144852993333*^9}, {
   3.402145119356653*^9, 3.402145119823904*^9}, {3.4021453431327*^9, 
   3.402145371068581*^9}, {3.402147726454307*^9, 3.4021477273869*^9}, {
   3.402205616934841*^9, 3.40220563714754*^9}, {3.402207161685236*^9, 
   3.402207163253108*^9}, {3.4022071959786463`*^9, 3.402207217913268*^9}, {
   3.402207255375637*^9, 3.402207272416237*^9}, {3.402207315724492*^9, 
   3.402207371315267*^9}, {3.402207403320304*^9, 3.402207559386512*^9}, 
   3.4022075927777443`*^9, {3.4022077939316072`*^9, 3.4022077971882133`*^9}, {
   3.402207929269848*^9, 3.402207935679112*^9}, {3.402207968096272*^9, 
   3.402207999866002*^9}, {3.4022089552694387`*^9, 3.4022089605037413`*^9}, 
   3.402208996339324*^9, {3.4022146037063637`*^9, 3.402214633788082*^9}, 
   3.402214794620432*^9, {3.402215751714466*^9, 3.402215753991181*^9}, {
   3.402216148563222*^9, 3.402216157337322*^9}, {3.4022166004674263`*^9, 
   3.402216711133206*^9}, {3.402216920431498*^9, 3.402216943292054*^9}, {
   3.40221698070093*^9, 3.402217013896645*^9}, {3.40221705246675*^9, 
   3.4022170590162487`*^9}, {3.4022298854219933`*^9, 
   3.4022299063520937`*^9}, {3.40223381749967*^9, 3.40223384645053*^9}, 
   3.402234177070489*^9, {3.402236153102463*^9, 3.4022362039947367`*^9}, {
   3.402236280874475*^9, 3.4022362844618473`*^9}, {3.402236585808463*^9, 
   3.402236589365698*^9}, {3.402237268221663*^9, 3.402237271355651*^9}, {
   3.4045428277499657`*^9, 3.404542831558998*^9}, {3.404552511459401*^9, 
   3.4045525199929533`*^9}, {3.40456984426832*^9, 3.404569846600534*^9}, {
   3.404569895297455*^9, 3.404569900492921*^9}, {3.405171130357967*^9, 
   3.4051711326399813`*^9}, {3.405172909184121*^9, 3.405172911099806*^9}, 
   3.405172946850684*^9, 3.405173010833276*^9, 3.4051735113883543`*^9, 
   3.405173543757759*^9, {3.408988629499625*^9, 3.4089886716715*^9}, {
   3.40898874082775*^9, 3.408988747905875*^9}, {3.408988801530875*^9, 
   3.408988843374625*^9}, {3.408989005593375*^9, 3.408989024405875*^9}, {
   3.408989078968375*^9, 3.408989230937125*^9}, 3.40898953495275*^9, {
   3.408995976249625*^9, 3.408996008530875*^9}, 3.4089964759215*^9, {
   3.40899672076525*^9, 3.408996723187125*^9}, 3.40899806589025*^9, 
   3.40900134832775*^9, {3.409004507624625*^9, 3.409004524234*^9}, {
   3.4090516958967896`*^9, 3.4090517006983004`*^9}, {3.409092480717875*^9, 
   3.409092481405375*^9}, 3.409092790561625*^9, {3.40938052530089*^9, 
   3.409380530613084*^9}, {3.409462519124667*^9, 3.409462521874632*^9}, {
   3.4094636251317825`*^9, 3.4094636258349032`*^9}, {3.40946521497092*^9, 
   3.4094652173458896`*^9}, {3.4094653662658587`*^9, 3.40946541653084*^9}, 
   3.40946568876173*^9, 3.4094657610108056`*^9, {3.409465866837576*^9, 
   3.4094658675719414`*^9}, {3.409473065034368*^9, 3.4094730652687397`*^9}, {
   3.409473111049404*^9, 3.4094731112837763`*^9}, {3.4094737404319725`*^9, 
   3.409473745416284*^9}, {3.4094738591335783`*^9, 3.4094738639928913`*^9}, {
   3.409476354039143*^9, 3.4094763925230255`*^9}, {3.4094776026883335`*^9, 
   3.4094776029695673`*^9}, {3.409482204989207*^9, 3.4094822274734383`*^9}, {
   3.409482280222931*^9, 3.4094823368315816`*^9}, 3.4094823927839904`*^9, {
   3.409482428596032*^9, 3.409482432189736*^9}, {3.40948257796912*^9, 
   3.4094826658898697`*^9}, {3.4094849426437683`*^9, 3.409484963784251*^9}, {
   3.409485014799223*^9, 3.4094850156117125`*^9}, {3.409536493875*^9, 
   3.40953653815625*^9}, {3.409536572265625*^9, 3.40953657334375*^9}, {
   3.409536922109375*^9, 3.409536941953125*^9}, {3.4095370418125*^9, 
   3.409537053765625*^9}, {3.409537183375*^9, 3.4095372113125*^9}, 
   3.409537365125*^9, {3.409537628703125*^9, 3.409537632921875*^9}, {
   3.4095448062770634`*^9, 3.409544871744975*^9}, {3.4095449380878763`*^9, 
   3.409544939431609*^9}, 3.409545109663805*^9, {3.409566494947303*^9, 
   3.409566500493894*^9}, {3.409566666985369*^9, 3.4095666706726804`*^9}, {
   3.4095677669717183`*^9, 3.4095677740650144`*^9}, 3.409567824546434*^9, {
   3.409568184337467*^9, 3.409568205962467*^9}, {3.409568456462644*^9, 
   3.4095684790096636`*^9}, {3.409568630666884*^9, 3.409568677760936*^9}, {
   3.4095689851379027`*^9, 3.4095689939817095`*^9}, {3.4095690524352083`*^9, 
   3.4095691171856227`*^9}, {3.4095691875610733`*^9, 3.409569194920495*^9}, {
   3.4096312545653963`*^9, 3.4096312578153334`*^9}, {3.409632529513461*^9, 
   3.4096325581252165`*^9}, 3.409632648085353*^9, {3.4096326870394754`*^9, 
   3.4096328164646635`*^9}, {3.409632869106636*^9, 3.40963288488829*^9}, {
   3.4096329669992466`*^9, 3.4096329875462527`*^9}, {3.4096477751217165`*^9, 
   3.4096477768092055`*^9}, 3.409647810793363*^9, {3.409739676375*^9, 
   3.409739677359375*^9}, {3.409745059421875*^9, 3.40974506484375*^9}, {
   3.4098966603710365`*^9, 3.4098967086962795`*^9}, {3.4098968370786877`*^9, 
   3.409896876701152*^9}, 3.415431545160528*^9, {3.415431749281353*^9, 
   3.41543176161779*^9}, {3.415431944287345*^9, 3.4154319461565657`*^9}, 
   3.415438533360861*^9, {3.415537919046875*^9, 3.415538117953125*^9}, {
   3.415539188703125*^9, 3.415539189453125*^9}, {3.41555369328125*^9, 
   3.415553693546875*^9}, {3.415557952859375*^9, 3.41555800671875*^9}, 
   3.4155698664375*^9, {3.4156060499375*^9, 3.41560622153125*^9}, {
   3.41561263040625*^9, 3.4156126449375*^9}, {3.415612775*^9, 
   3.415612942859375*^9}, {3.4156150028125*^9, 3.4156150064375*^9}, {
   3.4156166601875*^9, 3.41561681003125*^9}, {3.4156169131875*^9, 
   3.415616932140625*^9}, {3.415616995015625*^9, 3.415616995609375*^9}, {
   3.415618651015625*^9, 3.415618668140625*^9}, 3.415690346328125*^9, {
   3.41598533375*^9, 3.415985363921875*^9}, {3.4160722124352407`*^9, 
   3.416072278868977*^9}, {3.4160723093384027`*^9, 3.4160723562063093`*^9}, {
   3.416072389119754*^9, 3.416072424088744*^9}, {3.4160729419056597`*^9, 
   3.416072942648299*^9}, {3.416073385375513*^9, 3.416073385959077*^9}, {
   3.4161055933339653`*^9, 3.4161056061072483`*^9}, 3.41635610684375*^9, {
   3.416356992765625*^9, 3.416357040203125*^9}, {3.416357080171875*^9, 
   3.416357091546875*^9}, {3.416357155234375*^9, 3.416357158859375*^9}, 
   3.41635719653125*^9, {3.41635724675*^9, 3.416357248359375*^9}, {
   3.416357304578125*^9, 3.416357323125*^9}, {3.4163575296875*^9, 
   3.416357532390625*^9}, {3.416357635875*^9, 3.41635764425*^9}, {
   3.416357759734375*^9, 3.416357892*^9}, {3.41635842425*^9, 
   3.41635845475*^9}, {3.41636604509375*^9, 3.4163660920625*^9}, {
   3.416366390078125*^9, 3.416366414578125*^9}, {3.41636645975*^9, 
   3.41636646*^9}, {3.416366535375*^9, 3.416366543671875*^9}, {
   3.41636766071875*^9, 3.41636766459375*^9}, {3.416367713140625*^9, 
   3.416367756734375*^9}, 3.416367895359375*^9, 3.416404268265625*^9, 
   3.4164043750625*^9, {3.416404568015625*^9, 3.4164046604375*^9}, {
   3.416404922515625*^9, 3.4164049275625*^9}, {3.416404971578125*^9, 
   3.416404976421875*^9}, {3.41640523603125*^9, 3.416405259765625*^9}, {
   3.41640539421875*^9, 3.4164054046875*^9}, {3.41646442771875*^9, 
   3.416464428578125*^9}, {3.41646448209375*^9, 3.416464483140625*^9}, {
   3.4164645511875*^9, 3.41646461628125*^9}, {3.416661613109375*^9, 
   3.41666168984375*^9}, {3.416770981703125*^9, 3.4167710078125*^9}, {
   3.416806366764309*^9, 3.416806367699205*^9}, 3.4168064004049835`*^9, {
   3.417013823078375*^9, 3.417013831219*^9}}],

Cell[TextData[StyleBox["Defining the general \"Solve\" function and auxiliary \
functions for 2D case",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
   3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
   3.415433470151483*^9, 3.415433471540545*^9}, 3.415433549694765*^9, {
   3.415433621978383*^9, 3.415433625854875*^9}, {3.4156213118125*^9, 
   3.415621313734375*^9}, {3.415621442765625*^9, 3.415621476125*^9}, {
   3.415621618359375*^9, 3.41562162415625*^9}, {3.415621684640625*^9, 
   3.415621706265625*^9}, 3.416771564984375*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solve", "[", 
     RowBox[{"g_", ",", 
      RowBox[{"prec_:", "0.00003"}]}], "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nmax", "=", "10000"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"maximum", " ", "number", " ", "of", " ", "iterations"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"build", " ", "the", " ", "interaction", " ", "matrix"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"mtrx", "=", 
           RowBox[{"radRlxPre", "[", "g", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"solve", " ", "by", " ", "iterative", " ", "relaxation"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"radRlxAuto", "[", 
           RowBox[{"mtrx", ",", "prec", ",", "nmax", ",", "4"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"radUtiDel", "[", "mtrx", "]"}], ";", "\[IndentingNewLine]", 
       "res"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ScaleSolve", "[", 
     RowBox[{"g_", ",", "k_", ",", "mtrx_", ",", "func_", ",", 
      RowBox[{"x_:", "0"}], ",", 
      RowBox[{"y_:", "0"}], ",", 
      RowBox[{"prec_:", "0.00003"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nmax", "=", "10000"}], ";", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"maximum", " ", "number", " ", "of", " ", "iterations"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "scale", " ", "currect", " ", "in", " ", "all", " ", "coils"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"radObjScaleCur", "[", 
        RowBox[{"g", ",", "k"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"update", " ", "external", " ", "field", " ", "vector"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"radRlxUpdSrc", "[", "mtrx", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"res", "=", 
        RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"solve", " ", "by", " ", "iterative", " ", "relaxation"}], 
           ",", " ", 
           RowBox[{
            RowBox[{"starting", " ", "from", " ", 
             RowBox[{"existing", "/", "previous"}], " ", "magnetization", " ",
              "values", " ", "in", " ", "sub"}], "-", "volumes"}]}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"radRlxAuto", "[", 
          RowBox[{"mtrx", ",", "prec", ",", "nmax", ",", "4", ",", 
           RowBox[{"ZeroM", "\[Rule]", "False"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"func", "[", 
          RowBox[{"g", ",", "x", ",", "y"}], "]"}], ",", "res"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "compute", " ", "the", " ", "quadrupole", " ", "gradient", " ", "in", " ", 
    "2", "D"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grad2d", "[", 
     RowBox[{"g_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dx", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dx", "=", "0.01"}], ";", "\[IndentingNewLine]", 
       RowBox[{"1000", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"radFld", "[", 
            RowBox[{"g", ",", "\"\<by\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "+", 
                RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "0"}], "}"}]}], 
            "]"}], "-", 
           RowBox[{"radFld", "[", 
            RowBox[{"g", ",", "\"\<by\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "-", 
                RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "0"}], "}"}]}], 
            "]"}]}], ")"}], "/", "dx"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildSolve2d", "[", 
    RowBox[{"nt_", ",", "cur_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "gf", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], 
       "=", 
       RowBox[{"build2d", "[", 
        RowBox[{"nt", ",", "cur"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"solve", "[", "gQuad", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gf", "=", 
       RowBox[{"grad2d", "[", 
        RowBox[{"gQuad", ",", "0", ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"gf", ",", "res"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402217325904846*^9, 3.402217344568778*^9}, 
   3.40221758432732*^9, 3.402220100536777*^9, {3.40222036523382*^9, 
   3.4022203806214867`*^9}, {3.402237409573889*^9, 3.402237410065002*^9}, {
   3.402237462959956*^9, 3.4022374729644136`*^9}, {3.402237511194778*^9, 
   3.4022375751262627`*^9}, {3.4022381271829567`*^9, 3.402238141435268*^9}, 
   3.402239194141499*^9, {3.402731970376116*^9, 3.4027319986811247`*^9}, {
   3.4027386260048857`*^9, 3.402738629399062*^9}, {3.402739725340741*^9, 
   3.402739730670844*^9}, 3.405172969249671*^9, {3.405173334151525*^9, 
   3.405173359063151*^9}, {3.4051735045576687`*^9, 3.405173507734764*^9}, 
   3.408996950468375*^9, 3.409473177064184*^9, {3.409481728914129*^9, 
   3.409481731945359*^9}, {3.409481770320114*^9, 3.4094817777419415`*^9}, {
   3.4094826912176704`*^9, 3.409482740310792*^9}, {3.409482771341645*^9, 
   3.4094827763259563`*^9}, {3.40948286390296*^9, 3.4094828641685815`*^9}, {
   3.4094864687493625`*^9, 3.40948648651476*^9}, {3.4094865749042535`*^9, 
   3.4094867502145095`*^9}, {3.40953629678125*^9, 3.409536357703125*^9}, 
   3.409545021071189*^9, {3.4095450522114153`*^9, 3.409545053461399*^9}, {
   3.409566176352936*^9, 3.4095661974301167`*^9}, {3.4095666443459034`*^9, 
   3.409566651189303*^9}, {3.409567878342276*^9, 3.409567878670395*^9}, {
   3.4095679943712983`*^9, 3.409567994715042*^9}, {3.409568289056217*^9, 
   3.409568289337467*^9}, {3.409568335603092*^9, 3.409568336165592*^9}, 
   3.409621295671875*^9, {3.4096624813688517`*^9, 3.4096625074585934`*^9}, {
   3.4097397015*^9, 3.409739702375*^9}, {3.415432588792137*^9, 
   3.4154325935747538`*^9}, {3.415432646627364*^9, 3.4154326798044767`*^9}, {
   3.415432770822464*^9, 3.4154328027141247`*^9}, 3.415539165984375*^9, 
   3.415618694015625*^9, {3.415621490703125*^9, 3.415621494625*^9}, {
   3.415621586484375*^9, 3.4156215869375*^9}, 3.4156217905*^9, {
   3.415621828328125*^9, 3.4156218438125*^9}, {3.415623768390625*^9, 
   3.4156237843125*^9}, {3.415626964015625*^9, 3.4156269870625*^9}, {
   3.415985392515625*^9, 3.41598539559375*^9}, {3.416072593250494*^9, 
   3.4160725951412992`*^9}, {3.416357938171875*^9, 3.41635800021875*^9}, {
   3.416358276890625*^9, 3.416358347765625*^9}, {3.41636862384375*^9, 
   3.416368649046875*^9}, {3.416404794296875*^9, 3.416404796921875*^9}, {
   3.416447452046875*^9, 3.416447459078125*^9}, {3.416661749859375*^9, 
   3.416661803671875*^9}, 3.416771574734375*^9, {3.41677697578125*^9, 
   3.416777014953125*^9}, {3.4181275224257994`*^9, 3.4181276907654715`*^9}, {
   3.4181277686600847`*^9, 3.4181277774105325`*^9}, {3.4181278118307495`*^9, 
   3.4181278300045595`*^9}, {3.418127918135734*^9, 3.4181281060114527`*^9}, {
   3.418128144121491*^9, 3.418128160077814*^9}, {3.418128191974771*^9, 
   3.418128248567158*^9}, {3.4181282824880733`*^9, 3.418128296938195*^9}, {
   3.4181286580333157`*^9, 3.4181286644436545`*^9}, {3.4181288199809713`*^9, 
   3.418128885305395*^9}, {3.4181403001870003`*^9, 3.4181403009370003`*^9}, {
   3.4181407106401253`*^9, 3.4181407146245003`*^9}, {3.4181408029526253`*^9, 
   3.4181408034682503`*^9}, {3.4181427544370003`*^9, 
   3.4181427575463753`*^9}, {3.4181428223432503`*^9, 
   3.4181428935307503`*^9}, {3.4181429572651253`*^9, 3.4181430053901253`*^9}, 
   3.4181444344213753`*^9, {3.4181489899370003`*^9, 3.4181490221557503`*^9}, {
   3.4181494575776253`*^9, 3.4181495019370003`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Build 3D Functions", "Section",
 CellChangeTimes->{{3.4022054321547194`*^9, 3.4022054536763906`*^9}, {
   3.4094863107513847`*^9, 3.409486322860605*^9}, {3.4094873067073865`*^9, 
   3.4094873117698216`*^9}, {3.409740850609375*^9, 3.409740867328125*^9}, {
   3.4155562963125*^9, 3.41555629871875*^9}, {3.41639728646875*^9, 
   3.41639728953125*^9}, {3.4164749384375*^9, 3.41647494165625*^9}, 
   3.416475838375*^9, {3.4167734586875*^9, 3.4167734610625*^9}, {
   3.41700844618775*^9, 3.417008448203375*^9}, {3.417008873078375*^9, 
   3.41700888593775*^9}, 3.417014253094*^9, 3.418126879985196*^9}],

Cell[TextData[StyleBox["Defining the \"Build\" function for 3D Geometry",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
  3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
  3.415433591543603*^9, 3.415433599901622*^9}, {3.4181269082282443`*^9, 
  3.418126912760886*^9}, {3.4256294499375*^9, 3.425629454390625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"build3d", "[", 
   RowBox[{"nt_", ",", "Cur_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gt", ",", "g1", ",", "gct"}], "}"}], ",", " ", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"auxiliary", " ", "parameters", " ", "for", " ", "chamfering"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pch", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rint", "/", 
         SqrtBox["2"]}], ",", 
        RowBox[{"rint", "/", 
         SqrtBox["2"]}], ",", 
        RowBox[{
         RowBox[{"lmag", "/", "2"}], "-", "ch"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vch", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{
         RowBox[{"Sqrt", "[", "2.", "]"}], "*", 
         RowBox[{"Tan", "[", 
          RowBox[{"ach", "*", 
           RowBox[{"Pi", "/", "180"}]}], "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"radUtiDelAll", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radFldLenTol", "[", 
      RowBox[{
       RowBox[{"10.0", "^", 
        RowBox[{"-", "16"}]}], ",", 
       RowBox[{"10", "^", 
        RowBox[{"-", "14"}]}], ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radFldCmpPrc", "[", 
      RowBox[{"PrcB", "\[Rule]", "0.00000001"}], "]"}], " ", ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"building", " ", "the", " ", 
       RowBox[{"yoke", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"poly1", ",", "subd"}], "}"}], "=", 
      RowBox[{"yokeinput", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{"radObjMltExtTri", "[", 
       RowBox[{
        RowBox[{"lmag", "/", "4"}], ",", 
        RowBox[{"lmag", "/", "2"}], ",", "poly1", ",", "subd", ",", 
        "\"\<z\>\"", ",", 
        RowBox[{"TriAngMin", "\[Rule]", "33"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"chamfering", " ", "the", " ", "yoke"}], ",", " ", 
       RowBox[{"if", " ", 
        RowBox[{"necessary", ":"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pch", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "<", 
        RowBox[{"lmag", "/", "2"}]}], ",", 
       RowBox[{"g", "=", 
        RowBox[{
         RowBox[{"radObjCutMag", "[", 
          RowBox[{"g", ",", "pch", ",", "vch", ",", 
           RowBox[{"Frame", "->", "LabTot"}]}], "]"}], " ", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", "   ", 
     "\[IndentingNewLine]", 
     RowBox[{"radObjDivMag", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "nz"}], "}"}], ",", 
       RowBox[{"Frame", "->", "LabTot"}]}], "]"}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "segmenting", " ", "in", " ", "longitudinal", " ", "direction"}], " ", 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "defining", " ", "and", " ", "applying", " ", "material", " ", 
       "properties"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mat", "=", 
      RowBox[{"radMatSatIso", "[", "tbmat", "]"}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"real", " ", "steel"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mat", "=", 
      RowBox[{"RadMatXc06", "[", "]"}]}], ";", "  ", 
     RowBox[{"(*", " ", 
      RowBox[{"to", " ", "accelerate", " ", "the", " ", "relaxation"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"radMatApl", "[", 
      RowBox[{"g", ",", "mat"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radObjDrwAtr", "[", 
      RowBox[{"g", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"building", " ", "the", " ", 
       RowBox[{"coils", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tbcs", ",", "tbca"}], "}"}], "=", 
      RowBox[{"coilsinput", "[", 
       RowBox[{"nt", ",", "Cur", ",", "3"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cslist", "=", 
      RowBox[{"radObjRecCur", " ", "@@@", " ", "tbcs"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"calist", "=", 
      RowBox[{"radObjArcCur", "@@@", "tbca"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gc", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"Join", "[", 
        RowBox[{"cslist", ",", "calist"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rt", "=", 
      RowBox[{"radTrfRot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"-", "45"}], "*", 
         RowBox[{"Pi", "/", "180"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"radTrfOrnt", "[", 
      RowBox[{"gc", ",", "rt"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"radObjDrwAtr", "[", 
      RowBox[{"gc", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0.5", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"g1", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", 
        RowBox[{"g", ",", "gc"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gt", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", "g1", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gct", "=", 
      RowBox[{"radObjCnt", "[", 
       RowBox[{"{", "gc", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPerp", "[", 
      RowBox[{"gt", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gct", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPara", "[", 
      RowBox[{"gct", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"RadTrfZerPerp", "[", 
      RowBox[{"gct", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "gt", " ", "contains", " ", "all", " ", "4", " ", "poles", " ", "and", 
       " ", "coils"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "g1", " ", "contains", " ", "1", " ", "single", " ", "pole", " ", "and",
        " ", "its", " ", "coil"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "gct", " ", "contains", " ", "all", " ", "coils", " ", "but", " ", "no",
        " ", "yoke"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"gt", ",", "g1", ",", "gct"}], "}"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.40973974003125*^9, 3.409739740765625*^9}, {
   3.40973977625*^9, 3.409739807359375*^9}, {3.409739912171875*^9, 
   3.409739912703125*^9}, {3.409739986328125*^9, 3.40974007021875*^9}, {
   3.409740150265625*^9, 3.409740166578125*^9}, 3.409741222859375*^9, {
   3.4155573734375*^9, 3.415557382421875*^9}, {3.41555743425*^9, 
   3.415557487015625*^9}, {3.41555780771875*^9, 3.4155578185625*^9}, {
   3.41555788196875*^9, 3.41555791671875*^9}, {3.415558104734375*^9, 
   3.41555812715625*^9}, {3.415561474828125*^9, 3.415561483*^9}, {
   3.415561547828125*^9, 3.41556160659375*^9}, {3.415561657515625*^9, 
   3.415561664140625*^9}, {3.415561715359375*^9, 3.41556175915625*^9}, {
   3.4155620018125*^9, 3.415562006984375*^9}, {3.415562078359375*^9, 
   3.41556211146875*^9}, {3.415562153796875*^9, 3.415562154890625*^9}, {
   3.415562818765625*^9, 3.415562819234375*^9}, {3.415613063671875*^9, 
   3.415613166375*^9}, {3.415613219609375*^9, 3.41561339765625*^9}, {
   3.415613545546875*^9, 3.41561356678125*^9}, {3.415613670859375*^9, 
   3.4156136733125*^9}, {3.4156138360625*^9, 3.415613857*^9}, {
   3.41561402225*^9, 3.415614023390625*^9}, 3.415614428609375*^9, {
   3.415615836140625*^9, 3.41561588615625*^9}, {3.415615971109375*^9, 
   3.41561597953125*^9}, {3.41561602421875*^9, 3.415616024421875*^9}, {
   3.415616103421875*^9, 3.4156162875625*^9}, {3.4156163471875*^9, 
   3.4156163540625*^9}, {3.415616422984375*^9, 3.4156164813125*^9}, {
   3.4156165345625*^9, 3.415616567578125*^9}, {3.415616606484375*^9, 
   3.415616628703125*^9}, {3.415617110671875*^9, 3.415617176484375*^9}, {
   3.4156172070625*^9, 3.41561721890625*^9}, {3.4156173008125*^9, 
   3.41561737675*^9}, {3.415617423671875*^9, 3.415617456015625*^9}, 
   3.415618427296875*^9, {3.415618745921875*^9, 3.415618782640625*^9}, {
   3.415618928640625*^9, 3.415618961625*^9}, 3.415620719375*^9, {
   3.41568929996875*^9, 3.415689300765625*^9}, 3.41569021978125*^9, 
   3.41569103459375*^9, {3.415693143265625*^9, 3.415693145546875*^9}, {
   3.415693628671875*^9, 3.41569364284375*^9}, {3.41598107028125*^9, 
   3.415981074609375*^9}, 3.415984796734375*^9, {3.415986040421875*^9, 
   3.415986052609375*^9}, {3.415986111359375*^9, 3.41598611478125*^9}, {
   3.415998734546875*^9, 3.415998736296875*^9}, {3.41607696179075*^9, 
   3.416077010652225*^9}, {3.416077086769312*^9, 3.416077111096777*^9}, {
   3.41607714932864*^9, 3.4160771528722343`*^9}, {3.4162034939201403`*^9, 
   3.416203497861478*^9}, 3.4164444885*^9, {3.41644458934375*^9, 
   3.416444589828125*^9}, {3.41644475775*^9, 3.416444774*^9}, {
   3.41644521575*^9, 3.41644522534375*^9}, {3.4164456841875*^9, 
   3.4164457286875*^9}, {3.416448168296875*^9, 3.4164481785*^9}, {
   3.41677364725*^9, 3.416773718171875*^9}, 3.41677557809375*^9, {
   3.4168064206922264`*^9, 3.4168064230762115`*^9}}],

Cell[TextData[StyleBox["Auxiliary functions for 3D case",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
   3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
   3.415433470151483*^9, 3.415433471540545*^9}, 3.415433549694765*^9, {
   3.415433621978383*^9, 3.415433625854875*^9}, {3.4156213118125*^9, 
   3.415621313734375*^9}, {3.415621442765625*^9, 3.415621476125*^9}, {
   3.415621618359375*^9, 3.41562162415625*^9}, {3.415621684640625*^9, 
   3.415621706265625*^9}, {3.4156221464375*^9, 3.415622150328125*^9}, {
   3.41569072028125*^9, 3.415690723171875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grad3d", "[", 
     RowBox[{"g_", ",", "x_", ",", "y_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dx", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dx", "=", "0.1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"radFldInt", "[", 
           RowBox[{"g", ",", "\"\<inf\>\"", ",", "\"\<IBy\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", "y", ",", 
              RowBox[{"-", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "+", 
               RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "100"}], "}"}]}], 
           "]"}], "-", 
          RowBox[{"radFldInt", "[", 
           RowBox[{"g", ",", "\"\<inf\>\"", ",", "\"\<IBy\>\"", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", "y", ",", 
              RowBox[{"-", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "-", 
               RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "100"}], "}"}]}], 
           "]"}]}], ")"}], "/", "dx"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildSolve3d", "[", 
    RowBox[{"nt_", ",", "cur_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "gf", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], 
       "=", 
       RowBox[{"build3d", "[", 
        RowBox[{"nt", ",", "cur"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"solve", "[", "gQuad", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"gf", "=", 
       RowBox[{"grad3d", "[", 
        RowBox[{"gQuad", ",", "0", ",", "0"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"gf", ",", "res"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.402217325904846*^9, 3.402217344568778*^9}, 
   3.40221758432732*^9, 3.402220100536777*^9, {3.40222036523382*^9, 
   3.4022203806214867`*^9}, {3.402237409573889*^9, 3.402237410065002*^9}, {
   3.402237462959956*^9, 3.4022374729644136`*^9}, {3.402237511194778*^9, 
   3.4022375751262627`*^9}, {3.4022381271829567`*^9, 3.402238141435268*^9}, 
   3.402239194141499*^9, {3.402731970376116*^9, 3.4027319986811247`*^9}, {
   3.4027386260048857`*^9, 3.402738629399062*^9}, {3.402739725340741*^9, 
   3.402739730670844*^9}, 3.405172969249671*^9, {3.405173334151525*^9, 
   3.405173359063151*^9}, {3.4051735045576687`*^9, 3.405173507734764*^9}, 
   3.408996950468375*^9, 3.409473177064184*^9, {3.409481728914129*^9, 
   3.409481731945359*^9}, {3.409481770320114*^9, 3.4094817777419415`*^9}, {
   3.4094826912176704`*^9, 3.409482740310792*^9}, {3.409482771341645*^9, 
   3.4094827763259563`*^9}, {3.40948286390296*^9, 3.4094828641685815`*^9}, {
   3.4094864687493625`*^9, 3.40948648651476*^9}, {3.4094865749042535`*^9, 
   3.4094867502145095`*^9}, {3.40953629678125*^9, 3.409536357703125*^9}, 
   3.409545021071189*^9, {3.4095450522114153`*^9, 3.409545053461399*^9}, {
   3.409566176352936*^9, 3.4095661974301167`*^9}, {3.4095666443459034`*^9, 
   3.409566651189303*^9}, {3.409567878342276*^9, 3.409567878670395*^9}, {
   3.4095679943712983`*^9, 3.409567994715042*^9}, {3.409568289056217*^9, 
   3.409568289337467*^9}, {3.409568335603092*^9, 3.409568336165592*^9}, 
   3.409621295671875*^9, {3.4096624813688517`*^9, 3.4096625074585934`*^9}, {
   3.4097397015*^9, 3.409739702375*^9}, {3.415432588792137*^9, 
   3.4154325935747538`*^9}, {3.415432646627364*^9, 3.4154326798044767`*^9}, {
   3.415432770822464*^9, 3.4154328027141247`*^9}, 3.415539165984375*^9, 
   3.415618694015625*^9, {3.415621490703125*^9, 3.415621494625*^9}, {
   3.415621586484375*^9, 3.4156215869375*^9}, 3.4156217905*^9, {
   3.415621828328125*^9, 3.4156218438125*^9}, {3.41562216184375*^9, 
   3.4156221790625*^9}, {3.415622578046875*^9, 3.41562261384375*^9}, {
   3.415622644546875*^9, 3.4156226930625*^9}, {3.4156235960625*^9, 
   3.415623753*^9}, {3.415623828859375*^9, 3.415623840703125*^9}, 
   3.415627242921875*^9, {3.41598614475*^9, 3.415986147859375*^9}, {
   3.4160772674473143`*^9, 3.4160772690061893`*^9}, {3.41644504915625*^9, 
   3.416445055203125*^9}, {3.416662730875*^9, 3.4166627504375*^9}, {
   3.4181495305776253`*^9, 3.4181495707963753`*^9}}]
}, Closed]],

Cell["2 - Dimensional Simulation", "Subtitle"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.416396697109375*^9, 3.41639670003125*^9}}],

Cell["\<\
To simulate the qaudrupole in 2D, the yoke is created with a single layer of \
very large thickness. \
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, {
   3.41640414046875*^9, 3.416404188609375*^9}, {3.4167145796783943`*^9, 
   3.416714588420917*^9}, 3.42562949134375*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Show in 2D  ", "Section",
 CellChangeTimes->{{3.4022054321547194`*^9, 3.4022054536763906`*^9}, {
   3.4094863107513847`*^9, 3.409486322860605*^9}, {3.41543188649361*^9, 
   3.415431900644185*^9}, {3.415431995271237*^9, 3.4154319957152967`*^9}, {
   3.415538268515625*^9, 3.415538285125*^9}, {3.416396630734375*^9, 
   3.416396635609375*^9}, {3.4163970619375*^9, 3.416397065671875*^9}, {
   3.41644456925*^9, 3.4164445710625*^9}, {3.416475843953125*^9, 
   3.416475845953125*^9}, {3.41677067321875*^9, 3.416770674609375*^9}, 
   3.4168062784322186`*^9, {3.41700827918775*^9, 3.417008305344*^9}}],

Cell[TextData[StyleBox["Instantiating the Quadrupole and compute the memory \
requirement ",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154333063331757`*^9, 
   3.4154333388931723`*^9}, 3.415433562862254*^9, {3.416771310953125*^9, 
   3.416771317*^9}, {3.416771373921875*^9, 3.41677137653125*^9}, {
   3.416771438609375*^9, 3.4167714511875*^9}, {3.41677151221875*^9, 
   3.41677152675*^9}, 3.416771953265625*^9, 3.416806575102335*^9, {
   3.416807420905491*^9, 3.416807423876534*^9}, {3.416807510231806*^9, 
   3.416807511275324*^9}, {3.417089985377*^9, 3.417089995611375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "15"}], ";"}], "                              ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "number", " ", "of", " ", "turns", " ", "in", " ", "the", " ", "coil"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cur", "=", "533.3"}], ";"}], "                   ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "current", " ", "in", " ", "the", " ", "coil", " ", "in", " ", "Amperes"}],
    " ", "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], "=", 
   RowBox[{"build2d", "[", 
    RowBox[{"ns", ",", "cur"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sz", "=", 
   RowBox[{"radObjDegFre", "[", "gQuad", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Typical Memory Size of Interation Matrix  [M] = \>\"", ",", 
     RowBox[{"N", "[", 
      RowBox[{"sz", "*", 
       RowBox[{"(", 
        RowBox[{"sz", "+", "1"}], ")"}], "*", 
       RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";"}], 
  " "}]}], "Input",
 CellChangeTimes->{
  3.4163676756875*^9, 3.416367706546875*^9, {3.416367786265625*^9, 
   3.416367795953125*^9}, {3.416404232296875*^9, 3.416404232671875*^9}, {
   3.41640526465625*^9, 3.416405277140625*^9}, {3.416661696203125*^9, 
   3.416661718265625*^9}, {3.416712278031336*^9, 3.416712285759385*^9}, 
   3.4167712959375*^9, {3.41677140378125*^9, 3.4167714048125*^9}, {
   3.4168077482630024`*^9, 3.4168077501319904`*^9}, {3.4170902814395*^9, 
   3.417090323502*^9}, {3.41709035759575*^9, 3.41709036003325*^9}, {
   3.4181496071088753`*^9, 3.4181496570620003`*^9}}],

Cell[TextData[StyleBox["Show  the Geometry",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154333063331757`*^9, 
   3.4154333388931723`*^9}, 3.415433562862254*^9, {3.417090022705125*^9, 
   3.41709002459575*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "only", " ", "a", " ", "single", " ", "pole", " ", "and", " ", "coil", " ",
     "before", " ", "applying", " ", "the", " ", "symmetries"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dwg", "=", 
     RowBox[{"radObjDrw", "[", "gOneYokeAndCoil", "]"}]}], ";"}], "\n", 
   RowBox[{"gr", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics3D", "[", "Dwg", "]"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "False"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{
  3.4163676756875*^9, 3.416367706546875*^9, {3.416367786265625*^9, 
   3.416367795953125*^9}, {3.416404232296875*^9, 3.416404232671875*^9}, {
   3.41640526465625*^9, 3.416405277140625*^9}, {3.416661696203125*^9, 
   3.416661718265625*^9}, {3.416712278031336*^9, 3.416712285759385*^9}, {
   3.416771425140625*^9, 3.41677142953125*^9}, {3.417090044002*^9, 
   3.41709007778325*^9}, 3.4181496830776253`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Full", " ", "Quadrupole"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dwg", "=", 
     RowBox[{"radObjDrw", "[", "gQuad", "]"}]}], ";"}], "\n", 
   RowBox[{"gr", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics3D", "[", "Dwg", "]"}], ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "False"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.409476304961646*^9, 3.4094763055241394`*^9}, {
   3.4094775521287456`*^9, 3.409477614937628*^9}, {3.416660189859375*^9, 
   3.416660197484375*^9}, 3.4166617310625*^9, {3.417090084361375*^9, 
   3.417090094580125*^9}, 3.4181497207026253`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve in 2D", "Section",
 CellChangeTimes->{{3.4094863554070635`*^9, 3.409486356344551*^9}, {
   3.40948685760376*^9, 3.409486878634741*^9}, 3.4094875371575613`*^9, {
   3.415538295421875*^9, 3.415538299859375*^9}, {3.4156212895625*^9, 
   3.4156212899375*^9}, {3.41562142415625*^9, 3.4156214248125*^9}, {
   3.416396636953125*^9, 3.416396640796875*^9}, 3.416770909421875*^9, 
   3.41677155259375*^9}],

Cell[TextData[StyleBox["Solving",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
   3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
   3.415433470151483*^9, 3.415433471540545*^9}, 3.415433549694765*^9, {
   3.415433621978383*^9, 3.415433625854875*^9}, {3.4156213118125*^9, 
   3.415621313734375*^9}, {3.415621442765625*^9, 3.415621476125*^9}, {
   3.415621618359375*^9, 3.41562162415625*^9}, {3.4156217220625*^9, 
   3.415621760578125*^9}, {3.416410770796875*^9, 3.4164107726875*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"type", "=", "\"\<ESRF Quadrupole short coils : \>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "15"}], ";"}], "           ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "turns"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cur", "=", "533.3"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"Current", " ", "in", " ", "Amperes"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"BuildSolve2d", "[", 
    RowBox[{"ns", ",", "cur"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradampere", "=", 
   RowBox[{"N", "[", 
    RowBox[{"ns", "*", "cur", "*", "4", "*", 
     RowBox[{"Pi", "/", "10"}], "*", 
     RowBox[{"2", "/", 
      RowBox[{
       RowBox[{"(", "rint", ")"}], "^", "2"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"onaxisgrad2d", "=", 
   RowBox[{"res", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sz", "=", 
    RowBox[{"radObjDegFre", "[", "gOneYokeAndCoil", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "type", ",", "ns", ",", "\"\< turns  x \>\"", ",", "cur", ",", 
    "\"\< Amp \>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\< Computed 2D on-axis Gradient [T/m] :  \>\"", ",", "onaxisgrad2d"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\< The error in the computation only depends on the Triangulation\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\< Gradient assuming pure quadrupole and infinite permeability (from \
Ampere Theorem) [T/m] :  \>\"", ",", "gradampere"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\< Gradient Deviation from Unsaturated Pure Quadrupole \\n (includes \
error from coarse triangulation, saturation, and presence of additonnal \
multipoles) [%] :  \>\"", ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gradampere", "/", "onaxisgrad2d"}], "-", "1"}], ")"}]}], "*",
      "100"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Typical Memory Size of Interation Matrix [MBytes] : \>\"", ",", 
     RowBox[{"N", "[", 
      RowBox[{"sz", "*", 
       RowBox[{"(", 
        RowBox[{"sz", "+", "1"}], ")"}], "*", 
       RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Matrix Built and Solved in \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "\"\< seconds\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Average Change in Magnetisation at the last iteration [T] : \>\"", 
    ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2", ",", "1"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Maximum Absolute Magnetization [T] : \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2", ",", "2"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Maximum Absolute H vector [T] : \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2", ",", "3"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of Iterations Executed : \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2", ",", "4"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.415621785125*^9, 3.41562179921875*^9}, {
   3.4156233831875*^9, 3.415623383609375*^9}, {3.416358054671875*^9, 
   3.416358076171875*^9}, {3.416358219953125*^9, 3.416358224234375*^9}, {
   3.41636829875*^9, 3.4163684099375*^9}, {3.416368697078125*^9, 
   3.41636869771875*^9}, {3.416368729328125*^9, 3.41636872965625*^9}, {
   3.416368769859375*^9, 3.41636883440625*^9}, {3.416368986578125*^9, 
   3.41636901646875*^9}, {3.4163690735625*^9, 3.41636912096875*^9}, {
   3.416392781484375*^9, 3.416392809609375*^9}, {3.4163928488125*^9, 
   3.416392863671875*^9}, {3.41639289415625*^9, 3.416392935109375*^9}, {
   3.416392975203125*^9, 3.416393041234375*^9}, {3.416393135859375*^9, 
   3.41639316621875*^9}, {3.41639321790625*^9, 3.41639324046875*^9}, {
   3.416393341078125*^9, 3.41639341859375*^9}, {3.416393499140625*^9, 
   3.4163935086875*^9}, {3.416393582546875*^9, 3.416393755546875*^9}, {
   3.416393853875*^9, 3.416393892609375*^9}, {3.41639399740625*^9, 
   3.416394047875*^9}, {3.41639409153125*^9, 3.416394115578125*^9}, {
   3.416394147640625*^9, 3.416394324015625*^9}, {3.416394354515625*^9, 
   3.41639436859375*^9}, {3.416394534953125*^9, 3.416394538203125*^9}, {
   3.41639460546875*^9, 3.4163946949375*^9}, {3.41639473753125*^9, 
   3.41639475584375*^9}, {3.41639482690625*^9, 3.416394856703125*^9}, {
   3.416394940609375*^9, 3.416395019125*^9}, {3.41639506196875*^9, 
   3.4163950636875*^9}, {3.416409464671875*^9, 3.416409556265625*^9}, 
   3.41640958715625*^9, {3.416409625609375*^9, 3.416409626546875*^9}, {
   3.416447469234375*^9, 3.41644746953125*^9}, {3.416448640359375*^9, 
   3.416448728046875*^9}, {3.416448810140625*^9, 3.416448813421875*^9}, {
   3.416475317515625*^9, 3.416475355078125*^9}, 3.416475441296875*^9, 
   3.4166626329375*^9, {3.416771618171875*^9, 3.416771644453125*^9}, {
   3.41677179053125*^9, 3.41677179140625*^9}, {3.41677529840625*^9, 
   3.416775323671875*^9}, 3.416807807030326*^9, 3.4168088670217447`*^9, 
   3.416808949260746*^9, {3.4181497506245003`*^9, 3.4181497580776253`*^9}, {
   3.4181497962182503`*^9, 3.4181498031401253`*^9}, {3.42562977425*^9, 
   3.42562977878125*^9}, {3.425629827734375*^9, 3.4256298701875*^9}}],

Cell["\<\
The following computation assumes a linear magnetic material with relative \
permeability  mu.  This is usefull to compare with the prediction of the \
Ampere Theorem. Note that with infinite permeability, the only difference \
with the Ampere Theorem comes from the multipole content and imperfect \
segmentation.\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, {
  3.41640414046875*^9, 3.416404188609375*^9}, {3.4167145796783943`*^9, 
  3.416714588420917*^9}, {3.416771775203125*^9, 3.416771880796875*^9}, {
  3.416771922625*^9, 3.416771923109375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tbmatr", "=", "tbmat"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "the", " ", "material"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "3000"}], ";", 
  RowBox[{"tbmat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"x", "*", "mu"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "0.03", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"BuildSolve2d", "[", 
    RowBox[{"ns", ",", "cur"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\< With Linear Permability :  \>\"", ",", "mu"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\< Computed 2D on-axis Gradient  [T/m] :  \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    "\"\<  deviation from Ampere Theorem [%] : \>\"", ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gradampere", "/", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], ")"}]}], "*", 
     "100"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "6000"}], ";", 
  RowBox[{"tbmat", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"x", "*", "mu"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "0.03", ",", "0.01"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"BuildSolve2d", "[", 
    RowBox[{"ns", ",", "cur"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\< With Linear Permability :  \>\"", ",", "mu"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\< Computed 2D on-axis Gradient  [T/m] :  \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    "\"\<  deviation from Ampere Theorem [%] : \>\"", ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"gradampere", "/", 
         RowBox[{"res", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], ")"}]}], "*", 
     "100"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tbmat", "=", "tbmatr"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"restore", "  ", "the", " ", "material"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"BuildSolve2d", "[", 
    RowBox[{"ns", ",", "cur"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.416409589828125*^9, 3.416409604359375*^9}, {
   3.41640963790625*^9, 3.416409641890625*^9}, {3.416409676*^9, 
   3.416409679015625*^9}, {3.416409784015625*^9, 3.416409837171875*^9}, {
   3.4164100586875*^9, 3.4164101371875*^9}, {3.41641017009375*^9, 
   3.416410202*^9}, {3.41641024078125*^9, 3.41641032540625*^9}, {
   3.41641038959375*^9, 3.416410409046875*^9}, {3.41641054259375*^9, 
   3.41641065028125*^9}, {3.416410690671875*^9, 3.416410753453125*^9}, 
   3.41641081846875*^9, {3.41644739471875*^9, 3.416447397515625*^9}, {
   3.41644747659375*^9, 3.416447502390625*^9}, {3.41677193121875*^9, 
   3.416771938234375*^9}, 3.416772555515625*^9, 3.416777096171875*^9, 
   3.416807817143044*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Post-Processing in 2D", "Section",
 CellChangeTimes->{{3.4094871123192496`*^9, 3.409487115959828*^9}, 
   3.409487426033984*^9, {3.415538356546875*^9, 3.415538356796875*^9}, {
   3.415622213796875*^9, 3.41562223428125*^9}}],

Cell[TextData[StyleBox[" Harmonic Analysis",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}}],

Cell["\<\
The Harmonic Analysis to compute the multipole content around an axis \
requires the calculation of the field at equidistant points over a circle of \
radius R. The precision depends on the value of the radius R in relation to \
rint (the inscribed radius of the quadrupole). The optimal precision is \
reached if one uses R value not in the immediate vicinity of 0 or rint. A \
value between 1/4 rint and 3/4 rint is safe. One may want to check that the \
harmonic content weakly depends on R\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, {
  3.41640414046875*^9, 3.416404188609375*^9}, {3.4167145796783943`*^9, 
  3.416714588420917*^9}, {3.416771775203125*^9, 3.416771880796875*^9}, {
  3.416771922625*^9, 3.416771923109375*^9}, {3.416772026265625*^9, 
  3.416772071484375*^9}, {3.41677214071875*^9, 3.416772312484375*^9}, {
  3.41680914120268*^9, 3.416809179720939*^9}, {3.4256299130625*^9, 
  3.425629923953125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"R", "=", "25"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "radius", " ", "over", " ", "which", " ", "the", " ", "harmonic", " ", 
     "analysis", " ", "is", " ", "performed", " ", "in", " ", "mm"}], ";", 
    " ", 
    RowBox[{
    "the", " ", "radius", " ", "of", " ", "the", " ", "ESRF", " ", 
     "quadrupole", " ", "is", " ", "36", " ", "mm"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"np", "=", "128"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "maximum", " ", "number", " ", "of", " ", "sampling", " ", "angles", " ", 
    "for", " ", "the", " ", "harmonic", " ", "analysis"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dt", "=", "0.0"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{"initial", " ", "sampling", " ", "angle"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dx", "=", "0.1"}], ";"}], "  ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "delta", " ", "x", " ", "for", " ", "numerical", " ", "gradient", " ", 
    "computation"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HarmAnal", "[", 
    RowBox[{"R_", ",", "np_", ",", "dt_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tbh", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"radFld", "[", 
          RowBox[{"gQuad", ",", "\"\<By\>\"", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"R", " ", 
              RowBox[{"Cos", "[", "aa", "]"}]}], ",", 
             RowBox[{"R", " ", 
              RowBox[{"Sin", "[", "aa", "]"}]}], ",", "0"}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"aa", ",", "dt", ",", 
           RowBox[{
            RowBox[{"2", " ", "\[Pi]"}], "-", 
            FractionBox[
             RowBox[{"2", " ", "\[Pi]"}], "np"], "+", "dt"}], ",", 
           FractionBox[
            RowBox[{"2", " ", "\[Pi]"}], "np"]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tf", "=", 
       RowBox[{"Fourier", "[", "Tbh", "]"}]}], ";", 
      RowBox[{"tf2", "=", 
       RowBox[{"2", "*", 
        RowBox[{"tf", "/", 
         SqrtBox["np"]}]}]}], ";", " ", "\[IndentingNewLine]", "tf2"}]}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tf1", "=", 
   RowBox[{"HarmAnal", "[", 
    RowBox[{"R", ",", "np", ",", "dt"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", " ", "[", 
   "\"\<Normalized Harmonic Content (independent of R) \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<n=\>\"", ",", " ", "#", ",", "\"\< \>\"", ",", 
       RowBox[{
        RowBox[{"R", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "#"}], "+", "1"}], ")"}]}], "*", " ", 
        RowBox[{"tf1", "[", 
         RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"2", ",", "16", ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "functions", " ", "to", " ", "reconstruct", " ", "the", " ", "field", " ", 
    "and", " ", "the", " ", "gradient", " ", "from", " ", "the", " ", 
    "multipoles"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Brec", "[", 
     RowBox[{"x_", ",", "y_", ",", "nmax_", ",", "an_List"}], "]"}], ":=", 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"n", "=", "1"}], "nmax"], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         SqrtBox[
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], "R"], ")"}], "n"], "*", 
      RowBox[{"Re", "[", 
       RowBox[{"an", "[", 
        RowBox[{"[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}], "]"}], "*", 
      RowBox[{"Cos", "[", 
       RowBox[{"n", "*", 
        RowBox[{"Arg", "[", 
         RowBox[{"x", "+", 
          RowBox[{"\[ImaginaryI]", "*", "y"}]}], "]"}]}], "]"}]}]}]}], " ", 
   ";"}], "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradrec", "[", 
    RowBox[{"x_", ",", "y_", ",", "nmax_", ",", "an_List", ",", 
     RowBox[{"dx_:", "0.01"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Brec", "[", 
       RowBox[{
        RowBox[{"x", "+", 
         RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "nmax", ",", "an"}], 
       "]"}], "-", 
      RowBox[{"Brec", "[", 
       RowBox[{
        RowBox[{"x", "-", 
         RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "nmax", ",", "an"}], 
       "]"}]}], ")"}], "/", "dx"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.402217424548182*^9, {3.402217466893733*^9, 3.402217487457285*^9}, {
   3.402217533990231*^9, 3.402217541038014*^9}, {3.4022179559634247`*^9, 
   3.402217979164016*^9}, 3.402218362500408*^9, {3.40222893439821*^9, 
   3.402228959605217*^9}, {3.402230077548139*^9, 3.40223011006396*^9}, {
   3.402230334259508*^9, 3.4022303663397083`*^9}, {3.402231734741797*^9, 
   3.4022317355666428`*^9}, {3.402233456850379*^9, 3.402233566258486*^9}, 
   3.402233624794565*^9, {3.402233960623342*^9, 3.4022339643589*^9}, {
   3.402234007386633*^9, 3.402234007694069*^9}, {3.40223427797924*^9, 
   3.4022342799008713`*^9}, {3.402234402739275*^9, 3.402234427892549*^9}, {
   3.4022358226870527`*^9, 3.4022358228781424`*^9}, 3.4022358837712717`*^9, {
   3.402236332235577*^9, 3.402236369177907*^9}, {3.402236531894062*^9, 
   3.402236555632566*^9}, 3.4022393166133833`*^9, {3.402303904569273*^9, 
   3.4023039369255753`*^9}, {3.402303966949663*^9, 3.402303973685968*^9}, {
   3.402304198289982*^9, 3.402304281171166*^9}, {3.402304373592271*^9, 
   3.402304373832178*^9}, {3.4023044371721077`*^9, 3.402304450383494*^9}, 
   3.402629194618844*^9, {3.4026297383379917`*^9, 3.402629906753874*^9}, {
   3.402629958487967*^9, 3.4026299848178797`*^9}, {3.402635111794195*^9, 
   3.402635166706513*^9}, {3.4027374699005423`*^9, 3.402737478313889*^9}, {
   3.402737519981337*^9, 3.4027375203449507`*^9}, {3.402740057653429*^9, 
   3.4027400796073112`*^9}, {3.4045428411144953`*^9, 
   3.4045428460201693`*^9}, {3.404569860558105*^9, 3.404569887925131*^9}, {
   3.404616905767461*^9, 3.404616913305616*^9}, {3.404627909863628*^9, 
   3.4046279218954782`*^9}, 3.405146463246084*^9, {3.41568748590625*^9, 
   3.415687509609375*^9}, {3.415687588515625*^9, 3.41568761821875*^9}, {
   3.4156877310625*^9, 3.415687747265625*^9}, 3.415688041484375*^9, {
   3.41594522190625*^9, 3.4159452958125*^9}, {3.41594544953125*^9, 
   3.41594559790625*^9}, {3.4159458676875*^9, 3.4159458689375*^9}, 
   3.415945931046875*^9, {3.41594773940625*^9, 3.415947772109375*^9}, {
   3.41594782025*^9, 3.415947841078125*^9}, {3.415948078421875*^9, 
   3.415948201671875*^9}, {3.415980975171875*^9, 3.415980988609375*^9}, {
   3.415985759859375*^9, 3.415985782875*^9}, {3.416274702872732*^9, 
   3.4162747034854393`*^9}, {3.416275945303919*^9, 3.4162759938617897`*^9}, {
   3.416283855989788*^9, 3.4162842189565983`*^9}, {3.4162965370262003`*^9, 
   3.416296660697858*^9}, {3.416358119234375*^9, 3.416358131890625*^9}, {
   3.41636994803125*^9, 3.416370029421875*^9}, {3.416370112421875*^9, 
   3.416370114375*^9}, {3.41637035753125*^9, 3.416370594*^9}, {
   3.416370628421875*^9, 3.4163706286875*^9}, {3.4163706706875*^9, 
   3.41637067284375*^9}, {3.416370717*^9, 3.41637080059375*^9}, 
   3.41637084065625*^9, {3.416370886375*^9, 3.416370944421875*^9}, {
   3.416370984015625*^9, 3.41637125978125*^9}, {3.41638847834375*^9, 
   3.416388560234375*^9}, {3.416388616546875*^9, 3.4163886221875*^9}, {
   3.4163886941875*^9, 3.41638892921875*^9}, {3.416388962953125*^9, 
   3.41638896834375*^9}, 3.4163890058125*^9, {3.416389171171875*^9, 
   3.41638923384375*^9}, 3.41638967746875*^9, {3.416392403171875*^9, 
   3.41639242521875*^9}, {3.416392500421875*^9, 3.416392615046875*^9}, {
   3.416448836953125*^9, 3.41644883759375*^9}, {3.4164491393125*^9, 
   3.416449205265625*^9}, {3.416449264390625*^9, 3.416449300625*^9}, 
   3.416661887953125*^9, {3.416712424257681*^9, 3.416712439846678*^9}, {
   3.416772318796875*^9, 3.41677245825*^9}, {3.41677250453125*^9, 
   3.41677251140625*^9}, {3.4168078816992702`*^9, 3.416807882462788*^9}, {
   3.4181499049838753`*^9, 3.4181499058432503`*^9}}],

Cell[TextData[StyleBox[" Field Plot",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432878629249*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"radFld", "[", 
          RowBox[{"gQuad", ",", "\"\<By\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"xp", ",", "0", ",", "0"}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"-", "max"}], ",", "max", ",", "2"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"Brec", "[", 
          RowBox[{"xp", ",", "0", ",", "24", ",", "tf1"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"-", "max"}], ",", "max", ",", "2"}], "}"}]}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Mid-Plane Vert. Field [T] vs Horiz. Pos.[mm] \\n Computed Directly \
(line) \\n Reconstructed from multipoles (dots)\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.415689803640625*^9, 3.4156898045*^9}, {
   3.415945667640625*^9, 3.415945748828125*^9}, {3.41594579115625*^9, 
   3.415945793203125*^9}, {3.4159459549375*^9, 3.415945958796875*^9}, {
   3.415946249734375*^9, 3.415946348125*^9}, {3.41594701828125*^9, 
   3.415947047421875*^9}, {3.415947077578125*^9, 3.415947090265625*^9}, {
   3.4159471339375*^9, 3.41594719909375*^9}, {3.41594726671875*^9, 
   3.415947273421875*^9}, {3.415947451078125*^9, 3.415947469265625*^9}, {
   3.41594749959375*^9, 3.415947560140625*^9}, {3.41594759278125*^9, 
   3.415947656609375*^9}, {3.415947801359375*^9, 3.41594780184375*^9}, {
   3.415947876125*^9, 3.415947877546875*^9}, {3.415947939171875*^9, 
   3.4159479761875*^9}, {3.41595368478125*^9, 3.415953696453125*^9}, {
   3.41595378659375*^9, 3.415953786859375*^9}, {3.415953829*^9, 
   3.415953839296875*^9}, 3.4159538813125*^9, {3.4162756331096277`*^9, 
   3.416275690443589*^9}, {3.4162840347605133`*^9, 3.4162841605513*^9}, {
   3.41636919528125*^9, 3.41636923396875*^9}, {3.416369294921875*^9, 
   3.416369448921875*^9}, {3.416369588046875*^9, 3.416369655234375*^9}, {
   3.41636976371875*^9, 3.416369797734375*^9}, 3.41637161709375*^9, {
   3.416452819671875*^9, 3.416452839921875*^9}, 3.416661909078125*^9, {
   3.4181499386557503`*^9, 3.4181499395151253`*^9}, {3.42562998525*^9, 
   3.4256300050625*^9}, {3.425630168546875*^9, 3.42563020575*^9}}],

Cell[TextData[StyleBox[" Gradient Homogeneity",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4156883836875*^9, 3.4156883855625*^9}, {
  3.415688464859375*^9, 3.415688468734375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"max", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", "0.01"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yp", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radFldCmpPrc", "[", 
    RowBox[{
     RowBox[{"PrcB", "\[Rule]", 
      RowBox[{"10.0", "^", 
       RowBox[{"-", "15"}]}]}], ",", 
     RowBox[{"PrcCoord", "\[Rule]", 
      RowBox[{"10.0", "^", 
       RowBox[{"-", "14"}]}]}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G0", "=", 
   RowBox[{"grad2d", "[", 
    RowBox[{"gQuad", ",", "dx", ",", "yp"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tby", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"grad2d", "[", 
           RowBox[{"gQuad", ",", 
            RowBox[{"x", "+", "dx"}], ",", "yp"}], "]"}], "-", "G0"}], ")"}], 
        "/", "G0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "max", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G0rec", "=", 
   RowBox[{"gradrec", "[", 
    RowBox[{"dx", ",", "0", ",", "24", ",", "tf1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tbyrec", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gradrec", "[", 
            RowBox[{
             RowBox[{"x", "+", "dx"}], ",", "yp", ",", "24", ",", "tf1"}], 
            "]"}], "-", "G0rec"}], ")"}], "/", "G0rec"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "max", ",", "1"}], "}"}]}], "]"}]}], ";"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Tby", ",", "Tbyrec"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Mid-Plane Rel. Gradient Variation \\n vs Horizontal Position [mm] \
\\n Computed Directly (line) \\n Reconstructed from multipoles \
(dots)\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.402218920605603*^9, 3.402219231490347*^9}, {
   3.4022276594023647`*^9, 3.4022276713100557`*^9}, 3.4022289942724333`*^9, {
   3.402235496058301*^9, 3.402235628836782*^9}, {3.402235665934305*^9, 
   3.402235735563613*^9}, {3.402235980594108*^9, 3.402236096977695*^9}, {
   3.402236251547751*^9, 3.40223625865527*^9}, {3.402236390258813*^9, 
   3.402236390694332*^9}, 3.402236640282123*^9, {3.402629268447612*^9, 
   3.4026292811804667`*^9}, 3.402740096897725*^9, {3.40463111853823*^9, 
   3.404631119160001*^9}, 3.405171449131234*^9, {3.415623003078125*^9, 
   3.41562302540625*^9}, {3.4156230756875*^9, 3.415623156953125*^9}, {
   3.415623218046875*^9, 3.415623257984375*^9}, {3.4156888334375*^9, 
   3.415688853171875*^9}, 3.415688895671875*^9, {3.415947706984375*^9, 
   3.415947708140625*^9}, {3.415948251109375*^9, 3.415948364609375*^9}, {
   3.415948411375*^9, 3.41594842228125*^9}, {3.415953706828125*^9, 
   3.415953719953125*^9}, {3.415953797890625*^9, 3.415953816078125*^9}, {
   3.416369471640625*^9, 3.41636950475*^9}, {3.416369539203125*^9, 
   3.416369577578125*^9}, {3.41637145378125*^9, 3.416371525640625*^9}, {
   3.416371585265625*^9, 3.4163716131875*^9}, {3.41666191875*^9, 
   3.41666192796875*^9}, 3.416727154785942*^9, {3.418127091469261*^9, 
   3.4181271098937297`*^9}, {3.4181499523588753`*^9, 
   3.4181499731713753`*^9}, {3.425630213828125*^9, 3.42563021425*^9}, {
   3.42563026321875*^9, 3.425630279546875*^9}, {3.6700818769490285`*^9, 
   3.6700818946839743`*^9}, {3.6700819456387405`*^9, 3.6700819598892126`*^9}}],

Cell[TextData[StyleBox[" Field and Magnetization Line Plots",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gra", "[", 
     RowBox[{"gt_", ",", "field_", ",", "label_", ",", 
      RowBox[{"{", 
       RowBox[{"xmin_", ",", "xmax_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ymin_", ",", "ymax_"}], "}"}], ",", 
      RowBox[{"pts_:", "15"}], ",", 
      RowBox[{"sca_:", "10"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"polgra", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"poly1", "~", "Join", "~", 
           RowBox[{"{", 
            RowBox[{"poly1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Mesh", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<+\>\"", ",", "25"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MeshStyle", "\[Rule]", "Red"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"fieldgra", "=", 
        RowBox[{"VectorFieldPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"radFld", "[", 
           RowBox[{"gt", ",", 
            RowBox[{"StringJoin", "[", 
             RowBox[{
             "field", ",", "\"\<x\>\"", ",", "field", ",", "\"\<y\>\""}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"xt", ",", "yt", ",", "0"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"xt", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"yt", ",", "ymin", ",", "ymax"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotPoints", "\[Rule]", "pts"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ScaleFactor", "\[Rule]", "sca"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"fieldgra", ",", "polgra", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"ymin", ",", "ymax"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "label"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"gra", "[", 
  RowBox[{"gQuad", ",", "\"\<b\>\"", ",", "\"\<B  Field  \>\"", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "100"}], "}"}], ",", "25", ",", "10"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"gra", "[", 
  RowBox[{"gQuad", ",", "\"\<m\>\"", ",", "\"\<Magnetization \>\"", ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "200"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "250"}], "}"}], ",", "15", ",", "15"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.409617902734375*^9, 3.4096179108125*^9}, {
   3.409618527203125*^9, 3.409618535125*^9}, {3.409618709234375*^9, 
   3.40961870978125*^9}, {3.409618758671875*^9, 3.409618808421875*^9}, {
   3.409619898171875*^9, 3.40961990975*^9}, 3.409620531625*^9, {
   3.409620593515625*^9, 3.409620606375*^9}, {3.409620689125*^9, 
   3.409620690421875*^9}, {3.40962093678125*^9, 3.409620942359375*^9}, {
   3.40963166344817*^9, 3.4096316933225965`*^9}, {3.415888350234375*^9, 
   3.41588839821875*^9}, {3.415888479625*^9, 3.415888532265625*^9}, 
   3.415939455640625*^9, {3.41596598809375*^9, 3.41596599028125*^9}, {
   3.416046922218*^9, 3.416046938889875*^9}, {3.416046987468*^9, 
   3.41604705524925*^9}, {3.4162967224439297`*^9, 3.416296823856925*^9}, {
   3.41636971275*^9, 3.416369730171875*^9}, {3.41637165159375*^9, 
   3.416371698859375*^9}, 3.4163717323125*^9, {3.416371929796875*^9, 
   3.416371942515625*^9}, {3.416372061953125*^9, 3.416372062484375*^9}, {
   3.416372130125*^9, 3.416372156328125*^9}, {3.416372200703125*^9, 
   3.416372237671875*^9}, {3.416372272234375*^9, 3.416372582453125*^9}, {
   3.416661947546875*^9, 3.41666194878125*^9}, 3.416807944747594*^9, {
   3.4181500292963753`*^9, 3.4181500351401253`*^9}, {3.4326718841870003`*^9, 
   3.4326718952963753`*^9}, {3.432882464234375*^9, 3.43288247134375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy and Inductance in 2D", "Section",
 CellChangeTimes->{{3.409487135990822*^9, 3.4094871406157627`*^9}, {
   3.409617862359375*^9, 3.40961786471875*^9}, {3.409621625234375*^9, 
   3.4096216539375*^9}, {3.4096628880519266`*^9, 3.4096628912392025`*^9}, {
   3.40973952878125*^9, 3.409739534296875*^9}, {3.4155571718125*^9, 
   3.41555717309375*^9}, {3.415622245203125*^9, 3.4156222481875*^9}, 
   3.41647585284375*^9}],

Cell[TextData[StyleBox[" Auxiliary Functions",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}, {
  3.415557041421875*^9, 3.415557046265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ff", "[", 
    RowBox[{"pre_", ",", "gdest_", ",", "gsrc_", ",", "cur_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "en", ",", "self", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radFldCmpPrc", "[", 
       RowBox[{"PrcEnergy", "\[Rule]", "pre"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"AbsoluteTiming", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldEnr", "[", 
          RowBox[{"gdest", ",", "gsrc"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"en", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"10", "^", "3"}], ")"}], "*", "0.5", "*", 
        RowBox[{
         RowBox[{"res", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "/", "lmag2d"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"self", "=", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"10", "^", "3"}], ")"}], "*", 
        RowBox[{
         RowBox[{"Abs", "[", "en", "]"}], "/", 
         RowBox[{"cur", "^", "2"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Energy = \>\"", ",", "en", ",", 
        "\"\< J/m,  Self-Inductance = \>\"", ",", "self", ",", 
        "\"\< mH/m;  Computed in \>\"", ",", 
        RowBox[{"res", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.40972599734375*^9, 3.4097261711875*^9}, {
   3.409730818765625*^9, 3.409730899171875*^9}, {3.4154532822966433`*^9, 
   3.415453287955696*^9}, {3.415453394869276*^9, 3.4154534060104427`*^9}, 
   3.415453477693273*^9, {3.4154535137726*^9, 3.415453607286008*^9}, {
   3.415453647639556*^9, 3.41545372402919*^9}, {3.4154537574199057`*^9, 
   3.415453845156973*^9}, {3.415453951660961*^9, 3.4154539660839376`*^9}, {
   3.415553913703125*^9, 3.415553991015625*^9}, {3.415554037390625*^9, 
   3.415554041234375*^9}, {3.415554242453125*^9, 3.415554272125*^9}, {
   3.41555430346875*^9, 3.415554312375*^9}, {3.415556756359375*^9, 
   3.4155567615625*^9}, {3.415556871953125*^9, 3.415556920796875*^9}, {
   3.4160479213145123`*^9, 3.416047929076168*^9}, {3.416048359393077*^9, 
   3.4160483604237328`*^9}, {3.41607011987285*^9, 3.4160701334987907`*^9}, {
   3.416070212320569*^9, 3.416070216002239*^9}, {3.4160703824586077`*^9, 
   3.41607040201889*^9}, {3.416070491944373*^9, 3.4160704943069763`*^9}, {
   3.416071066542184*^9, 3.4160710736493177`*^9}, {3.416071109378084*^9, 
   3.416071114562374*^9}, 3.416071271664454*^9, {3.416071415119484*^9, 
   3.416071443689001*^9}, {3.416072879487626*^9, 3.4160729016281233`*^9}, {
   3.4160820954528112`*^9, 3.416082187001618*^9}, {3.416083167386005*^9, 
   3.416083174105299*^9}, {3.41639560371875*^9, 3.416395629*^9}, 
   3.416395682515625*^9, {3.416395889015625*^9, 3.416395918671875*^9}, {
   3.416660133859375*^9, 3.416660134734375*^9}, 3.41666043171875*^9, {
   3.4166623589375*^9, 3.416662369765625*^9}, {3.4166624025*^9, 
   3.416662428109375*^9}, {3.4170138426565*^9, 3.417013843094*^9}, 
   3.4181447818588753`*^9, {3.425630389953125*^9, 3.42563040659375*^9}, 
   3.425633345609375*^9}],

Cell[TextData[StyleBox["  Energy and Self-Inductance",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
   3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}, {
   3.415557041421875*^9, 3.415557078015625*^9}, {3.41605284939349*^9, 
   3.41605285531452*^9}, {3.416071380064884*^9, 3.416071384155366*^9}, {
   3.4160714675289927`*^9, 3.416071512181987*^9}, 3.4160832124171553`*^9, {
   3.416395936671875*^9, 3.416395962640625*^9}, {3.416662044125*^9, 
   3.4166620808125*^9}, 3.41666243965625*^9, {3.41677264465625*^9, 
   3.4167726561875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gdest", "=", "gAllCoils"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gsrc", "=", "gQuad"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ff", "[", 
  RowBox[{"10", ",", "gdest", ",", "gsrc", ",", "533.3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.41639584021875*^9, 3.416395879984375*^9}, 
   3.416660044328125*^9, {3.41666026978125*^9, 3.416660289234375*^9}, {
   3.4166603778125*^9, 3.41666039384375*^9}, {3.41666046840625*^9, 
   3.416660486390625*^9}, {3.416660573390625*^9, 3.416660574125*^9}, {
   3.41666195853125*^9, 3.416661981125*^9}, {3.41666201453125*^9, 
   3.4166620348125*^9}, {3.4181500819682503`*^9, 3.4181500955463753`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Gradient vs Current in 2D", "Section",
 CellChangeTimes->{{3.409486830275985*^9, 3.409486836650903*^9}, {
  3.4156222570625*^9, 3.4156222588125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imin", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imax", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ni", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nt", "=", "15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"istep", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"imax", "-", "imin"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"ni", "-", "1"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], "=", 
    RowBox[{"build2d", "[", 
     RowBox[{"nt", ",", "imin"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"time", ",", "mtrx"}], "}"}], "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"radRlxPre", "[", "gQuad", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Time to build the Matrix [sec] : \>\"", ",", "time"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"time", ",", "res"}], "}"}], " ", "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"imin", "+", 
         RowBox[{"j", "*", "istep"}]}], ",", 
        RowBox[{
         RowBox[{"ScaleSolve", "[", 
          RowBox[{"gQuad", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"imin", "+", 
              RowBox[{"j", "*", "istep"}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"imin", "+", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"j", "\[Equal]", "0"}], ",", "0", ",", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "]"}], "*", "istep"}]}], 
             ")"}]}], ",", "mtrx", ",", "grad2d"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"ni", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Time to Relax the Matrix 10 times [sec] : \>\"", ",", "time"}], "]"}],
   ";"}], "\[IndentingNewLine]", "res", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radUtiDel", "[", "mtrx", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"res", ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", " ", 
     "\"\< 2D On-Axis Gradient [T/m] vs Current [A] \>\""}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Print", "[", 
    "\"\<A simpler version of the same computation less efficient in CPU, \
where the Matrix is rebuilt at each iteration and relaxation is each time \
restarted from 0 \>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"time", ",", "res"}], "}"}], "=", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cur", ",", 
        RowBox[{
         RowBox[{"BuildSolve2d", "[", 
          RowBox[{"nt", ",", "cur"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"cur", ",", "imin", ",", "imax", ",", "istep"}], "}"}]}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Time to Build and Relax the Matrix 10 times [sec] : \>\"", ",", 
    "time"}], "]"}], ";"}], "\[IndentingNewLine]", "res"}], "Input",
 CellChangeTimes->{{3.4094832689446507`*^9, 3.409483276866424*^9}, 
   3.409483328272016*^9, {3.4094834634577856`*^9, 3.4094836030809984`*^9}, {
   3.4094836525178657`*^9, 3.4094836530647335`*^9}, {3.4094836868455515`*^9, 
   3.4094836935485907`*^9}, {3.409483852640304*^9, 3.409483853484043*^9}, {
   3.4094839758574767`*^9, 3.409484003044629*^9}, {3.4094850569549336`*^9, 
   3.4094850642985897`*^9}, {3.409536373609375*^9, 3.40953637415625*^9}, {
   3.409567599185582*^9, 3.4095676040915184`*^9}, {3.4096431307054663`*^9, 
   3.4096431312367125`*^9}, {3.415623504078125*^9, 3.415623504484375*^9}, {
   3.4163951464375*^9, 3.41639518803125*^9}, {3.41639527640625*^9, 
   3.416395282046875*^9}, {3.416395644359375*^9, 3.416395663078125*^9}, {
   3.416772681625*^9, 3.4167726955*^9}, 3.416775110625*^9, 
   3.416775234796875*^9, {3.41812837282879*^9, 3.4181283893499393`*^9}, 
   3.4181284728231115`*^9, {3.418128588083824*^9, 3.4181286062804093`*^9}, 
   3.4181448461870003`*^9, {3.4181448945151253`*^9, 3.4181449348120003`*^9}, {
   3.4181450747495003`*^9, 3.4181450777338753`*^9}, {3.4181451274213753`*^9, 
   3.4181451299682503`*^9}, 3.4181451742026253`*^9, {3.4181452262807503`*^9, 
   3.4181452454057503`*^9}, 3.4181460372651253`*^9, 3.4181460860151253`*^9, {
   3.4181462261557503`*^9, 3.4181462793120003`*^9}, {3.4181463217026253`*^9, 
   3.4181463293276253`*^9}, {3.4181463825307503`*^9, 3.4181463826245003`*^9}, 
   3.4181465207495003`*^9, {3.4181465638901253`*^9, 3.4181466098901253`*^9}, {
   3.4181466709838753`*^9, 3.4181466768276253`*^9}, 3.4181467390776253`*^9, {
   3.4181469087963753`*^9, 3.4181469210463753`*^9}, {3.4181472021557503`*^9, 
   3.4181472754526253`*^9}, {3.4181473134057503`*^9, 
   3.4181473176401253`*^9}, {3.4181474480620003`*^9, 
   3.4181474723432503`*^9}, {3.4181479046870003`*^9, 
   3.4181479253745003`*^9}, {3.4181479771245003`*^9, 
   3.4181479991401253`*^9}, {3.4181485310620003`*^9, 3.4181485312651253`*^9}, 
   3.4181501844057503`*^9, {3.418553873554223*^9, 3.4185539707223663`*^9}, 
   3.4185540463288383`*^9, {3.4185544633440742`*^9, 3.4185546195255766`*^9}, {
   3.418554657336624*^9, 3.41855466044588*^9}, {3.418554743661434*^9, 
   3.418554743989547*^9}, {3.4185551202094746`*^9, 3.4185551486615067`*^9}, {
   3.4185552842344255`*^9, 3.418555286640583*^9}, {3.418555677938057*^9, 
   3.4185556981247816`*^9}, {3.425630488453125*^9, 3.425630506578125*^9}, {
   3.425630665796875*^9, 3.42563074953125*^9}}]
}, Closed]],

Cell["3 - Dimensional Simulation", "Subtitle"],

Cell[CellGroupData[{

Cell["Introduction", "Section",
 CellChangeTimes->{{3.416396697109375*^9, 3.41639670003125*^9}}],

Cell["\<\
This part concerns the 3D simulation of the same quadrupole. The yoke is \
created with its actual length. The extremities of the pole are machined to \
generate the chamfer. The model is created with a number of layers along the \
beam axis (longitudinal segmentation). At the end, the multipole expansion is \
computed as well as the magnetic length of the quadrupole. The accurate \
computation requires a large longitudinal segmentation and the memory \
requirement is significant. For this type of computation, the time longer \
than 10 minutes, as well as memory well above 200 MB are required.\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, 
   3.416720232802808*^9, {3.416742126789075*^9, 3.4167422471000347`*^9}, {
   3.416742300411852*^9, 3.4167425252058496`*^9}, {3.4168080345997486`*^9, 
   3.416808136139228*^9}, {3.4168081813302183`*^9, 3.4168082590974493`*^9}, {
   3.416809546021225*^9, 3.4168095652685604`*^9}, {3.42563085234375*^9, 
   3.425630853875*^9}, {3.425630896625*^9, 3.42563089696875*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Show in 3D  ", "Section",
 CellChangeTimes->{{3.4022054321547194`*^9, 3.4022054536763906`*^9}, {
   3.4094863107513847`*^9, 3.409486322860605*^9}, {3.41543188649361*^9, 
   3.415431900644185*^9}, {3.415431995271237*^9, 3.4154319957152967`*^9}, {
   3.415538268515625*^9, 3.415538285125*^9}, {3.416396630734375*^9, 
   3.416396635609375*^9}, {3.4163970619375*^9, 3.416397065671875*^9}, {
   3.41644456925*^9, 3.4164445710625*^9}, {3.416475843953125*^9, 
   3.416475845953125*^9}, {3.41677067321875*^9, 3.416770674609375*^9}, 
   3.4168062784322186`*^9, {3.41700827918775*^9, 3.417008305344*^9}, 
   3.417008356859625*^9}],

Cell[TextData[StyleBox["Instantiating the Quadrupole and compute the memory \
requirement ",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154333063331757`*^9, 
   3.4154333388931723`*^9}, 3.415433562862254*^9, {3.416771310953125*^9, 
   3.416771317*^9}, {3.416771373921875*^9, 3.41677137653125*^9}, {
   3.416771438609375*^9, 3.4167714511875*^9}, {3.41677151221875*^9, 
   3.41677152675*^9}, 3.416771953265625*^9, 3.416806575102335*^9, {
   3.416807420905491*^9, 3.416807423876534*^9}, {3.416807510231806*^9, 
   3.416807511275324*^9}, {3.417089985377*^9, 3.417089995611375*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "15"}], ";"}], "                     ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "turn"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"current", "=", "533.3"}], ";"}], "   ", 
  RowBox[{"(*", " ", "current", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lmag", "=", "400"}], ";"}], "              ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "actual", " ", "iron", " ", "length", " ", "of", " ", "the", " ", 
    "quadrupole"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nz", "=", " ", 
    RowBox[{"{", 
     RowBox[{"2", ",", "0.2"}], "}"}]}], ";"}], "       ", 
  RowBox[{"(*", " ", 
   RowBox[{"longitudinal", " ", "segmentation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "=", "7"}], ";"}], "                       ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "size", " ", "in", " ", "mm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ach", "=", "45"}], ";"}], "                  ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "angle", " ", "in", " ", "degrees"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], "=", 
   RowBox[{"build3d", "[", 
    RowBox[{"ns", ",", "current"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sz", "=", 
   RowBox[{"radObjDegFre", "[", "gOneYokeAndCoil", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Memory Size of Interation Matrix M] = \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{"sz", "*", 
      RowBox[{"(", 
       RowBox[{"sz", "+", "1"}], ")"}], "*", 
      RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.416444785375*^9, {3.416444816296875*^9, 3.416444954078125*^9}, 
   3.41644520959375*^9, {3.4164480444375*^9, 3.416448044828125*^9}, {
   3.41644818196875*^9, 3.416448182703125*^9}, {3.41645690971875*^9, 
   3.416456910109375*^9}, 3.416457005453125*^9, {3.41666270009375*^9, 
   3.4166627050625*^9}, {3.416712535759377*^9, 3.416712567902876*^9}, {
   3.416720269678887*^9, 3.4167203884172897`*^9}, {3.416720809725748*^9, 
   3.416721050014288*^9}, 3.416775486046875*^9, {3.416775606640625*^9, 
   3.416775749046875*^9}, {3.4181502287338753`*^9, 3.4181502616088753`*^9}}],

Cell[TextData[StyleBox["Show  the Geometry",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154333063331757`*^9, 
   3.4154333388931723`*^9}, 3.415433562862254*^9, {3.416464117296875*^9, 
   3.4164641204375*^9}, 3.416773621671875*^9, {3.416777286453125*^9, 
   3.416777289171875*^9}, {3.417090397705125*^9, 3.417090399377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "only", " ", "a", " ", "single", " ", "pole", " ", "and", " ", "coil", " ",
     "before", " ", "applying", " ", "the", " ", "symmetries"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "sure", " ", "that", " ", "build3d", " ", "has", " ", "been", 
    " ", "invoked", " ", "with", " ", "low", " ", "longitudinal", " ", 
    "segmentation", " ", "nz", " ", "to", " ", "get", " ", "an", " ", 
    "acceptable", " ", "response", " ", "time"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dwg", "=", 
     RowBox[{"radObjDrw", "[", "gOneYokeAndCoil", "]"}]}], ";"}], "\n", 
   RowBox[{"gr", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics3D", "[", "Dwg", "]"}], " ", ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "False"}]}], " ", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.4094764131790113`*^9, 3.4094764228507624`*^9}, {
   3.409536577171875*^9, 3.409536581578125*^9}, {3.41561932590625*^9, 
   3.41561932621875*^9}, {3.41561936578125*^9, 3.415619393046875*^9}, {
   3.415619596953125*^9, 3.41561960771875*^9}, {3.415619658765625*^9, 
   3.415619718484375*^9}, {3.4156197913125*^9, 3.415619791734375*^9}, {
   3.415619840296875*^9, 3.41561984628125*^9}, 3.415619890859375*^9, {
   3.415620168*^9, 3.41562021865625*^9}, {3.41562033015625*^9, 
   3.415620440015625*^9}, {3.415620623578125*^9, 3.415620624609375*^9}, 
   3.41562156715625*^9, {3.415624333*^9, 3.415624341203125*^9}, {
   3.416106092954256*^9, 3.4161060960130987`*^9}, {3.416296889089717*^9, 
   3.416296923595234*^9}, 3.416444658265625*^9, {3.41644494296875*^9, 
   3.41644494378125*^9}, {3.4164749576875*^9, 3.41647504984375*^9}, 
   3.41666271009375*^9, {3.4168084270715013`*^9, 3.4168084507137947`*^9}, {
   3.41709012684575*^9, 3.417090127392625*^9}, {3.4181503396245003`*^9, 
   3.4181503573276253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"full", " ", "quadrupole"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "make", " ", "sure", " ", "that", " ", "build3d", " ", "has", " ", "been", 
    " ", "invoked", " ", "with", " ", "low", " ", "longitudinal", " ", 
    "segmentation", " ", "nz", " ", "to", " ", "get", " ", "an", " ", 
    "acceptable", " ", "response", " ", "time"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dwg", "=", 
     RowBox[{"radObjDrw", "[", "gQuad", "]"}]}], ";"}], "\n", 
   RowBox[{"gr", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"Graphics3D", "[", "Dwg", "]"}], " ", ",", 
      RowBox[{"ViewPoint", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "Infinity"}], "}"}]}], ",", 
      RowBox[{"Axes", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "False"}]}], " ", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.416464107171875*^9, 3.41646410746875*^9}, {
   3.41647505890625*^9, 3.416475060109375*^9}, 3.416662720109375*^9, {
   3.416808453971039*^9, 3.416808457462056*^9}, {3.4170901129395*^9, 
   3.4170901133145*^9}, {3.4181503720151253`*^9, 3.4181503827495003`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solve in 3D", "Section",
 CellChangeTimes->{{3.4094863554070635`*^9, 3.409486356344551*^9}, {
   3.40948685760376*^9, 3.409486878634741*^9}, 3.4094875371575613`*^9, {
   3.415538295421875*^9, 3.415538299859375*^9}, {3.4156212895625*^9, 
   3.4156212899375*^9}, {3.41562142415625*^9, 3.4156214248125*^9}, 
   3.415622139765625*^9, {3.416397293078125*^9, 3.41639729628125*^9}, 
   3.4167734643125*^9, 3.4168062849141645`*^9}],

Cell[TextData[StyleBox["Solving ",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.4154332692295437`*^9, 
   3.415433274077325*^9}, {3.415433411414833*^9, 3.415433428389324*^9}, {
   3.415433470151483*^9, 3.415433471540545*^9}, 3.415433549694765*^9, {
   3.415433621978383*^9, 3.415433625854875*^9}, {3.4156213118125*^9, 
   3.415621313734375*^9}, {3.415621442765625*^9, 3.415621476125*^9}, {
   3.415621618359375*^9, 3.41562162415625*^9}, {3.4156217220625*^9, 
   3.415621760578125*^9}, {3.41644820921875*^9, 3.416448211484375*^9}}],

Cell["\<\
The solving time and memory requirement largely depends on nz (the \
longitudinal segmentation).To debug and accelerate the computation use e.g. \
nz = {2, 1}, the price is a poor absolute precision. For lmag = 400, some \
stability of the gradient versus horizontal position as well as magnetic \
length is obtained with nz = {32, 1}, which need quite some cpu and memory. \
In practice one must increase nz[[1]] to check the stability of the result.\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, 
   3.416720232802808*^9, {3.416742126789075*^9, 3.4167422471000347`*^9}, {
   3.416742300411852*^9, 3.4167425252058496`*^9}, {3.4168080345997486`*^9, 
   3.416808136139228*^9}, {3.4168081813302183`*^9, 3.4168082590974493`*^9}, {
   3.416809546021225*^9, 3.4168095652685604`*^9}, {3.42563085234375*^9, 
   3.425630853875*^9}, {3.425630896625*^9, 3.42563089696875*^9}, {
   3.42563250759375*^9, 3.42563260271875*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ns", "=", "15"}], ";"}], "                              ", 
  RowBox[{"(*", "  ", 
   RowBox[{"number", " ", "of", " ", "turns"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"current", "=", "533.3"}], ";"}], "            ", 
  RowBox[{"(*", " ", 
   RowBox[{"current", " ", "in", " ", "Amperes"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lmag", "=", "400"}], ";"}], "                        ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "actual", " ", "iron", " ", "length", " ", "of", " ", "the", " ", 
    "quadrupole"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nz", "=", " ", 
    RowBox[{"{", 
     RowBox[{"9", ",", "1"}], "}"}]}], ";"}], "                    ", 
  RowBox[{"(*", " ", 
   RowBox[{"longitudinal", " ", "segmentation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "=", "7"}], ";"}], "                                ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "size", " ", "in", " ", "mm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ach", "=", "45"}], ";"}], "                           ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "angle", " ", "in", " ", "degrees"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"res", "=", 
   RowBox[{"BuildSolve3d", "[", 
    RowBox[{"ns", ",", "current"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sz", "=", 
    RowBox[{"radObjDegFre", "[", "gOneYokeAndCoil", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "\"\<ESRF Quadrupole Short Coils :  \>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
   "\"\<Coil :  \>\"", ",", "ns", ",", "\"\< turn x \>\"", ",", "cur", ",", 
    "\"\< A \>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Yoke Length [mm] : \>\"", ",", "lmag"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Longitudinal segmentation : \>\"", ",", "nz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Chamfer Size [mm] : \>\"", ",", "ch"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Chamfer Angle [deg] : \>\"", ",", "ach"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Number of Degrees of Freedom = \>\"", ",", "sz"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{
    "\"\<Typical Memory Size of Interation Matrix [MBytes] = \>\"", ",", 
     RowBox[{"N", "[", 
      RowBox[{"sz", "*", 
       RowBox[{"(", 
        RowBox[{"sz", "+", "1"}], ")"}], "*", 
       RowBox[{"4", "/", "1000000"}]}], "]"}]}], "]"}], ";"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Matrix Built and Solved in \>\"", ",", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "/", "60"}], "]"}], ",", 
    "\"\< minutes\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Relaxation results = \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Integrated Gradient [T] : \>\"", ",", 
    RowBox[{"res", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Magnetic Length [mm] : \>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"res", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "/", "onaxisgrad2d"}], "*", "1000"}]}],
    "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.415621785125*^9, 3.41562179921875*^9}, {
   3.415623879328125*^9, 3.41562392865625*^9}, {3.415624533390625*^9, 
   3.415624541265625*^9}, {3.41562677046875*^9, 3.4156267805625*^9}, {
   3.415697699546875*^9, 3.415697703328125*^9}, {3.41644506628125*^9, 
   3.41644506671875*^9}, {3.416445294140625*^9, 3.416445355171875*^9}, {
   3.41644799271875*^9, 3.41644799728125*^9}, {3.41644819559375*^9, 
   3.416448314921875*^9}, {3.416448348984375*^9, 3.416448457984375*^9}, {
   3.416448554828125*^9, 3.4164486121875*^9}, {3.416448899109375*^9, 
   3.41644897121875*^9}, {3.416449036015625*^9, 3.41644907209375*^9}, {
   3.416449705359375*^9, 3.41644973275*^9}, 3.4164530334375*^9, {
   3.416456966171875*^9, 3.416457016828125*^9}, 3.41646538803125*^9, {
   3.416470954046875*^9, 3.41647096028125*^9}, 3.416471535984375*^9, {
   3.416475239046875*^9, 3.41647525621875*^9}, 3.416475300921875*^9, {
   3.416475398625*^9, 3.4164754323125*^9}, 3.4166627703125*^9, {
   3.416663148984375*^9, 3.4166631575*^9}, {3.416663670828125*^9, 
   3.416663671296875*^9}, 3.416721011574649*^9, 3.416721426707633*^9, {
   3.41677351340625*^9, 3.4167735183125*^9}, {3.41677664803125*^9, 
   3.4167767330625*^9}, {3.416809722086501*^9, 3.4168097477809877`*^9}, {
   3.4168097826050177`*^9, 3.4168098009739094`*^9}, {3.416810836666999*^9, 
   3.4168108446072607`*^9}, {3.4181485788901253`*^9, 
   3.4181486012651253`*^9}, {3.4181504202495003`*^9, 
   3.4181504291401253`*^9}, {3.4181525409213753`*^9, 
   3.4181525493745003`*^9}, {3.4185548740001793`*^9, 
   3.4185550605555153`*^9}, {3.4185554461344585`*^9, 3.418555459837057*^9}, 
   3.42563250415625*^9, 3.42563261578125*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Post-Processing in 3D", "Section",
 CellChangeTimes->{{3.4094871123192496`*^9, 3.409487115959828*^9}, 
   3.409487426033984*^9, {3.415538356546875*^9, 3.415538356796875*^9}, {
   3.415622213796875*^9, 3.41562223428125*^9}, {3.415627351625*^9, 
   3.415627352015625*^9}}],

Cell[TextData[StyleBox[" Harmonic Analysis",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}}],

Cell["\<\
The Harmonic Analysis to compute the multipole content around an axis \
requires the computation of the field on equidistant points over a circle of \
radius R. The precision depends on the value of the radius R in relation to \
rint (the inscribed radius of the quadrupole). The optimum precision is \
reached if one uses a R value not in the immediate vicinity of 0 or rint. A \
value between 1/4 rint and 3/4 rint is safe. One may want to check that the \
harmonic content weakly depends on R.\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, {
  3.41640414046875*^9, 3.416404188609375*^9}, {3.4167145796783943`*^9, 
  3.416714588420917*^9}, {3.41677634653125*^9, 3.416776417984375*^9}, {
  3.4168098710978494`*^9, 3.416809882303401*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"R", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np", "=", "128"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dx", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dz", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dth", "=", "0."}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tbh", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"radFldInt", "[", 
        RowBox[{"gQuad", ",", "\"\<inf\>\"", ",", "\"\<IBy\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"aa", "+", "dth"}], "]"}]}], "+", "dx"}], ",", 
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"Sin", " ", "[", 
              RowBox[{"aa", "+", "dth"}], "]"}]}], "+", "dz"}], ",", 
           RowBox[{"-", "100."}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"aa", "+", "dth"}], "]"}]}], "+", "dx"}], ",", 
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"Sin", " ", "[", 
              RowBox[{"aa", "+", "dth"}], "]"}]}], "+", "dz"}], ",", "100."}],
           "}"}]}], "]"}], ")"}], "/", "1000"}], " ", ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", "0", ",", 
       RowBox[{
        RowBox[{"2", " ", "Pi"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Pi", "/", "np"}]}]}], ",", 
       StyleBox[
        RowBox[{"2", " ", 
         RowBox[{"Pi", "/", "np"}]}],
        FontFamily->"Courier"]}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"tf", "=", 
    RowBox[{"Fourier", "[", "Tbh", "]"}]}], ";", 
   RowBox[{"tf1", "=", 
    RowBox[{"2", "*", 
     RowBox[{"tf", "/", 
      SqrtBox["np"]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", " ", "[", "\"\<Normalized Harmonic Content (independent of R)\>\"",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<n=\>\"", ",", " ", "#", ",", "\"\<:  \>\"", ",", 
      RowBox[{
       RowBox[{"R", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "#"}], "+", "1"}], ")"}]}], "*", " ", 
       RowBox[{"tf1", "[", 
        RowBox[{"[", "#", "]"}], "]"}]}]}], "]"}], "&"}], "/@", 
   RowBox[{"Range", "[", 
    RowBox[{"2", ",", "16", ",", "2"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.402217424548182*^9, {3.402217466893733*^9, 3.402217487457285*^9}, {
   3.402217533990231*^9, 3.402217541038014*^9}, {3.4022179559634247`*^9, 
   3.402217979164016*^9}, 3.402218362500408*^9, {3.40222893439821*^9, 
   3.402228959605217*^9}, {3.402230077548139*^9, 3.40223011006396*^9}, {
   3.402230334259508*^9, 3.4022303663397083`*^9}, {3.402231734741797*^9, 
   3.4022317355666428`*^9}, {3.402233456850379*^9, 3.402233566258486*^9}, 
   3.402233624794565*^9, {3.402233960623342*^9, 3.4022339643589*^9}, {
   3.402234007386633*^9, 3.402234007694069*^9}, {3.40223427797924*^9, 
   3.4022342799008713`*^9}, {3.402234402739275*^9, 3.402234427892549*^9}, {
   3.4022358226870527`*^9, 3.4022358228781424`*^9}, 3.4022358837712717`*^9, {
   3.402236332235577*^9, 3.402236369177907*^9}, {3.402236531894062*^9, 
   3.402236555632566*^9}, 3.4022393166133833`*^9, {3.402303904569273*^9, 
   3.4023039369255753`*^9}, {3.402303966949663*^9, 3.402303973685968*^9}, {
   3.402304198289982*^9, 3.402304281171166*^9}, {3.402304373592271*^9, 
   3.402304373832178*^9}, {3.4023044371721077`*^9, 3.402304450383494*^9}, 
   3.402629194618844*^9, {3.4026297383379917`*^9, 3.402629906753874*^9}, {
   3.402629958487967*^9, 3.4026299848178797`*^9}, {3.402635111794195*^9, 
   3.402635166706513*^9}, {3.4027374699005423`*^9, 3.402737478313889*^9}, {
   3.402737519981337*^9, 3.4027375203449507`*^9}, {3.402740057653429*^9, 
   3.4027400796073112`*^9}, {3.4045428411144953`*^9, 
   3.4045428460201693`*^9}, {3.404569860558105*^9, 3.404569887925131*^9}, {
   3.404616905767461*^9, 3.404616913305616*^9}, {3.404627909863628*^9, 
   3.4046279218954782`*^9}, 3.405146463246084*^9, {3.41568779478125*^9, 
   3.415687821609375*^9}, {3.41568787925*^9, 3.415687881515625*^9}, {
   3.41568817890625*^9, 3.415688208046875*^9}, {3.415688269609375*^9, 
   3.415688280734375*^9}, {3.415886329859375*^9, 3.415886335046875*^9}, {
   3.415951774359375*^9, 3.415951802390625*^9}, 3.415952020046875*^9, {
   3.4159862056875*^9, 3.41598620915625*^9}, {3.416276083844736*^9, 
   3.416276084732471*^9}, {3.4162969578750467`*^9, 3.4162971136086397`*^9}, 
   3.416449093140625*^9, 3.416449219546875*^9, 3.416449249765625*^9, {
   3.416449320109375*^9, 3.416449353125*^9}, 3.4164547895*^9, {
   3.416662797265625*^9, 3.416662801828125*^9}, 3.416663284484375*^9, {
   3.4167211580863857`*^9, 3.416721388573505*^9}, {3.41677642365625*^9, 
   3.416776446796875*^9}, {3.4181504912651253`*^9, 3.4181504922182503`*^9}, {
   3.425632721296875*^9, 3.425632724390625*^9}, 3.42563276565625*^9}],

Cell[TextData[StyleBox[" Field Integral Plot",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
   3.415432878629249*^9}, {3.415628069171875*^9, 3.415628071265625*^9}, 
   3.41568711403125*^9, 3.41568714515625*^9, {3.4156873703125*^9, 
   3.41568737090625*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yp", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xmax", "=", "35"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{
          RowBox[{"radFldInt", "[", 
           RowBox[{"gQuad", ",", "\"\<inf\>\"", ",", "\"\<IBy\>\"", ",", 
            RowBox[{"{", 
             RowBox[{"xp", ",", "yp", ",", 
              RowBox[{"-", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xp", ",", "yp", ",", "100"}], "}"}]}], "]"}], "/", 
          "1000"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"-", "xmax"}], ",", "xmax", ",", "2.5"}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"Brec", "[", 
          RowBox[{"xp", ",", "yp", ",", "24", ",", "tf1"}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"xp", ",", 
         RowBox[{"-", "xmax"}], ",", "xmax", ",", "2.5"}], "}"}]}], "]"}]}], 
    "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Mid-Plane Vert. Field Integral [T.m] \\n vs Horiz. Position [mm] \\n \
Computed Directly (line) \\n Reconstructed from Multipoles (dots)\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.41562746884375*^9, 3.415627479421875*^9}, {
   3.415627531359375*^9, 3.41562754353125*^9}, {3.41562757925*^9, 
   3.415627594140625*^9}, {3.415627828109375*^9, 3.415627881078125*^9}, 
   3.415627931234375*^9, {3.415627965015625*^9, 3.415627970203125*^9}, 
   3.415628042359375*^9, {3.41595187809375*^9, 3.415951884796875*^9}, {
   3.415952184078125*^9, 3.415952187453125*^9}, 3.415952289203125*^9, {
   3.415952322453125*^9, 3.415952333015625*^9}, {3.41595238375*^9, 
   3.415952438390625*^9}, 3.415952916046875*^9, {3.41595299540625*^9, 
   3.415953010890625*^9}, {3.415953114734375*^9, 3.415953123703125*^9}, {
   3.41595347503125*^9, 3.415953480375*^9}, {3.4162766804692497`*^9, 
   3.416276703154739*^9}, {3.416297128635721*^9, 3.416297158514895*^9}, 
   3.416449371609375*^9, {3.41644940603125*^9, 3.41644940753125*^9}, {
   3.416449817515625*^9, 3.416449838375*^9}, {3.416450051625*^9, 
   3.416450115296875*^9}, 3.416662825375*^9, 3.4167213291821527`*^9, 
   3.416776301875*^9, {3.4181505917807503`*^9, 3.4181505926088753`*^9}, {
   3.4256326489375*^9, 3.42563267959375*^9}, {3.425632904875*^9, 
   3.425632920484375*^9}, 3.6700818266974*^9}],

Cell[TextData[StyleBox[" Gradient along Horizontal Coordinate",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4156883836875*^9, 3.4156883855625*^9}, {
  3.415688464859375*^9, 3.415688468734375*^9}, {3.416465228171875*^9, 
  3.41646523515625*^9}, {3.4168099431387177`*^9, 3.416809946810335*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dx", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yp", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xmax", "=", "35"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G0", "=", 
   RowBox[{"grad3d", "[", 
    RowBox[{"gQuad", ",", "dx", ",", "yp"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tby", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"grad3d", "[", 
           RowBox[{"gQuad", ",", 
            RowBox[{"x", "+", "dx"}], ",", "yp"}], "]"}], "-", "G0"}], ")"}], 
        "/", "G0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "xmax", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G0rec", "=", 
   RowBox[{"gradrec", "[", 
    RowBox[{"dx", ",", "yp", ",", "24", ",", "tf1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tbyrec", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gradrec", "[", 
            RowBox[{
             RowBox[{"x", "+", "dx"}], ",", "yp", ",", "24", ",", "tf1"}], 
            "]"}], "-", "G0rec"}], ")"}], "/", "G0rec"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "xmax", ",", "1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"Tby", ",", "Tbyrec"}], "}"}], ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Mid-Plane Rel. Gradient Variation \\n vs Horizontal Position [mm] \
\\n Computed Directly (line) \\n Reconstructed from Multipoles \
(dots)\>\""}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.402218920605603*^9, 3.402219231490347*^9}, {
   3.4022276594023647`*^9, 3.4022276713100557`*^9}, 3.4022289942724333`*^9, {
   3.402235496058301*^9, 3.402235628836782*^9}, {3.402235665934305*^9, 
   3.402235735563613*^9}, {3.402235980594108*^9, 3.402236096977695*^9}, {
   3.402236251547751*^9, 3.40223625865527*^9}, {3.402236390258813*^9, 
   3.402236390694332*^9}, 3.402236640282123*^9, {3.402629268447612*^9, 
   3.4026292811804667`*^9}, 3.402740096897725*^9, {3.40463111853823*^9, 
   3.404631119160001*^9}, 3.405171449131234*^9, {3.415623003078125*^9, 
   3.41562302540625*^9}, {3.4156230756875*^9, 3.415623156953125*^9}, {
   3.415623218046875*^9, 3.415623257984375*^9}, {3.415688658046875*^9, 
   3.41568868946875*^9}, {3.4156887199375*^9, 3.415688725671875*^9}, {
   3.4156889421875*^9, 3.415688987921875*^9}, {3.415697833015625*^9, 
   3.415697834890625*^9}, {3.41595308521875*^9, 3.415953086203125*^9}, {
   3.41595320340625*^9, 3.41595324596875*^9}, {3.41595333378125*^9, 
   3.415953334625*^9}, {3.415953383984375*^9, 3.41595339253125*^9}, {
   3.416297182444633*^9, 3.416297201826682*^9}, 3.4164494296875*^9, {
   3.416449853859375*^9, 3.416449863609375*^9}, {3.416449912203125*^9, 
   3.416449933421875*^9}, {3.416449989171875*^9, 3.41644999021875*^9}, {
   3.41645485296875*^9, 3.4164548755625*^9}, {3.416662831421875*^9, 
   3.416662836984375*^9}, {3.41666290921875*^9, 3.41666294503125*^9}, 
   3.416721583764789*^9, 3.416776452203125*^9, {3.4181506082963753`*^9, 
   3.4181506166088753`*^9}, {3.42563280675*^9, 3.425632830421875*^9}, {
   3.425632884*^9, 3.425632928171875*^9}, {3.670081975217826*^9, 
   3.6700819773272605`*^9}}],

Cell[TextData[StyleBox[" Gradient along the Quadrupole",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4156883836875*^9, 3.4156883855625*^9}, {
  3.415688464859375*^9, 3.415688468734375*^9}, {3.41646521415625*^9, 
  3.416465224609375*^9}, {3.4168099526600304`*^9, 3.416809954713647*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"locgrad3d", "[", 
     RowBox[{"g_", ",", "x_", ",", "y_", ",", "s_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "dx", "}"}], ",", 
      RowBox[{
       RowBox[{"dx", "=", "0.01"}], ";", "\[IndentingNewLine]", 
       RowBox[{"1000", "*", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"radFld", "[", 
            RowBox[{"g", ",", "\"\<by\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "+", 
                RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "s"}], "}"}]}], 
            "]"}], "-", 
           RowBox[{"radFld", "[", 
            RowBox[{"g", ",", "\"\<by\>\"", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"x", "-", 
                RowBox[{"dx", "/", "2"}]}], ",", "y", ",", "s"}], "}"}]}], 
            "]"}]}], ")"}], "/", "dx"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xp", "=", 
   RowBox[{"yp", "=", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", 
       RowBox[{"locgrad3d", "[", 
        RowBox[{"gQuad", ",", "xp", ",", "yp", ",", "s"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lmag"}], "/", "2"}], " ", "-", 
        RowBox[{"rint", "*", "4"}]}], ",", " ", 
       RowBox[{
        RowBox[{"lmag", "/", "2"}], " ", "+", 
        RowBox[{"rint", "*", "4"}]}], ",", 
       RowBox[{"rint", "/", "2"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Joined", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"True", ",", "False"}], "}"}]}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
   RowBox[{
   "PlotLabel", "\[Rule]", 
    "\"\<Mid-Plane Gradient [T/m] \\n vs Long. Position [mm] \>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.416464966625*^9, 3.41646520075*^9}, {
   3.416465608140625*^9, 3.416465633890625*^9}, {3.416465667640625*^9, 
   3.4164657110625*^9}, {3.416465785671875*^9, 3.416465793609375*^9}, {
   3.41646583415625*^9, 3.416466005515625*^9}, 3.416471484671875*^9, 
   3.41647510253125*^9, 3.416663323390625*^9, {3.41677645825*^9, 
   3.416776467453125*^9}, 3.4181492468120003`*^9, {3.4181506842807503`*^9, 
   3.4181506852495003`*^9}, {3.425632952796875*^9, 3.42563296671875*^9}, 
   3.42563325221875*^9}],

Cell[TextData[StyleBox[" Field and Magnetization Line Plots near the Pole \
Boundary",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}, {
  3.416034364624864*^9, 3.416034381305046*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lprof", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "rint"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"lmag", "/", "2"}], "-", "ch"}], ",", "rint"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lmag", "/", "2"}], ",", 
        RowBox[{"rint", "+", 
         RowBox[{"ch", "*", 
          RowBox[{"Tan", "[", 
           RowBox[{"ach", "*", 
            RowBox[{"Pi", "/", "180"}]}], "]"}]}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lmag", "/", "2"}], ",", "100."}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Filt", "[", 
    RowBox[{"a_", ",", 
     RowBox[{"thresh_:", 
      SuperscriptBox["10", 
       RowBox[{"-", "9"}]]}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", "a", "]"}], "\[GreaterEqual]", "thresh"}], ",", "a",
      ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gra3d", "[", 
     RowBox[{"gt_", ",", "field_", ",", "label_", ",", 
      RowBox[{"{", 
       RowBox[{"zmin_", ",", "zmax_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xmin_", ",", "xmax_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"polgra3d", "=", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"lprof", ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Mesh", "\[Rule]", "Full"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<+\>\"", ",", "25"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MeshStyle", "\[Rule]", "Red"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fieldgra3d", "=", 
        RowBox[{"VectorFieldPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Filt", "@@@", 
           RowBox[{"radFld", "[", 
            RowBox[{"gt", ",", 
             RowBox[{"StringJoin", "[", 
              RowBox[{
              "field", ",", "\"\<z\>\"", ",", "field", ",", "\"\<x\>\""}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"xt", ",", "0", ",", "zt"}], "}"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"zt", ",", "zmin", ",", "zmax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"xt", ",", "xmin", ",", "xmax"}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ColorFunction", "\[Rule]", 
           RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"DisplayFunction", "\[Rule]", "Identity"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{"fieldgra3d", ",", "polgra3d", ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"zmin", ",", "zmax"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"xmin", ",", "xmax"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", "label"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "rotating", " ", "the", " ", "solved", " ", "geometry", " ", "for", " ", 
    "visualization"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rtaux", "=", 
   RowBox[{"radTrfRot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", "Pi"}], "/", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gtaux", "=", 
   RowBox[{"radObjCnt", "[", 
    RowBox[{"{", "gQuad", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"radTrfOrnt", "[", 
    RowBox[{"gtaux", ",", "rtaux"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"gra3d", "[", 
  RowBox[{"gtaux", ",", "\"\<B\>\"", ",", "\"\<B Field Vector \>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.3", "*", "lmag"}], ",", 
     RowBox[{"0.7", "*", "lmag"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "80"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"gra3d", "[", 
  RowBox[{
  "gtaux", ",", "\"\<M\>\"", ",", "\"\<Magnetization Vector \>\"", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.3", "*", "lmag"}], ",", 
     RowBox[{"0.7", "*", "lmag"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "80"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.409617902734375*^9, 3.4096179108125*^9}, {
   3.409618527203125*^9, 3.409618535125*^9}, {3.409618709234375*^9, 
   3.40961870978125*^9}, {3.409618758671875*^9, 3.409618808421875*^9}, {
   3.409619898171875*^9, 3.40961990975*^9}, 3.409620531625*^9, {
   3.409620593515625*^9, 3.409620606375*^9}, {3.409620689125*^9, 
   3.409620690421875*^9}, {3.40962093678125*^9, 3.409620942359375*^9}, {
   3.40963166344817*^9, 3.4096316933225965`*^9}, {3.4159539506875*^9, 
   3.41595401025*^9}, {3.415954051765625*^9, 3.41595405846875*^9}, {
   3.415954091046875*^9, 3.4159541025625*^9}, {3.4159541836875*^9, 
   3.415954189609375*^9}, {3.415954268984375*^9, 3.415954271390625*^9}, {
   3.415954375921875*^9, 3.415954426078125*^9}, {3.4159545625*^9, 
   3.4159545735625*^9}, {3.415954697328125*^9, 3.415954736265625*^9}, {
   3.41595477984375*^9, 3.41595495*^9}, {3.415955138265625*^9, 
   3.415955142890625*^9}, {3.4159551763125*^9, 3.415955236578125*^9}, {
   3.4159553445625*^9, 3.41595534759375*^9}, {3.4159561069375*^9, 
   3.415956116265625*^9}, {3.415965280625*^9, 3.415965328890625*^9}, {
   3.41596536265625*^9, 3.415965374421875*^9}, {3.415965488609375*^9, 
   3.415965578453125*^9}, {3.4159656235625*^9, 3.415965625640625*^9}, {
   3.415965737828125*^9, 3.415965742578125*^9}, {3.41596579371875*^9, 
   3.415965827046875*^9}, {3.415965857828125*^9, 3.415965926875*^9}, {
   3.415966043953125*^9, 3.415966047359375*^9}, {3.415966085265625*^9, 
   3.415966216578125*^9}, {3.4159662820625*^9, 3.41596635015625*^9}, {
   3.415969791234375*^9, 3.415969809578125*^9}, {3.415974964890625*^9, 
   3.415974989796875*^9}, {3.41597519109375*^9, 3.41597520565625*^9}, 
   3.41597782275*^9, {3.41598187525*^9, 3.4159819051875*^9}, {
   3.415991040390625*^9, 3.4159910603125*^9}, {3.415991208578125*^9, 
   3.41599131046875*^9}, {3.415991356609375*^9, 3.415991388171875*^9}, {
   3.415994501921875*^9, 3.41599451625*^9}, 3.4159946551875*^9, 
   3.415994757765625*^9, {3.415994790859375*^9, 3.41599480865625*^9}, {
   3.41599484903125*^9, 3.41599492109375*^9}, {3.415995014609375*^9, 
   3.4159950193125*^9}, {3.415998174640625*^9, 3.4159982204375*^9}, {
   3.4159992124375*^9, 3.41599923071875*^9}, {3.4160336196875*^9, 
   3.41603362496875*^9}, {3.4160343323702817`*^9, 3.4160343390361247`*^9}, {
   3.416037777435915*^9, 3.4160378242005644`*^9}, {3.4160392715893707`*^9, 
   3.416039288591082*^9}, {3.4160393269931116`*^9, 3.4160393704176655`*^9}, {
   3.4160399343563423`*^9, 3.4160399453413105`*^9}, 3.4160470776555*^9, 
   3.4160472697805*^9, {3.416047610932521*^9, 3.416047638050473*^9}, 
   3.416047740997964*^9, {3.416297212770331*^9, 3.416297249006465*^9}, {
   3.4164501379375*^9, 3.4164501401875*^9}, 3.4166629745*^9, {
   3.4181507748120003`*^9, 3.4181507756401253`*^9}, {3.4328904988125*^9, 
   3.43289051096875*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Energy and Inductance in 3D", "Section",
 CellChangeTimes->{{3.409487135990822*^9, 3.4094871406157627`*^9}, {
   3.409617862359375*^9, 3.40961786471875*^9}, {3.409621625234375*^9, 
   3.4096216539375*^9}, {3.4096628880519266`*^9, 3.4096628912392025`*^9}, {
   3.40973952878125*^9, 3.409739534296875*^9}, {3.4155571718125*^9, 
   3.41555717309375*^9}, {3.415622245203125*^9, 3.4156222481875*^9}, {
   3.4160481274365544`*^9, 3.4160481284380584`*^9}, {3.416397309234375*^9, 
   3.416397312546875*^9}, 3.41647586296875*^9}],

Cell[TextData[StyleBox[" Auxiliary Functions",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
  3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
  3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
  3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
  3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}, {
  3.415557041421875*^9, 3.415557046265625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ff3d", "[", 
    RowBox[{"pre_", ",", "gdest_", ",", "gsrc_", ",", "cur_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"res", ",", "en", ",", "self", ",", "k"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"radFldCmpPrc", "[", 
       RowBox[{"PrcEnergy", "\[Rule]", "pre"}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"res", "=", 
       RowBox[{"AbsoluteTiming", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{"radFldEnr", "[", 
          RowBox[{"gdest", ",", "gsrc"}], "]"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"en", "=", 
       RowBox[{"0.5", "*", 
        RowBox[{"res", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"self", "=", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"10", "^", "3"}], ")"}], "*", 
        RowBox[{
         RowBox[{"Abs", "[", "en", "]"}], "/", 
         RowBox[{"cur", "^", "2"}]}]}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"to", " ", 
        RowBox[{"check", "!"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<Energy = \>\"", ",", "en", ",", "\"\< J,  Self-Inductance = \>\"",
         ",", "self", ",", "\"\< mH;  Computed in  \>\"", ",", 
        RowBox[{"res", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", "\"\< sec\>\""}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.40972599734375*^9, 3.4097261711875*^9}, {
   3.409730818765625*^9, 3.409730899171875*^9}, {3.4154532822966433`*^9, 
   3.415453287955696*^9}, {3.415453394869276*^9, 3.4154534060104427`*^9}, 
   3.415453477693273*^9, {3.4154535137726*^9, 3.415453607286008*^9}, {
   3.415453647639556*^9, 3.41545372402919*^9}, {3.4154537574199057`*^9, 
   3.415453845156973*^9}, {3.415453951660961*^9, 3.4154539660839376`*^9}, {
   3.415553913703125*^9, 3.415553991015625*^9}, {3.415554037390625*^9, 
   3.415554041234375*^9}, {3.415554242453125*^9, 3.415554272125*^9}, {
   3.41555430346875*^9, 3.415554312375*^9}, {3.415556756359375*^9, 
   3.4155567615625*^9}, {3.415556871953125*^9, 3.415556920796875*^9}, {
   3.4160479213145123`*^9, 3.416047929076168*^9}, {3.416048156135221*^9, 
   3.4160481641774607`*^9}, {3.4160484059131413`*^9, 3.416048421185589*^9}, {
   3.416048478167094*^9, 3.4160484789629135`*^9}, {3.416048529957766*^9, 
   3.416048561899768*^9}, {3.416048606683731*^9, 3.416048638754754*^9}, {
   3.416048690266574*^9, 3.416048736839551*^9}, {3.4160675080788937`*^9, 
   3.416067509237298*^9}, {3.416067690215003*^9, 3.416067694779869*^9}, 
   3.416081802807848*^9, {3.416081895563789*^9, 3.4160819241468363`*^9}, {
   3.4160820275275517`*^9, 3.416082037119136*^9}, 3.4160822644217987`*^9, {
   3.4160823052201242`*^9, 3.416082305654663*^9}, {3.416082416467531*^9, 
   3.41608242207603*^9}, {3.416082554099079*^9, 3.4160825796073313`*^9}, {
   3.416082624610857*^9, 3.416082661849791*^9}, 3.4160827042512703`*^9, {
   3.4160830563590927`*^9, 3.4160830905891027`*^9}, {3.41608337046812*^9, 
   3.416083378504002*^9}, {3.4164518850625*^9, 3.416451888515625*^9}, {
   3.416662998046875*^9, 3.416663025546875*^9}, {3.416663386875*^9, 
   3.41666338734375*^9}, 3.41677467771875*^9, {3.4168101060589523`*^9, 
   3.4168101066501446`*^9}, {3.4181508480151253`*^9, 
   3.4181508482026253`*^9}, {3.425633318734375*^9, 3.425633321671875*^9}, 
   3.42563336003125*^9}],

Cell[TextData[StyleBox[" Magnetic Energy and Self-Inductance ",
 FontSize->14]], "Subsubsection",
 CellChangeTimes->{{3.402195628934731*^9, 3.402195643084978*^9}, {
   3.4094862921734977`*^9, 3.4094862959234495`*^9}, {3.40953760315625*^9, 
   3.409537611234375*^9}, {3.415430493108507*^9, 3.4154305058540497`*^9}, {
   3.415431430318591*^9, 3.415431438333317*^9}, {3.415432865990533*^9, 
   3.415432913253779*^9}, {3.4154337426137857`*^9, 3.415433759620977*^9}, {
   3.415557041421875*^9, 3.415557078015625*^9}, {3.4160528698977966`*^9, 
   3.416052875082614*^9}, {3.416055414629145*^9, 3.4160554163074403`*^9}, 
   3.4160827554137497`*^9, {3.416083267773237*^9, 3.416083271221107*^9}, {
   3.41645173740625*^9, 3.416451742703125*^9}, {3.416663040640625*^9, 
   3.416663046640625*^9}, {3.41666349240625*^9, 3.41666351025*^9}, 
   3.41666568403125*^9, {3.4167746934375*^9, 3.416774697578125*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gdest", "=", "gAllCoils"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gsrc", "=", "gQuad"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ff3d", "[", 
  RowBox[{"10", ",", "gdest", ",", "gsrc", ",", "533.3"}], "]"}]}], "Input",
 CellChangeTimes->{{3.409730881859375*^9, 3.4097308838125*^9}, {
   3.416048754141231*^9, 3.4160487544715357`*^9}, 3.416082789954639*^9, {
   3.4164517886875*^9, 3.41645180734375*^9}, {3.416663089109375*^9, 
   3.416663093453125*^9}, {3.4181508555151253`*^9, 3.4181508685307503`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Gradient vs Current in 3D", "Section",
 CellChangeTimes->{{3.409486830275985*^9, 3.409486836650903*^9}, {
  3.4156222570625*^9, 3.4156222588125*^9}, {3.4181482793588753`*^9, 
  3.4181482802026253`*^9}}],

Cell["\<\
If you are ready to wait some ~30 minutes, depending on your CPU, run this \
section ...\
\>", "Text",
 CellChangeTimes->{{3.416396710375*^9, 3.41639675040625*^9}, {
  3.41640414046875*^9, 3.416404188609375*^9}, {3.4167145796783943`*^9, 
  3.416714588420917*^9}, {3.41677634653125*^9, 3.416776417984375*^9}, {
  3.4168098710978494`*^9, 3.416809882303401*^9}, {3.425633692703125*^9, 
  3.42563371825*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lmag", "=", "400"}], ";"}], "                        ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "actual", " ", "iron", " ", "length", " ", "of", " ", "the", " ", 
    "quadrupole"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nz", "=", " ", 
    RowBox[{"{", 
     RowBox[{"9", ",", "1"}], "}"}]}], ";"}], "                    ", 
  RowBox[{"(*", " ", 
   RowBox[{"longitudinal", " ", "segmentation"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ch", "=", "7"}], ";"}], "                                ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "size", " ", "in", " ", "mm"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ach", "=", "45"}], ";"}], "                           ", 
  RowBox[{"(*", " ", 
   RowBox[{"chamfer", " ", "angle", " ", "in", " ", "degrees"}], " ", "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imin", "=", "0.1"}], ";"}], "                       ", 
  RowBox[{"(*", " ", 
   RowBox[{"initial", " ", "current", " ", "in", " ", "Amperes"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"imax", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ni", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nt", "=", "15"}], ";"}], "                              ", 
  RowBox[{"(*", "  ", 
   RowBox[{"number", " ", "of", " ", "turns"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"istep", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"imax", "-", "imin"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"ni", "-", "1"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gQuad", ",", "gOneYokeAndCoil", ",", "gAllCoils"}], "}"}], "=", 
   RowBox[{"build3d", "[", 
    RowBox[{"nt", ",", "imin"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mtrx", "=", 
   RowBox[{"radRlxPre", "[", "gQuad", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"res", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"imin", "+", 
       RowBox[{"j", "*", "istep"}]}], ",", 
      RowBox[{
       RowBox[{"ScaleSolve", "[", 
        RowBox[{"gQuad", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"imin", "+", 
            RowBox[{"j", "*", "istep"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"imin", "+", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"j", "\[Equal]", "0"}], ",", "0", ",", 
               RowBox[{"(", 
                RowBox[{"j", "-", "1"}], ")"}]}], "]"}], "*", "istep"}]}], 
           ")"}]}], ",", "mtrx", ",", "grad3d"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", 
      RowBox[{"ni", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"radUtiDel", "[", "mtrx", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"res", ",", 
   RowBox[{
   "PlotLabel", "\[Rule]", " ", 
    "\"\<3D On-Axis Int. Gradient [T] vs Current [A]\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.4094832689446507`*^9, 3.409483276866424*^9}, 
   3.409483328272016*^9, {3.4094834634577856`*^9, 3.4094836030809984`*^9}, {
   3.4094836525178657`*^9, 3.4094836530647335`*^9}, {3.4094836868455515`*^9, 
   3.4094836935485907`*^9}, {3.409483852640304*^9, 3.409483853484043*^9}, {
   3.4094839758574767`*^9, 3.409484003044629*^9}, {3.4094850569549336`*^9, 
   3.4094850642985897`*^9}, {3.409536373609375*^9, 3.40953637415625*^9}, {
   3.409567599185582*^9, 3.4095676040915184`*^9}, {3.4096431307054663`*^9, 
   3.4096431312367125`*^9}, {3.415623504078125*^9, 3.415623504484375*^9}, {
   3.4163951464375*^9, 3.41639518803125*^9}, {3.41639527640625*^9, 
   3.416395282046875*^9}, {3.416395644359375*^9, 3.416395663078125*^9}, {
   3.416772681625*^9, 3.4167726955*^9}, 3.416775110625*^9, 
   3.416775234796875*^9, {3.41812837282879*^9, 3.4181283893499393`*^9}, 
   3.4181284728231115`*^9, {3.418128588083824*^9, 3.4181286062804093`*^9}, 
   3.4181448461870003`*^9, {3.4181448945151253`*^9, 3.4181449348120003`*^9}, {
   3.4181450747495003`*^9, 3.4181450777338753`*^9}, {3.4181451274213753`*^9, 
   3.4181451299682503`*^9}, 3.4181451742026253`*^9, {3.4181452262807503`*^9, 
   3.4181452454057503`*^9}, 3.4181460372651253`*^9, 3.4181460860151253`*^9, {
   3.4181462261557503`*^9, 3.4181462793120003`*^9}, {3.4181463217026253`*^9, 
   3.4181463293276253`*^9}, {3.4181463825307503`*^9, 3.4181463826245003`*^9}, 
   3.4181465207495003`*^9, {3.4181465638901253`*^9, 3.4181466098901253`*^9}, {
   3.4181466709838753`*^9, 3.4181466768276253`*^9}, 3.4181467390776253`*^9, {
   3.4181469087963753`*^9, 3.4181469210463753`*^9}, {3.4181472021557503`*^9, 
   3.4181472754526253`*^9}, {3.4181473134057503`*^9, 
   3.4181473176401253`*^9}, {3.4181474480620003`*^9, 
   3.4181474723432503`*^9}, {3.4181479046870003`*^9, 
   3.4181479253745003`*^9}, {3.4181479771245003`*^9, 3.4181479991401253`*^9}, 
   3.4181482843901253`*^9, 3.4181483160151253`*^9, {3.4181483490463753`*^9, 
   3.4181484049370003`*^9}, {3.4181553271713753`*^9, 
   3.4181553306245003`*^9}, {3.4185553229360647`*^9, 
   3.4185553357636967`*^9}, {3.418555501272966*^9, 3.4185555732077036`*^9}, {
   3.42563363940625*^9, 3.4256336488125*^9}, 3.42563372190625*^9, {
   3.42563529334375*^9, 3.42563532240625*^9}, {3.42563728090625*^9, 
   3.425637290484375*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Integrated Gradient and Multipole vs. Horizontal Position as a function of \
Segmentation, Chamfer dimension, Current,  ...\
\>", "Section",
 CellChangeTimes->{{3.409487135990822*^9, 3.4094871406157627`*^9}, {
   3.409617862359375*^9, 3.40961786471875*^9}, {3.409621625234375*^9, 
   3.4096216539375*^9}, {3.4096628880519266`*^9, 3.4096628912392025`*^9}, {
   3.40973952878125*^9, 3.409739534296875*^9}, {3.4155571718125*^9, 
   3.41555717309375*^9}, {3.415622245203125*^9, 3.4156222481875*^9}, {
   3.4160481274365544`*^9, 3.4160481284380584`*^9}, {3.416397309234375*^9, 
   3.416397312546875*^9}, 3.41647586296875*^9, {3.41691163590625*^9, 
   3.416911639203125*^9}, {3.416913445671875*^9, 3.41691348346875*^9}, {
   3.416913841640625*^9, 3.416913847296875*^9}, {3.41698108747425*^9, 
   3.41698111384925*^9}, {3.4170897670645*^9, 3.41708978778325*^9}, {
   3.425631112609375*^9, 3.42563111709375*^9}, 3.42566407371875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "This", " ", "part", " ", "is", " ", "given", " ", "as", " ", "a", " ", 
     "template", " ", "of", " ", "a", " ", "typical", " ", "computation", " ",
      "of", " ", "the", " ", "3", "D", " ", "field", " ", "in", " ", "which", 
     " ", "one", " ", "wants", " ", "to", " ", "study", " ", "the", " ", 
     "effect", " ", "of", " ", "chamfer"}], ",", " ", 
    RowBox[{"magnetic", " ", "length", " ", "of", " ", "yoke"}], ",", " ", 
    "current", ",", " ", "segmentation", ",", 
    RowBox[{
    "...", "\[IndentingNewLine]", "\[IndentingNewLine]", "the", " ", "value", 
     " ", "in", " ", "red", " ", "can", " ", "be", " ", "edited", " ", "to", 
     " ", "determine", " ", "a", " ", "list", " ", "of", " ", "paramter", " ",
      "to", " ", 
     RowBox[{"iterate", ".", " ", "For"}], " ", "Example", " ", "if", " ", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"nl", ",", 
        RowBox[{"{", "2", "}"}]}], "}"}],
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], "is", " ", "replaced", " ", "by", " ", 
     StyleBox[
      RowBox[{"{", 
       RowBox[{"nl", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3", ",", "5"}], "}"}]}], "}"}],
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox[" ",
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], "results", " ", "in", " ", "a", " ", 
     "sequence", " ", "of", " ", "computation", "  ", "where", " ", "the", 
     " ", "values", " ", "nl", " ", "will", " ", "take", " ", "successively", 
     " ", "the", " ", "values", " ", "2"}], ",", 
    RowBox[{
    "3", " ", "and", " ", "5.", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "It", " ", "seems", " ", "that", " ", "using", " ", "a", " ", "small", 
     " ", "vale", " ", "of", " ", "rl", " ", 
     RowBox[{"(", " ", 
      RowBox[{
      "0.1", " ", "for", " ", "a", " ", "400", " ", "mm", " ", "long", " ", 
       "quadrupole"}], ")"}], " ", "results", " ", "in", " ", "a", " ", 
     "faster", " ", "convergence", " ", "of", " ", "the", " ", "magetic", " ",
      "length", " ", "and", " ", "multipoles", " ", "vs", "  ", "nl", "  ", 
     "the", " ", "longitudinal", " ", "segmentation", " ", 
     RowBox[{"parameter", ".", " ", "This"}], " ", "is", " ", "not", " ", 
     "astonishing", " ", "as", " ", "it", " ", "corresponds", " ", "to", " ", 
     "narrower", " ", "slices", " ", "at", " ", "the", " ", "end", " ", "of", 
     " ", "the", " ", "yoke", " ", "where", " ", "most", " ", "3", "D", " ", 
     "effects", " ", "take", " ", 
     RowBox[{
     "place", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "The"}], " ",
      "cpu", " ", "time", " ", "and", " ", "memory", " ", "needed", " ", 
     "rouhgly", " ", "grows", " ", "like", "  ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"nl", " ", "X", " ", "ntri"}], ")"}], "^", "2"}], "   ", 
     "where", " ", "ntri", " ", "is", " ", "the", " ", "number", " ", "of", 
     " ", "triangles", "  ", "generated", " ", "in", " ", 
     RowBox[{"build3d", ".", " ", "\[IndentingNewLine]", "to"}], " ", 
     "obtain", " ", "a", " ", "good", " ", "absolute", " ", "precision"}], 
    " ", ",", " ", 
    RowBox[{
     RowBox[{
     "one", " ", "must", "  ", "increase", " ", "nl", " ", "at", " ", "the", 
      " ", "cost", " ", "of", " ", "more", " ", "CPU", " ", "time", " ", 
      "and", " ", "memory", " ", 
      RowBox[{"requirement", ".", "\[IndentingNewLine]", "A"}], " ", "value", 
      " ", "of", " ", "nl"}], "=", 
     RowBox[{
      RowBox[{
      "2", " ", "has", " ", "been", " ", "left", " ", "below", " ", "to", " ",
        "accelerate", " ", "the", " ", "computation", " ", "time", " ", "and",
        " ", "ease", " ", "testing", " ", "for", " ", "real", " ", "work", 
       " ", "where", " ", "absolute", " ", "precision", " ", "is", " ", 
       "targeted", "  ", "nl", "  ", "must", " ", "be", " ", 
       RowBox[{"increased", ".", " ", "A"}], " ", "value", " ", "of", " ", 
       "nl"}], "=", 
      RowBox[{
       RowBox[{
       "13", " ", "can", " ", "be", " ", "run", " ", "with", " ", "about", 
        " ", "1", "GByte", " ", "of", " ", "memory", " ", "available", " ", 
        "for", " ", "Mathematica", " ", "and", " ", 
        RowBox[{"Radia", ".", " ", "The"}], " ", "cpu", " ", "time", " ", 
        "will", " ", "depend", " ", "on", " ", "the", " ", "processor", " ", 
        "but", " ", "can", " ", "reach", " ", "a", " ", "few", " ", "to", " ",
         "a", " ", "few", " ", "tens", " ", "of", " ", 
        RowBox[{"minutes", ".", " ", "Much"}], " ", "higher", " ", "values", 
        " ", "will", " ", "need", " ", "much", " ", "more", " ", "memory", 
        " ", "as", " ", "well", " ", "as", " ", "the", " ", "64"}], "-", 
       RowBox[{"bit", " ", "version", " ", "of", " ", 
        RowBox[{"Radia", ".", " ", "\[IndentingNewLine]", "If"}], " ", "one", 
        " ", "is", " ", "running", " ", "out", " ", "of", " ", "memory", " ", 
        "before", " ", "reaching", " ", "an", " ", "acceptable", " ", 
        "absolute", " ", "precision"}]}]}]}], ",", " ", 
    RowBox[{
    "one", " ", "may", " ", "want", " ", "to", " ", "try", " ", "reducing", 
     " ", "the", " ", "number", " ", "of", " ", "triangles", " ", "in", " ", 
     RowBox[{"build3d", ".", " ", "The"}], " ", "parameter", " ", "nprof", 
     " ", "can", " ", "be", " ", "set", " ", "to", " ", "6", " ", "instead", 
     " ", "of", " ", "12", " ", "in", " ", 
     RowBox[{"yokeinput", "[", "]"}], " ", "still", " ", "giving", "  ", "a", 
     " ", "reasonable", "  ", "precision", " ", "in", " ", "2", "D"}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"xmax", "=", "35"}], ";"}], "                          ", 
   RowBox[{"(*", " ", 
    RowBox[{"maximum", " ", 
     RowBox[{"horiz", ".", " ", "position"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ns", "=", "15"}], ";"}], "                              ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "number", " ", "of", " ", "turns", " ", "in", " ", "the", " ", "coil"}], 
    " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\< ESRF Quadrupole : \>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\< Number of turns in Coil  [] : \>\"", ",", "ns"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\< Current [A] : \>\"", ",", "current"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\< Length [mm] : \>\"", ",", "lmag"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\< Chamfer Angle [deg] : \>\"", ",", "ach"}], "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"2", "D", " ", "Computation"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"onaxisgrad2d", "=", 
        RowBox[{
         RowBox[{"BuildSolve2d", "[", 
          RowBox[{"ns", ",", "current"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\< 2D Gradient [T/m] : \>\"", ",", "onaxisgrad2d"}], "]"}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
       RowBox[{"(*", " ", 
        RowBox[{"3", "D", " ", "Computation"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"tab", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"nz", " ", "=", 
            RowBox[{"{", 
             RowBox[{"nl", ",", "rl"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"time", ",", "Tby"}], "}"}], "=", 
            RowBox[{"AbsoluteTiming", "[", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"res", "=", 
                 RowBox[{"BuildSolve3d", "[", 
                  RowBox[{"ns", ",", "current"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"G0", "=", 
                 RowBox[{"grad3d", "[", 
                  RowBox[{"gQuad", ",", "0", ",", "0"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"overhang", "=", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"G0", "/", "onaxisgrad2d"}], "*", "1000"}], "-", 
                  "lmag"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<Chamfer [mm] : \>\"", ",", "ch", ",", 
                  "\"\<   Magnetic Length [mm] : \>\"", ",", 
                  RowBox[{
                   RowBox[{"G0", "/", "onaxisgrad2d"}], "*", "1000"}]}], 
                 "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"grad3d", "[", 
                    RowBox[{"gQuad", ",", "x", ",", "0"}], "]"}], "-", "G0"}],
                     ")"}], "/", "G0"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"x", ",", "0", ",", "xmax", ",", "1"}], "}"}]}], 
                 "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
               StyleBox[
                RowBox[{"{", 
                 RowBox[{"ch", ",", 
                  RowBox[{"{", "7", "}"}]}], "}"}],
                FontFamily->"Courier New",
                FontColor->RGBColor[1., 0., 0.]]}], 
              StyleBox["\[IndentingNewLine]",
               FontFamily->"Courier New",
               FontColor->RGBColor[1., 0., 0.]], "]"}], "]"}]}], ";", 
           StyleBox[
            RowBox[{"                                   ", 
             StyleBox["  ",
              FontFamily->"Courier New",
              FontColor->RGBColor[1., 0., 0.]]}]], 
           StyleBox[
            RowBox[{"(*", " ", 
             RowBox[{"chamfer", " ", "size", "  ", "in", " ", "mm"}], " ", 
             "*)"}],
            FontFamily->"Courier New",
            FontColor->RGBColor[1., 0., 0.]], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<CPU Time \>\"", ",", 
             RowBox[{"N", "[", 
              RowBox[{"time", "/", "60"}], "]"}], ",", "\"\< mn\>\""}], "]"}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"lp", "=", 
            RowBox[{"ListPlot", "[", 
             RowBox[{"Tby", ",", "\[IndentingNewLine]", 
              RowBox[{"Joined", "\[Rule]", "True"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotLabel", "\[Rule]", 
               RowBox[{"StringJoin", " ", "[", 
                RowBox[{"\"\<  Segmentation : \>\"", ",", 
                 RowBox[{"ToString", "[", "nz", "]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "0.003"}], ",", "0.003"}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                "Black", ",", "Blue", ",", "Orange", ",", "Red", ",", 
                 "Green"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", "lp", "]"}]}], "\[IndentingNewLine]", ",", 
          "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"{", 
            RowBox[{"rl", ",", 
             RowBox[{"{", "1", "}"}]}], "}"}],
           FontFamily->"Courier New",
           FontColor->RGBColor[1., 0., 0.]], 
          StyleBox[",",
           FontFamily->"Courier New",
           FontColor->RGBColor[1., 0., 0.]], 
          "                                                       ", 
          StyleBox[
           RowBox[{"(*", " ", 
            RowBox[{
            "ratio", " ", "of", " ", "extreme", " ", "sizes", " ", "in", " ", 
             "a", " ", "non", " ", "uniform", "  ", "segmentation"}], "  ", 
            "*)"}],
           FontFamily->"Courier New",
           FontColor->RGBColor[1., 0., 0.]], "\[IndentingNewLine]", 
          StyleBox[
           RowBox[{"{", 
            RowBox[{"nl", ",", 
             RowBox[{"{", "2", "}"}]}], "}"}],
           FontFamily->"Courier New",
           FontColor->RGBColor[1., 0., 0.]]}], 
         "                                                              ", 
         StyleBox[
          RowBox[{"(*", " ", 
           RowBox[{"longitudinal", " ", "segmentation"}], "  ", "*)"}],
          FontFamily->"Courier New",
          FontColor->RGBColor[1., 0., 0.]], "\[IndentingNewLine]", "]"}]}]}], 
      ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"current", ",", 
         RowBox[{"{", "533.3", "}"}]}], "}"}],
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], ",", 
      "                              ", 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{"current", " ", "in", " ", "Ampere"}], " ", "*)"}],
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"lmag", ",", 
         RowBox[{"{", "400", "}"}]}], "}"}],
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], 
      StyleBox[",",
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], 
      StyleBox[
       RowBox[{
        StyleBox["                                            ",
         FontFamily->"Courier New",
         FontColor->RGBColor[1., 0., 0.]], "  ", 
        StyleBox[" ",
         FontFamily->"Courier New",
         FontColor->RGBColor[1., 0., 0.]]}]], 
      StyleBox[
       RowBox[{"(*", " ", 
        RowBox[{
        "actual", " ", "iron", " ", "length", " ", "of", " ", "the", " ", 
         "quadrupole"}], " ", "*)"}],
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], 
      StyleBox["\[IndentingNewLine]",
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{"ach", ",", 
         RowBox[{"{", "45", "}"}]}], "}"}],
       FontFamily->"Courier New",
       FontColor->RGBColor[1., 0., 0.]]}], 
     StyleBox["                                                      ",
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], "  ", 
     StyleBox["  ",
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"chamfer", " ", "angle", " ", "in", " ", "degrees"}], " ", 
       "*)"}],
      FontFamily->"Courier New",
      FontColor->RGBColor[1., 0., 0.]], "\[IndentingNewLine]", "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.415621785125*^9, 3.41562179921875*^9}, {
   3.415623879328125*^9, 3.41562392865625*^9}, {3.415624533390625*^9, 
   3.415624541265625*^9}, {3.41562677046875*^9, 3.4156267805625*^9}, {
   3.415697699546875*^9, 3.415697703328125*^9}, {3.41644506628125*^9, 
   3.41644506671875*^9}, {3.416445294140625*^9, 3.416445355171875*^9}, {
   3.41644799271875*^9, 3.41644799728125*^9}, {3.41644819559375*^9, 
   3.416448314921875*^9}, {3.416448348984375*^9, 3.416448457984375*^9}, {
   3.416448554828125*^9, 3.4164486121875*^9}, {3.416448899109375*^9, 
   3.41644897121875*^9}, {3.416449036015625*^9, 3.41644907209375*^9}, {
   3.416449705359375*^9, 3.41644973275*^9}, 3.4164530334375*^9, {
   3.416456966171875*^9, 3.416457016828125*^9}, 3.41646538803125*^9, {
   3.416470954046875*^9, 3.41647096028125*^9}, 3.416471535984375*^9, {
   3.416475239046875*^9, 3.41647525621875*^9}, 3.416475300921875*^9, {
   3.416475398625*^9, 3.4164754323125*^9}, 3.4166627703125*^9, {
   3.416663148984375*^9, 3.4166631575*^9}, {3.416663670828125*^9, 
   3.416663671296875*^9}, 3.416721011574649*^9, 3.416721426707633*^9, {
   3.41677351340625*^9, 3.4167735183125*^9}, {3.41677664803125*^9, 
   3.4167767330625*^9}, {3.416809722086501*^9, 3.4168097477809877`*^9}, {
   3.4168097826050177`*^9, 3.4168098009739094`*^9}, {3.416810836666999*^9, 
   3.4168108446072607`*^9}, {3.41691173221875*^9, 3.416911754015625*^9}, {
   3.416912085078125*^9, 3.416912108765625*^9}, {3.41691214265625*^9, 
   3.41691238146875*^9}, {3.41691256625*^9, 3.41691259984375*^9}, {
   3.41691298346875*^9, 3.416912986453125*^9}, 3.416913049703125*^9, {
   3.4169131016875*^9, 3.416913170765625*^9}, {3.41691329228125*^9, 
   3.416913320390625*^9}, {3.4169134941875*^9, 3.41691359821875*^9}, {
   3.416913871015625*^9, 3.41691387653125*^9}, {3.416915821484375*^9, 
   3.41691583671875*^9}, {3.41691588959375*^9, 3.4169159748125*^9}, {
   3.416916546390625*^9, 3.41691655246875*^9}, {3.416916597546875*^9, 
   3.41691664971875*^9}, {3.416916689421875*^9, 3.41691683659375*^9}, 
   3.4169168681875*^9, {3.416916990078125*^9, 3.416917199703125*^9}, {
   3.41691732203125*^9, 3.416917331171875*^9}, {3.416977271333625*^9, 
   3.41697754097425*^9}, {3.416977580193*^9, 3.416977728239875*^9}, {
   3.416977843943*^9, 3.4169778778805*^9}, {3.41697811797425*^9, 
   3.41697811834925*^9}, {3.41697850822425*^9, 3.416978537927375*^9}, {
   3.416978594443*^9, 3.416978598396125*^9}, {3.4169786486305*^9, 
   3.4169787897555*^9}, {3.416978933521125*^9, 3.416979177068*^9}, {
   3.41697923272425*^9, 3.416979268427375*^9}, {3.416979328114875*^9, 
   3.416979343208625*^9}, {3.41697940347425*^9, 3.416979427458625*^9}, 
   3.4169794610055*^9, {3.416979612021125*^9, 3.4169797646305*^9}, {
   3.4169799057555*^9, 3.41698001541175*^9}, {3.416980091552375*^9, 
   3.416980093943*^9}, {3.416980214833625*^9, 3.416980336614875*^9}, 
   3.4169804051305*^9, {3.416980453458625*^9, 3.416980930489875*^9}, {
   3.416980987271125*^9, 3.41698106178675*^9}, {3.416981256552375*^9, 
   3.416981322364875*^9}, {3.41698576131275*^9, 3.41698579468775*^9}, 
   3.41698632806275*^9, {3.41698636406275*^9, 3.416986378094*^9}, {
   3.416988244734625*^9, 3.416988386719*^9}, {3.416988652344*^9, 
   3.4169886551565*^9}, {3.416988713047125*^9, 3.416988828515875*^9}, {
   3.4169895225315*^9, 3.416989913609625*^9}, {3.416990716390875*^9, 
   3.4169907351565*^9}, {3.41700847200025*^9, 3.41700847587525*^9}, {
   3.417008664859625*^9, 3.417008670265875*^9}, {3.417008703547125*^9, 
   3.417008705609625*^9}, {3.417008771328375*^9, 3.417008772094*^9}, {
   3.4170089375315*^9, 3.417008939594*^9}, {3.41701399943775*^9, 
   3.417014004484625*^9}, {3.417021766015875*^9, 3.417021788140875*^9}, {
   3.417022809844*^9, 3.417022817265875*^9}, 3.417051872703375*^9, {
   3.4170668716895*^9, 3.417066906298875*^9}, {3.41706984678325*^9, 
   3.417069977892625*^9}, {3.417070748127*^9, 3.417070753877*^9}, {
   3.417081084017625*^9, 3.417081247002*^9}, {3.417081362705125*^9, 
   3.41708143572075*^9}, {3.417081489111375*^9, 3.417081499127*^9}, {
   3.417081572127*^9, 3.417081573377*^9}, {3.417087814705125*^9, 
   3.417087860580125*^9}, {3.417088132423875*^9, 3.417088195142625*^9}, 
   3.417088410330125*^9, 3.417088450611375*^9, 3.41708861034575*^9, {
   3.41708878190825*^9, 3.417088786455125*^9}, {3.4170888350645*^9, 
   3.417089118892625*^9}, {3.41708916478325*^9, 3.41708961840825*^9}, {
   3.4170896581895*^9, 3.417089694142625*^9}, {3.41709015772075*^9, 
   3.417090233127*^9}, {3.417090425111375*^9, 3.417090482330125*^9}, {
   3.41709052884575*^9, 3.41709064040825*^9}, {3.417162284337181*^9, 
   3.417162319548006*^9}, {3.417174315157577*^9, 3.417174337338273*^9}, {
   3.417174376586192*^9, 3.417174438050713*^9}, {3.417174470080276*^9, 
   3.417174581555574*^9}, {3.41717464430443*^9, 3.4171746945974083`*^9}, {
   3.4181510364057503`*^9, 3.4181511187026253`*^9}, {3.4181511534838753`*^9, 
   3.4181513845776253`*^9}, {3.41855580557378*^9, 3.418555891773595*^9}, {
   3.418555989816705*^9, 3.4185559902229395`*^9}, {3.418556037158637*^9, 
   3.418556089609748*^9}, {3.42564104384375*^9, 3.42564105034375*^9}}]
}, Closed]]
}, Open  ]]
},
ScreenStyleEnvironment->"Working",
PrintingStyleEnvironment->"Working",
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{866, 963},
WindowMargins->{{209, Automatic}, {Automatic, 2}},
DockedCells->(FrontEndExecute[{
   FrontEnd`NotebookApply[
    FrontEnd`InputNotebook[], #, Placeholder]}]& ),
PrintingCopies->1,
PrintingPageRange->{1, Automatic},
PrivateNotebookOptions->{"ColorPalette"->{RGBColor, 128}},
ShowCellLabel->False,
ShowCellTags->False,
RenderingOptions->{"ObjectDithering"->True,
"RasterDithering"->False},
CharacterEncoding->"MacintoshAutomaticEncoding",
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->Notebook[{
   Cell[
    CellGroupData[{
      Cell["Style Definitions", "Subtitle"], 
      Cell[
      "\nModify the definitions below to change the default appearance of all \
cells in \na given style.  Make modifications to any definition using \
commands in the \nFormat menu.\n", "Text"], 
      Cell[
       CellGroupData[{
         Cell["Style Environment Names", "Section"], 
         Cell[
          StyleData[All, "Working"], PageWidth -> WindowWidth, ScriptMinSize -> 
          9], 
         Cell[
          StyleData[All, "Presentation"], PageWidth -> WindowWidth, 
          ScriptMinSize -> 12, FontSize -> 16], 
         Cell[
          StyleData[All, "Condensed"], PageWidth -> WindowWidth, 
          CellBracketOptions -> {"Margins" -> {1, 1}, "Widths" -> {0, 5}}, 
          ScriptMinSize -> 8, FontSize -> 11], 
         Cell[
          StyleData[All, "Printout"], PageWidth -> PaperWidth, ScriptMinSize -> 
          7, FontSize -> 10, 
          PrivateFontOptions -> {"FontType" -> "Outline"}]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Notebook Options", "Section"], 
         Cell[
         "\nThe options defined for the style below will be used at the \
Notebook level.\n", "Text"], 
         Cell[
          StyleData["Notebook"], PageHeaders -> {{
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"], None, 
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"]}, {
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"], None, 
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"]}}, 
          PageHeaderLines -> {True, True}, 
          PrintingOptions -> {
           "FacingPages" -> True, "FirstPageHeader" -> False}, 
          CellFrameLabelMargins -> 6, StyleMenuListing -> None]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headings", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Title"], ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {0, 0}}, PageBreakBelow -> False, 
             LineSpacing -> {1, 0}, CounterIncrements -> "Title", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}, {"Subtitle", 0}, {"Subsubtitle", 0}}, FontSize -> 
             34, FontColor -> GrayLevel[1], Background -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Title", "Presentation"], 
             CellMargins -> {{0, 0}, {0, 0}}, LineSpacing -> {1, 0}, FontSize -> 
             44], 
            Cell[
             StyleData["Title", "Condensed"], CellMargins -> {{0, 0}, {0, 0}},
              FontSize -> 20], 
            Cell[
             StyleData["Title", "Printout"], CellMargins -> {{0, 0}, {0, 0}}, 
             FontSize -> 24, FontTracking -> "Plain", Background -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subtitle"], ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {0, 0}}, PageBreakBelow -> False, 
             LineSpacing -> {1, 3}, ParagraphIndent -> -96, CounterIncrements -> 
             "Subtitle", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}, {"Subsubtitle", 0}}, FontFamily -> "Helvetica", 
             FontSize -> 18, FontColor -> GrayLevel[1], Background -> 
             RGBColor[0.2, 0.700008, 0.700008]], 
            Cell[
             StyleData["Subtitle", "Presentation"], 
             CellMargins -> {{0, 0}, {0, 0}}, LineSpacing -> {1, 6}, 
             ParagraphIndent -> -157, FontSize -> 30], 
            Cell[
             StyleData["Subtitle", "Condensed"], 
             CellMargins -> {{0, 0}, {0, 0}}, ParagraphIndent -> -78, 
             FontSize -> 14], 
            Cell[
             StyleData["Subtitle", "Printout"], 
             CellMargins -> {{0, 0}, {0, 0}}, ParagraphIndent -> -85, 
             FontSize -> 16, Background -> GrayLevel[0.6]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubtitle"], ShowCellBracket -> False, 
             CellMargins -> {{10, 4}, {30, 10}}, PageBreakBelow -> False, 
             CounterIncrements -> "Subsubtitle", 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 14, 
             FontSlant -> "Italic"], 
            Cell[
             StyleData["Subsubtitle", "Presentation"], 
             CellMargins -> {{8, 10}, {40, 20}}, LineSpacing -> {1, 0}, 
             FontSize -> 24], 
            Cell[
             StyleData["Subsubtitle", "Condensed"], 
             CellMargins -> {{8, 10}, {12, 8}}, FontSize -> 12], 
            Cell[
             StyleData["Subsubtitle", "Printout"], 
             CellMargins -> {{9, 10}, {50, 10}}, FontSize -> 14]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Section"], CellFrame -> {{6, 0}, {0, 1}}, CellDingbat -> 
             None, CellMargins -> {{12, Inherited}, {4, 24}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, PageBreakBelow -> 
             False, CellFrameMargins -> 6, CounterIncrements -> "Section", 
             CounterAssignments -> {{"Subsection", 0}, {"Subsubsection", 0}}, 
             FontFamily -> "Helvetica", FontSize -> 16, FontWeight -> "Bold", 
             FontColor -> RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Section", "Presentation"], 
             CellMargins -> {{10, 10}, {8, 32}}, LineSpacing -> {1, 2}, 
             FontSize -> 24, FontTracking -> "Condensed"], 
            Cell[
             StyleData["Section", "Condensed"], 
             CellMargins -> {{8, Inherited}, {2, 12}}, FontSize -> 12], 
            Cell[
             StyleData["Section", "Printout"], 
             CellMargins -> {{9, 0}, {2, 50}}, FontSize -> 14, FontTracking -> 
             "Plain", FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsection"], 
             CellMargins -> {{12, Inherited}, {8, 20}}, 
             CellGroupingRules -> {"SectionGrouping", 40}, PageBreakBelow -> 
             False, CounterIncrements -> "Subsection", 
             CounterAssignments -> {{"Subsubsection", 0}}, FontFamily -> 
             "Helvetica", FontSize -> 13, FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsection", "Presentation"], 
             CellMargins -> {{11, 10}, {8, 32}}, LineSpacing -> {1, 0}, 
             FontSize -> 22], 
            Cell[
             StyleData["Subsection", "Condensed"], 
             CellMargins -> {{8, Inherited}, {2, 12}}, FontSize -> 12], 
            Cell[
             StyleData["Subsection", "Printout"], 
             CellMargins -> {{9, 0}, {4, 40}}, FontSize -> 12]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubsection"], CellDingbat -> "\[FilledSquare]", 
             CellMargins -> {{25, Inherited}, {8, 12}}, 
             CellGroupingRules -> {"SectionGrouping", 50}, PageBreakBelow -> 
             False, CounterIncrements -> "Subsubsection", FontFamily -> 
             "Times", FontSize -> 13, FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsubsection", "Presentation"], 
             CellMargins -> {{29, 10}, {8, 26}}, LineSpacing -> {1, 0}, 
             FontSize -> 18], 
            Cell[
             StyleData["Subsubsection", "Condensed"], 
             CellMargins -> {{22, Inherited}, {2, 12}}, FontSize -> 10], 
            Cell[
             StyleData["Subsubsection", "Printout"], 
             CellMargins -> {{21, 0}, {4, 20}}, FontSize -> 11]}, Closed]]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Body Text", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Text"], CellMargins -> {{12, 10}, {5, 5}}, 
             LineSpacing -> {1, 3}, ParagraphSpacing -> {0, 12}, 
             CounterIncrements -> "Text", FontFamily -> "Times"], 
            Cell[
             StyleData["Text", "Presentation"], 
             CellMargins -> {{13, 10}, {8, 8}}, LineSpacing -> {1, 5}, 
             ParagraphSpacing -> {0, 12}], 
            Cell[
             StyleData["Text", "Condensed"], CellMargins -> {{8, 10}, {4, 4}},
              LineSpacing -> {1, 1}, ParagraphSpacing -> {0, 4}], 
            Cell[
             StyleData["Text", "Printout"], CellMargins -> {{9, 0}, {4, 4}}, 
             ParagraphSpacing -> {0, 6}]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["SmallText"], CellMargins -> {{12, 10}, {5, 5}}, 
             LineSpacing -> {1, 3}, ParagraphSpacing -> {0, 6}, 
             CounterIncrements -> "SmallText", FontFamily -> "Helvetica", 
             FontSize -> 9], 
            Cell[
             StyleData["SmallText", "Presentation"], 
             CellMargins -> {{13, 10}, {8, 8}}, LineSpacing -> {1, 5}, 
             FontSize -> 12], 
            Cell[
             StyleData["SmallText", "Condensed"], 
             CellMargins -> {{8, 10}, {2, 2}}, LineSpacing -> {1, 2}, 
             FontSize -> 9], 
            Cell[
             StyleData["SmallText", "Printout"], 
             CellMargins -> {{9, 0}, {4, 4}}, FontSize -> 7]}, Closed]]}, 
        Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Input/Output", "Section"], 
         Cell[
         "\nThe cells in this section define styles used for input and output \
to the \nkernel.  Be careful when modifying, renaming, or removing these \
styles, \nbecause the front end associates special meanings with these style \
names.\n", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Input"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{52, 10}, {8, 8}}, Evaluatable -> True, 
             CellGroupingRules -> "InputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             CellLabelMargins -> {{5, Inherited}, {Inherited, Inherited}}, 
             DefaultFormatType -> DefaultInputFormatType, FormatType -> 
             InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
             CounterIncrements -> "Input", FontWeight -> "Bold", Background -> 
             RGBColor[1, 0.8, 0.4]], 
            Cell[
             StyleData["Input", "Presentation"], 
             CellMargins -> {{62, Inherited}, {10, 10}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Input", "Condensed"], 
             CellMargins -> {{40, 10}, {4, 4}}], 
            Cell[
             StyleData["Input", "Printout"], CellMargins -> {{44, 0}, {6, 6}},
              Background -> GrayLevel[0.8]]}, Closed]], 
         Cell[
          StyleData["InlineInput"], Evaluatable -> True, CellGroupingRules -> 
          "InputGrouping", CellHorizontalScrolling -> True, PageBreakWithin -> 
          False, GroupPageBreakWithin -> False, DefaultFormatType -> 
          DefaultInputFormatType, AutoItalicWords -> {}, FormatType -> 
          InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
          CounterIncrements -> "Input", FontWeight -> "Bold"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Output"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{52, 10}, {8, 8}}, CellEditDuplicate -> True, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, 
             CellLabelMargins -> {{3, Inherited}, {Inherited, Inherited}}, 
             DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, CounterIncrements -> "Output", Background -> 
             RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["Output", "Presentation"], 
             CellMargins -> {{62, Inherited}, {12, 5}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Output", "Condensed"], 
             CellMargins -> {{40, Inherited}, {4, 1}}], 
            Cell[
             StyleData["Output", "Printout"], 
             CellMargins -> {{44, 0}, {6, 2}}, Background -> 
             GrayLevel[0.900008]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Message"], 
             CellMargins -> {{62, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, CounterIncrements -> "Message", StyleMenuListing -> 
             None, FontColor -> RGBColor[1, 0, 0]], 
            Cell[
             StyleData["Message", "Presentation"], 
             CellMargins -> {{74, Inherited}, {Inherited, Inherited}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Message", "Condensed"], 
             CellMargins -> {{50, Inherited}, {Inherited, Inherited}}], 
            Cell[
             StyleData["Message", "Printout"], 
             CellMargins -> {{54, Inherited}, {Inherited, Inherited}}, 
             FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Print"], 
             CellMargins -> {{62, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, ShowCellLabel -> 
             False, DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, CounterIncrements -> "Print", StyleMenuListing -> 
             None], 
            Cell[
             StyleData["Print", "Presentation"], 
             CellMargins -> {{74, Inherited}, {Inherited, Inherited}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Print", "Condensed"], 
             CellMargins -> {{50, Inherited}, {Inherited, Inherited}}], 
            Cell[
             StyleData["Print", "Printout"], 
             CellMargins -> {{54, Inherited}, {Inherited, Inherited}}]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Graphics"], 
             CellMargins -> {{62, Inherited}, {Inherited, Inherited}}, 
             CellGroupingRules -> "GraphicsGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, CounterIncrements -> "Graphics", StyleMenuListing -> 
             None], 
            Cell[
             StyleData["Graphics", "Presentation"], 
             CellMargins -> {{74, Inherited}, {Inherited, Inherited}}], 
            Cell[
             StyleData["Graphics", "Condensed"], 
             CellMargins -> {{52, Inherited}, {Inherited, Inherited}}, 
             ImageSize -> {175, 175}], 
            Cell[
             StyleData["Graphics", "Printout"], 
             CellMargins -> {{54, Inherited}, {Inherited, Inherited}}, 
             ImageSize -> {250, 250}]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["CellLabel"], StyleMenuListing -> None, FontFamily -> 
             "Helvetica", FontSize -> 11, FontWeight -> "Bold", FontColor -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["CellLabel", "Presentation"], FontSize -> 12], 
            Cell[
             StyleData["CellLabel", "Condensed"], FontSize -> 8], 
            Cell[
             StyleData["CellLabel", "Printout"], FontSize -> 8, FontColor -> 
             GrayLevel[0]]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Unique Styles", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Author"], ShowCellBracket -> False, 
             CellMargins -> {{10, 4}, {2, 10}}, FontSize -> 16, FontSlant -> 
             "Italic"], 
            Cell[
             StyleData["Author", "Presentation"], 
             CellMargins -> {{12, 10}, {2, 12}}, LineSpacing -> {1, 5}, 
             ParagraphSpacing -> {0, 12}, FontSize -> 20], 
            Cell[
             StyleData["Author", "Condensed"], 
             CellMargins -> {{8, 10}, {1, 4}}, LineSpacing -> {1, 1}, 
             ParagraphSpacing -> {0, 4}, FontSize -> 12], 
            Cell[
             StyleData["Author", "Printout"], 
             CellMargins -> {{9, 0}, {4, 12}}, ParagraphSpacing -> {0, 6}, 
             FontSize -> 14]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Copyright"], ShowCellBracket -> False, 
             CellMargins -> {{10, 10}, {40, 2}}, FontFamily -> "Helvetica", 
             FontSize -> 9], 
            Cell[
             StyleData["Copyright", "Presentation"], 
             CellMargins -> {{12, 10}, {50, 2}}, LineSpacing -> {1, 5}, 
             FontSize -> 12], 
            Cell[
             StyleData["Copyright", "Condensed"], 
             CellMargins -> {{8, 10}, {12, 1}}, LineSpacing -> {1, 2}, 
             FontSize -> 9], 
            Cell[
             StyleData["Copyright", "Printout"], 
             CellMargins -> {{9, 0}, {72, 4}}, FontSize -> 7]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Example"], CellMargins -> {{12, 10}, {5, 12}}, 
             LineSpacing -> {1, 3}, ParagraphSpacing -> {0, 12}, 
             CounterIncrements -> "Example", FontFamily -> "Times", 
             FontWeight -> "Bold"], 
            Cell[
             StyleData["Example", "Presentation"], 
             CellMargins -> {{18, 10}, {8, 20}}, LineSpacing -> {1, 5}, 
             ParagraphSpacing -> {0, 12}], 
            Cell[
             StyleData["Example", "Condensed"], 
             CellMargins -> {{8, 10}, {4, 8}}, LineSpacing -> {1, 1}, 
             ParagraphSpacing -> {0, 4}], 
            Cell[
             StyleData["Example", "Printout"], 
             CellMargins -> {{9, 0}, {4, 10}}, ParagraphSpacing -> {0, 6}]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Definition"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{52, 10}, {8, 8}}, PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             ShowStringCharacters -> True, CounterIncrements -> "Definition", 
             FontFamily -> "Helvetica", FontWeight -> "Bold", FontColor -> 
             GrayLevel[1], Background -> RGBColor[0.2, 0.700008, 0.700008]], 
            Cell[
             StyleData["Definition", "Presentation"], 
             CellMargins -> {{62, Inherited}, {5, 12}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Definition", "Condensed"], 
             CellMargins -> {{40, 10}, {1, 4}}], 
            Cell[
             StyleData["Definition", "Printout"], 
             CellMargins -> {{44, 0}, {2, 6}}, Background -> GrayLevel[0.6]]},
            Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Theorem"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{52, 10}, {8, 8}}, PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             ShowStringCharacters -> True, CounterIncrements -> "Theorem", 
             FontFamily -> "Helvetica", FontWeight -> "Bold", FontColor -> 
             GrayLevel[1], Background -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Theorem", "Presentation"], 
             CellMargins -> {{62, Inherited}, {5, 12}}, 
             LineSpacing -> {1, 0}], 
            Cell[
             StyleData["Theorem", "Condensed"], 
             CellMargins -> {{40, 10}, {1, 4}}], 
            Cell[
             StyleData["Theorem", "Printout"], 
             CellMargins -> {{44, 0}, {2, 6}}, Background -> GrayLevel[0.4]]},
            Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["ExerciseMain"], CellFrame -> {{6, 0}, {0, 1}}, 
             CellMargins -> {{12, Inherited}, {4, 20}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, PageBreakBelow -> 
             False, CellFrameColor -> RGBColor[0.571389, 0.19675, 0.570504], 
             CounterIncrements -> "Subsection", 
             CounterAssignments -> {{"Subsubsection", 0}}, FontFamily -> 
             "Helvetica", FontSize -> 16, FontWeight -> "Bold", FontColor -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["ExerciseMain", "Presentation"], 
             CellMargins -> {{18, 10}, {8, 32}}, LineSpacing -> {1, 2}, 
             FontSize -> 24, FontTracking -> "Condensed"], 
            Cell[
             StyleData["ExerciseMain", "Condensed"], 
             CellMargins -> {{8, Inherited}, {2, 12}}, FontSize -> 12], 
            Cell[
             StyleData["ExerciseMain", "Printout"], 
             CellMargins -> {{9, 0}, {2, 50}}, CellFrameColor -> 
             GrayLevel[0.500008], FontSize -> 14, FontTracking -> "Plain", 
             FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Exercise"], CellDingbat -> "\[FilledDownTriangle]", 
             CellMargins -> {{23, Inherited}, {4, 18}}, 
             CellGroupingRules -> {"SectionGrouping", 50}, PageBreakBelow -> 
             False, CounterIncrements -> "Subsubsection", FontFamily -> 
             "Times", FontSize -> 13, FontWeight -> "Bold", FontColor -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Exercise", "Presentation"], 
             CellMargins -> {{33, 10}, {8, 26}}, LineSpacing -> {1, 0}, 
             FontSize -> 18], 
            Cell[
             StyleData["Exercise", "Condensed"], 
             CellMargins -> {{17, Inherited}, {2, 12}}, FontSize -> 10], 
            Cell[
             StyleData["Exercise", "Printout"], 
             CellFrame -> {{0, 0}, {0.5, 0}}, CellDingbat -> None, 
             CellMargins -> {{9, 0}, {6, 20}}, FontSize -> 11, FontColor -> 
             GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["ExerciseText"], CellMargins -> {{62, 10}, {5, 5}}, 
             LineSpacing -> {1, 3}, ParagraphSpacing -> {0, 8}, 
             CounterIncrements -> "ExcersiceText", FontFamily -> "Times"], 
            Cell[
             StyleData["ExerciseText", "Presentation"], 
             CellMargins -> {{74, 10}, {8, 8}}, LineSpacing -> {1, 5}, 
             ParagraphSpacing -> {0, 12}], 
            Cell[
             StyleData["ExerciseText", "Condensed"], 
             CellMargins -> {{52, 10}, {2, 2}}, LineSpacing -> {1, 1}, 
             ParagraphSpacing -> {0, 4}], 
            Cell[
             StyleData["ExerciseText", "Printout"], 
             CellMargins -> {{54, 0}, {4, 4}}, ParagraphSpacing -> {0, 6}]}, 
           Closed]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Formulas and Programming", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["DisplayFormula"], CellMargins -> {{62, 10}, {2, 10}}, 
             CellHorizontalScrolling -> True, ScriptLevel -> 0, 
             SingleLetterItalics -> True, 
             UnderoverscriptBoxOptions -> {LimitsPositioning -> True}], 
            Cell[
             StyleData["DisplayFormula", "Presentation"], 
             CellMargins -> {{74, 10}, {2, 10}}, FontSize -> 10], 
            Cell[
             StyleData["DisplayFormula", "Condensed"], 
             CellMargins -> {{52, 10}, {2, 10}}, FontSize -> 10], 
            Cell[
             StyleData["DisplayFormula", "Printout"], 
             CellMargins -> {{54, 10}, {2, 10}}, FontSize -> 10]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["ChemicalFormula"], CellMargins -> {{62, 10}, {2, 10}},
              AutoSpacing -> False, ScriptBaselineShifts -> {0.6, Automatic}, 
             ScriptLevel -> 1, SingleLetterItalics -> False, ZeroWidthTimes -> 
             True], 
            Cell[
             StyleData["ChemicalFormula", "Presentation"], 
             CellMargins -> {{74, 10}, {2, 10}}, FontSize -> 10], 
            Cell[
             StyleData["ChemicalFormula", "Condensed"], 
             CellMargins -> {{52, 10}, {2, 10}}, FontSize -> 10], 
            Cell[
             StyleData["ChemicalFormula", "Printout"], 
             CellMargins -> {{54, 10}, {2, 10}}, FontSize -> 10]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Program"], CellMargins -> {{12, 10}, {Inherited, 6}}, 
             FontFamily -> "Courier"], 
            Cell[
             StyleData["Program", "Presentation"], 
             CellMargins -> {{13, 30}, {Inherited, 4}}, FontSize -> 9.5], 
            Cell[
             StyleData["Program", "Condensed"], 
             CellMargins -> {{8, 10}, {Inherited, 4}}, FontSize -> 9.5], 
            Cell[
             StyleData["Program", "Printout"], 
             CellMargins -> {{9, 0}, {Inherited, 4}}, FontSize -> 9.5]}, 
           Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Automatic Numbering", "Section"], 
         Cell[
         "\nThe following styles are useful for numbered equations, figures, \
etc.  They \nautomatically give the cell a FrameLabel containing a reference \
to a \nparticular counter, and also increment that counter.\n", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["NumberedEquation"], 
             CellMargins -> {{62, 10}, {Inherited, Inherited}}, 
             CellFrameLabels -> {{None, 
                Cell[
                 TextData[{"(", 
                   CounterBox["NumberedEquation"], ")"}]]}, {None, None}}, 
             DefaultFormatType -> DefaultInputFormatType, CounterIncrements -> 
             "NumberedEquation", FormatTypeAutoConvert -> False], 
            Cell[
             StyleData["NumberedEquation", "Presentation"], 
             CellMargins -> {{74, 10}, {Inherited, Inherited}}], 
            Cell[
             StyleData["NumberedEquation", "Condensed"], 
             CellMargins -> {{52, 10}, {Inherited, Inherited}}], 
            Cell[
             StyleData["NumberedEquation", "Printout"], 
             CellMargins -> {{54, 0}, {Inherited, Inherited}}]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["NumberedFigure"], 
             CellMargins -> {{62, 145}, {Inherited, Inherited}}, 
             CellFrameLabels -> {{None, None}, {
                Cell[
                 TextData[{"Figure ", 
                   CounterBox["NumberedFigure"]}]], None}}, CounterIncrements -> 
             "NumberedFigure", 
             ImageMargins -> {{43, Inherited}, {Inherited, 0}}, 
             FormatTypeAutoConvert -> False], 
            Cell[
             StyleData["NumberedFigure", "Presentation"]], 
            Cell[
             StyleData["NumberedFigure", "Condensed"]], 
            Cell[
             StyleData["NumberedFigure", "Printout"]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["NumberedTable"], 
             CellMargins -> {{62, 145}, {Inherited, Inherited}}, 
             CellFrameLabels -> {{None, None}, {
                Cell[
                 TextData[{"Table ", 
                   CounterBox["NumberedTable"]}]], None}}, TextAlignment -> 
             Center, CounterIncrements -> "NumberedTable", 
             FormatTypeAutoConvert -> False], 
            Cell[
             StyleData["NumberedTable", "Presentation"]], 
            Cell[
             StyleData["NumberedTable", "Condensed"]], 
            Cell[
             StyleData["NumberedTable", "Printout"]]}, Closed]]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headers and Footers", "Section"], 
         Cell[
          StyleData["Header"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontSlant -> "Italic"], 
         Cell[
          StyleData["Footer"], CellMargins -> {{0, 0}, {0, 4}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 6], 
         Cell[
          StyleData["PageNumber"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontWeight -> "Bold"]}, Closed]], 
      Cell[
       CellGroupData[{
         Cell["Hyperlink Styles", "Section"], 
         Cell[
         "\nThe cells below define styles useful for making hypertext \
ButtonBoxes.  The \n\"Hyperlink\" style is for links within the same \
Notebook, or between \nNotebooks.\n", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Hyperlink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontColor -> GrayLevel[1], 
             Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`NotebookLocate[#2]}]& ), ButtonNote -> 
               ButtonData}], 
            Cell[
             StyleData["Hyperlink", "Presentation"]], 
            Cell[
             StyleData["Hyperlink", "Condensed"]], 
            Cell[
             StyleData["Hyperlink", "Printout"], FontColor -> GrayLevel[0], 
             Background -> GrayLevel[1]]}, Closed]], 
         Cell[
         "\nThe following styles are for linking automatically to the on-line \
help \nsystem.\n", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["MainBookLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontColor -> GrayLevel[1], 
             Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["MainBook", #]}]& )}], 
            Cell[
             StyleData["MainBookLink", "Presentation"]], 
            Cell[
             StyleData["MainBookLink", "Condensed"]], 
            Cell[
             StyleData["MainBookLink", "Printout"], FontColor -> GrayLevel[0],
              Background -> GrayLevel[1]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["AddOnsLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontFamily -> "Courier", 
             FontColor -> GrayLevel[1], Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["AddOns", #]}]& )}], 
            Cell[
             StyleData["AddOnsLink", "Presentation"]], 
            Cell[
             StyleData["AddOnsLink", "Condensed"]], 
            Cell[
             StyleData["AddOnLink", "Printout"], FontColor -> GrayLevel[0], 
             Background -> GrayLevel[1]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["RefGuideLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontFamily -> "Courier", 
             FontColor -> GrayLevel[1], Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["RefGuideLink", #]}]& )}], 
            Cell[
             StyleData["RefGuideLink", "Presentation"]], 
            Cell[
             StyleData["RefGuideLink", "Condensed"]], 
            Cell[
             StyleData["RefGuideLink", "Printout"], FontColor -> GrayLevel[0],
              Background -> GrayLevel[1]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["GettingStartedLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontColor -> GrayLevel[1], 
             Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["GettingStarted", #]}]& )}], 
            Cell[
             StyleData["GettingStartedLink", "Presentation"]], 
            Cell[
             StyleData["GettingStartedLink", "Condensed"]], 
            Cell[
             StyleData["GettingStartedLink", "Printout"], FontColor -> 
             GrayLevel[0], Background -> GrayLevel[1]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["OtherInformationLink"], StyleMenuListing -> None, 
             ButtonStyleMenuListing -> Automatic, FontColor -> GrayLevel[1], 
             Background -> RGBColor[1, 0.4, 0], 
             ButtonBoxOptions -> {
              Active -> True, Appearance -> {Automatic, None}, 
               ButtonFunction :> (FrontEndExecute[{
                  FrontEnd`HelpBrowserLookup["OtherInformation", #]}]& )}], 
            Cell[
             StyleData["OtherInformationLink", "Presentation"]], 
            Cell[
             StyleData["OtherInformationLink", "Condensed"]], 
            Cell[
             StyleData["OtherInformationLink", "Printout"], FontColor -> 
             GrayLevel[0], Background -> GrayLevel[1]]}, Closed]]}, Closed]]},
      Open]]}, Visible -> False, FrontEndVersion -> 
  "9.0 for Microsoft Windows (64-bit) (January 25, 2013)", StyleDefinitions -> 
  "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 639, 9, 43, "Title"],
Cell[1209, 33, 2521, 37, 205, "Text"],
Cell[3733, 72, 444, 6, 37, "Subtitle"],
Cell[CellGroupData[{
Cell[4202, 82, 96, 1, 54, "Section"],
Cell[4301, 85, 620, 12, 145, "Text"],
Cell[4924, 99, 46334, 761, 1108, "Graphics"]
}, Closed]],
Cell[CellGroupData[{
Cell[51295, 865, 237, 3, 34, "Section"],
Cell[51535, 870, 858, 20, 109, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[52430, 895, 219, 3, 34, "Section"],
Cell[52652, 900, 689, 10, 37, "Subsubsection"],
Cell[53344, 912, 3025, 77, 185, "Input"],
Cell[56372, 991, 1669, 40, 69, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[58078, 1036, 480, 7, 34, "Section"],
Cell[58561, 1045, 653, 10, 37, "Subsubsection"],
Cell[59217, 1057, 12160, 267, 985, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[71414, 1329, 446, 6, 34, "Section"],
Cell[71863, 1337, 694, 10, 37, "Subsubsection"],
Cell[72560, 1349, 23990, 512, 1305, "Input"],
Cell[96553, 1863, 495, 7, 37, "Subsubsection"],
Cell[97051, 1872, 1428, 30, 85, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[98516, 1907, 655, 9, 34, "Section"],
Cell[99174, 1918, 594, 8, 37, "Subsubsection"],
Cell[99771, 1928, 13015, 241, 765, "Input"],
Cell[112789, 2171, 836, 12, 37, "Subsubsection"],
Cell[113628, 2185, 8800, 181, 745, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[122465, 2371, 601, 8, 34, "Section"],
Cell[123069, 2381, 612, 8, 37, "Subsubsection"],
Cell[123684, 2391, 11018, 249, 1009, "Input"],
Cell[134705, 2642, 861, 12, 37, "Subsubsection"],
Cell[135569, 2656, 4706, 95, 265, "Input"]
}, Closed]],
Cell[140290, 2754, 46, 0, 37, "Subtitle"],
Cell[CellGroupData[{
Cell[140361, 2758, 96, 1, 54, "Section"],
Cell[140460, 2761, 309, 6, 25, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[140806, 2772, 600, 8, 34, "Section"],
Cell[141409, 2782, 838, 12, 37, "Subsubsection"],
Cell[142250, 2796, 1897, 47, 165, "Input"],
Cell[144150, 2845, 470, 7, 37, "Subsubsection"],
Cell[144623, 2854, 1210, 27, 105, "Input"],
Cell[145836, 2883, 920, 21, 109, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[146793, 2909, 407, 6, 34, "Section"],
Cell[147203, 2917, 786, 11, 37, "Subsubsection"],
Cell[CellGroupData[{
Cell[148014, 2932, 6446, 157, 545, "Input"],
Cell[154463, 3091, 591, 10, 43, "Text"],
Cell[155057, 3103, 3436, 93, 289, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[158542, 3202, 229, 3, 34, "Section"],
Cell[158774, 3207, 391, 6, 37, "Subsubsection"],
Cell[159168, 3215, 959, 15, 60, "Text"],
Cell[160130, 3232, 8529, 197, 477, "Input"],
Cell[168662, 3431, 384, 6, 37, "Subsubsection"],
Cell[169049, 3439, 2669, 56, 125, "Input"],
Cell[171721, 3497, 485, 7, 37, "Subsubsection"],
Cell[172209, 3506, 3956, 95, 305, "Input"],
Cell[176168, 3603, 456, 6, 37, "Subsubsection"],
Cell[176627, 3611, 5258, 110, 565, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[181922, 3726, 426, 6, 34, "Section"],
Cell[182351, 3734, 490, 7, 37, "Subsubsection"],
Cell[182844, 3743, 3338, 67, 185, "Input"],
Cell[186185, 3812, 836, 12, 37, "Subsubsection"],
Cell[187024, 3826, 685, 12, 85, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[187746, 3843, 155, 2, 34, "Section"],
Cell[187904, 3847, 6227, 145, 509, "Input"]
}, Closed]],
Cell[194146, 3995, 46, 0, 37, "Subtitle"],
Cell[CellGroupData[{
Cell[194217, 3999, 96, 1, 54, "Section"],
Cell[194316, 4002, 1054, 15, 79, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[195407, 4022, 626, 9, 34, "Section"],
Cell[196036, 4033, 838, 12, 37, "Subsubsection"],
Cell[196877, 4047, 2655, 68, 245, "Input"],
Cell[199535, 4117, 584, 8, 37, "Subsubsection"],
Cell[200122, 4127, 2193, 43, 165, "Input"],
Cell[202318, 4172, 1323, 29, 169, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[203678, 4206, 429, 6, 34, "Section"],
Cell[204110, 4214, 788, 11, 37, "Subsubsection"],
Cell[204901, 4227, 953, 14, 60, "Text"],
Cell[205857, 4243, 5815, 145, 509, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[211709, 4393, 276, 4, 34, "Section"],
Cell[211988, 4399, 391, 6, 37, "Subsubsection"],
Cell[212382, 4407, 777, 12, 60, "Text"],
Cell[213162, 4421, 5190, 115, 278, "Input"],
Cell[218355, 4538, 536, 8, 37, "Subsubsection"],
Cell[218894, 4548, 2731, 61, 185, "Input"],
Cell[221628, 4611, 597, 8, 37, "Subsubsection"],
Cell[222228, 4621, 3775, 88, 285, "Input"],
Cell[226006, 4711, 590, 8, 37, "Subsubsection"],
Cell[226599, 4721, 2602, 70, 165, "Input"],
Cell[229204, 4793, 530, 8, 37, "Subsubsection"],
Cell[229737, 4803, 8302, 184, 668, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[238076, 4992, 526, 7, 34, "Section"],
Cell[238605, 5001, 490, 7, 37, "Subsubsection"],
Cell[239098, 5010, 3546, 68, 185, "Input"],
Cell[242647, 5080, 895, 12, 37, "Subsubsection"],
Cell[243545, 5094, 554, 10, 85, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[244136, 5109, 208, 3, 34, "Section"],
Cell[244347, 5114, 414, 8, 25, "Text"],
Cell[244764, 5124, 5647, 129, 389, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[250448, 5258, 935, 14, 54, "Section"],
Cell[251386, 5274, 20697, 414, 1529, "Input"]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
